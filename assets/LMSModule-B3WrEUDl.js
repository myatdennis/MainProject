var Ls=Object.defineProperty,Es=Object.defineProperties;var Ts=Object.getOwnPropertyDescriptors;var hs=Object.getOwnPropertySymbols;var As=Object.prototype.hasOwnProperty,Is=Object.prototype.propertyIsEnumerable;var gs=(a,g,p)=>g in a?Ls(a,g,{enumerable:!0,configurable:!0,writable:!0,value:p}):a[g]=p,ne=(a,g)=>{for(var p in g||(g={}))As.call(g,p)&&gs(a,p,g[p]);if(hs)for(var p of hs(g))Is.call(g,p)&&gs(a,p,g[p]);return a},le=(a,g)=>Es(a,Ts(g));var H=(a,g,p)=>new Promise((U,I)=>{var P=N=>{try{E(p.next(N))}catch(Q){I(Q)}},A=N=>{try{E(p.throw(N))}catch(Q){I(Q)}},E=N=>N.done?U(N.value):Promise.resolve(N.value).then(P,A);E((p=p.apply(a,g)).next())});import{r as s,a$ as K,j as e,a8 as fs,ak as Ms,b0 as Ds,b1 as Ps,b2 as Os,b3 as Us,b4 as Fs,h as zs,b5 as Qs,b6 as Vs,b7 as qs,b8 as Me,c as De,b9 as Bs,ap as Ys,Z as Ns,b as ws,t as Z,a4 as Ke,g as Pe,f as Oe,aK as qe,aB as Ks,aC as Ws,G as Gs,q as Hs,D as Ve,ba as Js,R as We,d as Xs,u as Zs,J as ze,a2 as ps,ah as Qe,e as et,aa as st,P as tt,T as rt,A as bs,p as vs,V as nt,as as js}from"./vendor-react-DJ2SMxUZ.js";import{s as ge,c as Ye,b as ys}from"./admin-secondary-DNjuZSKv.js";import"./supabase-CqkleIqs.js";import"./vendor-B_fIqYiW.js";import"./vendor-react-dom-Bu8tewph.js";import"./admin-courses-B4qhueE1.js";const at=(a={})=>{const{userId:g,channels:p=["course_assignments","user_progress","enrollments"],onEvent:U,onError:I,enabled:P=!0}=a,A=s.useRef([]),E=s.useRef(),N=s.useRef(0),Q=s.useCallback((x,o,v)=>{const j={type:o,payload:x,timestamp:Date.now(),userId:x.user_id||g};switch(console.log(`[RealtimeSync] Event received on ${v}:`,j),U==null||U(j),j.type){case"course_assigned":K.success(`New course assigned: ${x.course_name||"Course"}`);break;case"course_updated":K(`Course updated: ${x.course_name||"Course"}`,{icon:"â„¹ï¸"});break;case"enrollment_changed":x.status==="enrolled"?K.success(`Successfully enrolled in ${x.course_name||"course"}`):x.status==="unenrolled"&&K(`Unenrolled from ${x.course_name||"course"}`,{icon:"â„¹ï¸"});break;case"user_status_changed":x.status==="suspended"?K.error("Your account has been suspended. Please contact support."):x.status==="activated"&&K.success("Your account has been activated!");break}},[U,g]),z=s.useCallback(()=>H(void 0,null,function*(){if(!P||!ge){console.log("[RealtimeSync] Connection disabled or Supabase not available");return}try{console.log("[RealtimeSync] Establishing realtime connections..."),A.current.forEach(x=>{ge.removeChannel(x)}),A.current=[];for(const x of p){const o=ge.channel(x).on("postgres_changes",{event:"*",schema:"public",table:x,filter:g?`user_id=eq.${g}`:void 0},v=>{Q(v.new||v.old,v.eventType,x)}).on("broadcast",{event:"sync_update"},v=>{Q(v,"progress_sync",x)}).subscribe(v=>{console.log(`[RealtimeSync] Channel ${x} status:`,v),v==="SUBSCRIBED"?(N.current=0,K.success("Real-time sync connected",{id:"realtime-status",duration:2e3})):(v==="CLOSED"||v==="CHANNEL_ERROR")&&$()});A.current.push(o)}}catch(x){console.error("[RealtimeSync] Connection error:",x),I==null||I(x),$()}}),[P,p,g,Q,I]),$=s.useCallback(()=>{if(N.current<5){N.current++;const v=1e3*Math.pow(2,N.current-1);console.log(`[RealtimeSync] Reconnecting in ${v}ms (attempt ${N.current}/5)`),E.current&&clearTimeout(E.current),E.current=setTimeout(()=>{z()},v),K.loading(`Reconnecting... (${N.current}/5)`,{id:"realtime-reconnect"})}else K.error("Real-time sync disconnected. Please refresh the page.",{id:"realtime-error",duration:5e3})},[z]),w=s.useCallback(()=>{console.log("[RealtimeSync] Disconnecting..."),E.current&&clearTimeout(E.current),A.current.forEach(x=>{var o;(o=ge)==null||o.removeChannel(x)}),A.current=[],K.dismiss("realtime-status"),K.dismiss("realtime-reconnect"),K.dismiss("realtime-error")},[]),T=s.useCallback((x,o)=>H(void 0,null,function*(){if(!ge||A.current.length===0){console.warn("[RealtimeSync] Cannot broadcast - no active connections");return}try{yield A.current[0].send({type:"broadcast",event:"sync_update",payload:{type:x,data:o,timestamp:Date.now(),userId:g}}),console.log("[RealtimeSync] Broadcast sent:",{eventType:x,data:o})}catch(v){console.error("[RealtimeSync] Broadcast error:",v),I==null||I(v)}}),[g,I]);return s.useEffect(()=>(P&&z(),()=>{w()}),[P,z,w]),s.useEffect(()=>()=>{w()},[w]),{connect:z,disconnect:w,broadcastUpdate:T,isConnected:A.current.length>0,reconnectAttempts:N.current}},ot=(a={})=>{const{userId:g="demo-user",enabled:p=!0,saveInterval:U=3e4,maxRetries:I=3,onSaveSuccess:P,onSaveError:A}=a,[E,N]=s.useState(!1),[Q,z]=s.useState(null),[$,w]=s.useState(0),[T,x]=s.useState(navigator.onLine),o=s.useRef([]),v=s.useRef(),j=s.useRef(new Map);s.useEffect(()=>{const l=()=>{x(!0),k()},n=()=>{x(!1)};return window.addEventListener("online",l),window.addEventListener("offline",n),()=>{window.removeEventListener("online",l),window.removeEventListener("offline",n)}},[]);const L=s.useCallback(l=>`${l.courseId}_${l.moduleId}_${l.lessonId}`,[]),S=s.useCallback(l=>{try{const n=`autosave_${g}_${L(l)}`,y=le(ne({},l),{lastAccessed:l.lastAccessed.toISOString()});localStorage.setItem(n,JSON.stringify(y)),console.log("[AutoSave] Saved to local storage:",n)}catch(n){console.error("[AutoSave] Failed to save to local storage:",n)}},[g,L]),B=s.useCallback((l,n,y)=>{try{const _=`autosave_${g}_${l}_${n}_${y}`,J=localStorage.getItem(_);if(J){const de=JSON.parse(J);return le(ne({},de),{lastAccessed:new Date(de.lastAccessed)})}}catch(_){console.error("[AutoSave] Failed to load from local storage:",_)}return null},[g]),q=s.useCallback((l,n,y)=>{try{const _=`autosave_${g}_${l}_${n}_${y}`;localStorage.removeItem(_),console.log("[AutoSave] Cleared stored progress:",_)}catch(_){console.error("[AutoSave] Failed to clear stored progress:",_)}},[g]),Y=s.useCallback(l=>H(void 0,null,function*(){if(!ge)return console.warn("[AutoSave] Supabase not available"),!1;try{const{error:n}=yield ge.from("user_progress").upsert({user_id:g,course_id:l.courseId,module_id:l.moduleId,lesson_id:l.lessonId,progress:l.progress,time_spent:l.timeSpent,completed:l.completed,reflection:l.reflection,quiz_scores:l.quizScores,video_progress:l.videoProgress,last_accessed:l.lastAccessed.toISOString(),updated_at:new Date().toISOString()},{onConflict:"user_id,course_id,module_id,lesson_id"});return n?(console.error("[AutoSave] Database save error:",n),!1):(console.log("[AutoSave] Successfully saved to database:",L(l)),!0)}catch(n){return console.error("[AutoSave] Database save exception:",n),!1}}),[g,L]),k=s.useCallback(()=>H(void 0,null,function*(){if(!T||o.current.length===0||E)return;N(!0);const l=[...o.current];o.current=[];for(const n of l)try{(yield Y(n.data))?(P==null||P(n.data),q(n.data.courseId,n.data.moduleId,n.data.lessonId)):n.attempts<I?o.current.push(le(ne({},n),{attempts:n.attempts+1})):(console.error("[AutoSave] Max retries exceeded for:",n.id),A==null||A(new Error("Max retries exceeded"),n.data))}catch(y){console.error("[AutoSave] Queue processing error:",y),A==null||A(y,n.data)}N(!1),z(new Date)}),[T,E,Y,I,P,A,q]),f=s.useCallback(l=>{if(!p)return;const n=L(l);j.current.set(n,l),w(j.current.size),S(l),T?(o.current=o.current.filter(y=>y.id!==n),o.current.push({id:n,data:l,timestamp:Date.now(),attempts:0})):K("Progress saved offline. Will sync when connection restored.",{icon:"ðŸ’¾",id:"offline-save"})},[p,L,S,T]),h=s.useCallback(l=>H(void 0,null,function*(){return l&&f(l),T?(yield k(),o.current.length===0):(K.error("Cannot save - you are offline"),!1)}),[f,T,k]);return s.useEffect(()=>{if(!(!p||!T))return v.current=setInterval(()=>{j.current.size>0&&k()},U),()=>{v.current&&clearInterval(v.current)}},[p,T,U,k]),s.useEffect(()=>{T&&o.current.length>0&&k()},[T,k]),s.useEffect(()=>()=>{v.current&&clearInterval(v.current)},[]),{scheduleProgressSave:f,forceSave:h,loadFromStorage:B,clearStoredProgress:q,isSaving:E,isOnline:T,lastSaved:Q,pendingChanges:$,queueLength:o.current.length}},lt=(a={})=>{const{maxRetries:g=3,retryDelay:p=2e3,maxQueueSize:U=100,onSync:I,onSyncError:P,onQueueFull:A}=a,[E,N]=s.useState(navigator.onLine),[Q,z]=s.useState(!1),[$,w]=s.useState(0),[T,x]=s.useState(null),o=s.useRef([]),v=s.useRef(!1),j=s.useRef();s.useEffect(()=>{try{const l=localStorage.getItem("offline_progress_queue");if(l){const n=JSON.parse(l);o.current=n.filter(y=>{const _=Date.now()-6048e5;return y.timestamp>_}),w(o.current.length),console.log(`[OfflineQueue] Loaded ${o.current.length} items from storage`)}}catch(l){console.error("[OfflineQueue] Failed to load queue from storage:",l),o.current=[]}},[]);const L=s.useCallback(()=>{try{localStorage.setItem("offline_progress_queue",JSON.stringify(o.current))}catch(l){console.error("[OfflineQueue] Failed to save queue to storage:",l)}},[]);s.useEffect(()=>{const l=()=>{N(!0),K.success("Connection restored. Syncing progress...",{duration:3e3,id:"connection-restored"}),setTimeout(()=>q(),1e3)},n=()=>{N(!1),K("You're offline. Progress will be saved locally.",{icon:"ðŸ’¾",duration:4e3,id:"connection-lost"})};return window.addEventListener("online",l),window.addEventListener("offline",n),()=>{window.removeEventListener("online",l),window.removeEventListener("offline",n)}},[]);const S=s.useCallback(()=>`queue_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,[]),B=s.useCallback(l=>{o.current.length>=U&&(console.warn("[OfflineQueue] Queue size limit reached"),A==null||A(),o.current=o.current.filter(y=>y.priority!=="low").slice(-(U-1)));const n=le(ne({},l),{id:S(),timestamp:Date.now(),attempts:0});return o.current=o.current.filter(y=>!(y.userId===l.userId&&y.courseId===l.courseId&&y.lessonId===l.lessonId&&y.action===l.action)),o.current.push(n),o.current.sort((y,_)=>{const J={high:3,medium:2,low:1};return J[_.priority]-J[y.priority]||y.timestamp-_.timestamp}),w(o.current.length),L(),console.log("[OfflineQueue] Added item to queue:",n.id,n.action),E?setTimeout(()=>q(),500):K("Progress saved offline",{icon:"ðŸ’¾",duration:2e3,id:"offline-save"}),n.id},[U,E,S,L,A]),q=s.useCallback(()=>H(void 0,null,function*(){if(!E||v.current||o.current.length===0)return;v.current=!0,z(!0),console.log(`[OfflineQueue] Processing ${o.current.length} queued items`);const l=[...o.current],n=[],y=[];for(const _ of l){try{(yield Y(_))?(n.push(_.id),I==null||I(_),console.log("[OfflineQueue] Successfully synced:",_.id,_.action)):_.attempts<g?y.push(le(ne({},_),{attempts:_.attempts+1})):(console.error("[OfflineQueue] Max retries exceeded:",_.id),P==null||P(_,new Error("Max retries exceeded")))}catch(J){console.error("[OfflineQueue] Sync error for item:",_.id,J),_.attempts<g?y.push(le(ne({},_),{attempts:_.attempts+1})):P==null||P(_,J)}yield new Promise(J=>setTimeout(J,100))}o.current=o.current.filter(_=>!n.includes(_.id)).concat(y),w(o.current.length),L(),v.current=!1,z(!1),x(new Date),n.length>0&&K.success(`Synced ${n.length} progress updates`,{duration:3e3}),y.length>0&&(K("Some items will retry later",{icon:"âš ï¸",duration:2e3}),j.current&&clearTimeout(j.current),j.current=setTimeout(()=>{q()},p)),console.log("[OfflineQueue] Processing complete. Remaining items:",o.current.length)}),[E,g,p,I,P,L]),Y=l=>H(void 0,null,function*(){try{if(yield new Promise(y=>setTimeout(y,200+Math.random()*300)),!(Math.random()>.1))throw new Error("Simulated API error");switch(l.action){case"progress_update":break;case"lesson_complete":break;case"quiz_submit":break;case"reflection_save":break}return!0}catch(n){return console.error(`[OfflineQueue] Failed to sync ${l.action}:`,n),!1}}),k=s.useCallback(()=>{o.current=[],w(0),L(),console.log("[OfflineQueue] Queue cleared")},[L]),f=s.useCallback(l=>{o.current=o.current.filter(n=>n.id!==l),w(o.current.length),L()},[L]),h=s.useCallback(()=>({total:o.current.length,byPriority:{high:o.current.filter(n=>n.priority==="high").length,medium:o.current.filter(n=>n.priority==="medium").length,low:o.current.filter(n=>n.priority==="low").length},byAction:o.current.reduce((n,y)=>(n[y.action]=(n[y.action]||0)+1,n),{}),oldestTimestamp:o.current.length>0?Math.min(...o.current.map(n=>n.timestamp)):null,failedItems:o.current.filter(n=>n.attempts>0).length}),[]);return s.useEffect(()=>{if(E&&o.current.length>0){const l=setTimeout(()=>q(),2e3);return()=>clearTimeout(l)}},[E,q]),s.useEffect(()=>()=>{j.current&&clearTimeout(j.current)},[]),{addToQueue:B,processQueue:q,clearQueue:k,removeItem:f,getQueueStats:h,isOnline:E,isProcessing:Q,queueSize:$,lastSync:T,queue:o.current}},it=(a,g={})=>{const{userId:p="demo-user",enableAutoSave:U=!0,enableRealtime:I=!0,autoSaveInterval:P=3e4}=g,[A,E]=s.useState(null),[N,Q]=s.useState({}),[z,$]=s.useState({}),[w,T]=s.useState(!0),[x,o]=s.useState(null),[v,j]=s.useState("synced"),[L,S]=s.useState(null),B=s.useRef(new Date),q=s.useRef(new Set),Y=ot({userId:p,enabled:U,saveInterval:P,onSaveSuccess:c=>{console.log("[CourseProgress] Auto-save successful:",c),j("synced"),q.current.delete(`${c.courseId}_${c.lessonId}`)},onSaveError:(c,F)=>{console.error("[CourseProgress] Auto-save failed:",c,F),j("error")}}),k=lt({onSync:c=>{console.log("[CourseProgress] Offline item synced:",c),K.success(`Progress synced: ${c.action}`)},onSyncError:(c,F)=>{console.error("[CourseProgress] Offline sync failed:",c,F),K.error("Failed to sync some progress data")}}),f=s.useCallback(c=>{c.type==="course_updated"&&c.payload.course_id===a?(console.log("[CourseProgress] Course updated via realtime:",c.payload),l()):c.type==="progress_sync"&&c.payload.course_id===a&&(console.log("[CourseProgress] Progress sync event:",c.payload),c.userId!==p&&J(c.payload))},[a,p]),h=at({userId:p,enabled:I,onEvent:f,onError:c=>{console.error("[CourseProgress] Realtime error:",c)}}),l=s.useCallback(()=>H(void 0,null,function*(){try{if(T(!0),o(null),!""||!""){console.log("[CourseProgress] Running in demo mode");const ae={id:`enrollment_demo_${Date.now()}`,user_id:p,course_id:a,enrolled_at:new Date().toISOString(),progress_percentage:0,completed_at:void 0,last_accessed_at:new Date().toISOString()};E(ae),Q({}),$({}),T(!1);return}const{data:{user:V}}=yield ge.auth.getUser(),W=(V==null?void 0:V.id)||p,{data:te,error:ee}=yield ge.from("user_course_enrollments").select("*").eq("user_id",W).eq("course_id",a).limit(1);if(ee){console.error("Error loading enrollment:",ee),o("Failed to load enrollment data");return}if(te&&te.length>0)E(te[0]);else{const ae={id:`enrollment_${Date.now()}`,user_id:W,course_id:a,enrolled_at:new Date().toISOString(),progress_percentage:0,last_accessed_at:new Date().toISOString(),completed_at:void 0};E(ae)}const{data:G,error:xe}=yield ge.from("user_lesson_progress").select("*").eq("user_id",W).eq("course_id",a);if(xe&&console.error("Error loading progress:",xe),G){const ae=G.reduce((pe,se)=>(pe[se.lesson_id]=se,pe),{});Q(ae)}const{data:me,error:ie}=yield ge.from("user_reflections").select("*").eq("user_id",W).eq("course_id",a);if(ie&&console.error("Error loading reflections:",ie),me){const ae=me.reduce((pe,se)=>(pe[se.lesson_id]=se,pe),{});$(ae)}}catch(c){console.error("Error in loadProgressData:",c),o("Failed to load progress data")}finally{T(!1)}}),[a,p]),n=s.useCallback((c,F,V)=>H(void 0,null,function*(){try{const W="",te="",ee=N[c]||{},G=ne(le(ne({},ee),{id:ee.id||`progress_${Date.now()}`,user_id:p,lesson_id:c,time_spent:ee.time_spent||0,completed:ee.completed||!1,progress_percentage:ee.progress_percentage||0,last_accessed_at:new Date().toISOString(),completed_at:ee.completed_at}),V);if(Q(me=>le(ne({},me),{[c]:G})),!W||!te){console.log("[CourseProgress] Demo mode - progress updated locally only"),j("synced");return}const xe=`${a}_${c}`;q.current.add(xe),j("pending"),B.current=new Date,U&&Y.scheduleProgressSave({courseId:a,lessonId:c,moduleId:F,progress:G.progress_percentage,timeSpent:G.time_spent,completed:G.completed,lastAccessed:new Date(G.last_accessed_at),quizScores:void 0,videoProgress:G.progress_percentage}),navigator.onLine||k.addToQueue({userId:p,courseId:a,lessonId:c,moduleId:F,action:"progress_update",data:G,priority:"medium"}),navigator.onLine&&I&&h.isConnected&&(yield h.broadcastUpdate("progress_update",{course_id:a,lesson_id:c,progress:G.progress_percentage,completed:G.completed,timestamp:Date.now()}))}catch(W){console.error("Error updating lesson progress:",W),o("Failed to update progress"),j("error")}}),[a,p,N,U,I,Y,k,h]),y=s.useCallback((c,F,V)=>H(void 0,null,function*(){const W={completed:!0,completed_at:new Date().toISOString(),progress_percentage:100,last_accessed_at:new Date().toISOString()};yield n(c,F,W),k.addToQueue({userId:p,courseId:a,lessonId:c,moduleId:F,action:"lesson_complete",data:{lesson_id:c,completed_at:W.completed_at,quiz_score:V},priority:"high"}),K.success("Lesson completed!",{duration:3e3})}),[n,k,p,a]),_=s.useCallback((c,F)=>H(void 0,null,function*(){var V,W;try{const te="",ee="",G={id:((V=z[c])==null?void 0:V.id)||`reflection_${Date.now()}`,user_id:p,lesson_id:c,content:F,created_at:((W=z[c])==null?void 0:W.created_at)||new Date().toISOString(),updated_at:new Date().toISOString()};if($(xe=>le(ne({},xe),{[c]:G})),!te||!ee){console.log("[CourseProgress] Demo mode - reflection saved locally only");return}k.addToQueue({userId:p,courseId:a,lessonId:c,moduleId:"reflection",action:"reflection_save",data:G,priority:"low"}),K.success("Reflection saved")}catch(te){console.error("Error saving reflection:",te),K.error("Failed to save reflection")}}),[a,p,z,k]),J=s.useCallback(c=>{c.lesson_id&&c.progress!==void 0&&Q(F=>{const V=F[c.lesson_id]||{},W=new Date(c.timestamp||0),te=new Date(V.last_accessed_at||0);return W>te?le(ne({},F),{[c.lesson_id]:le(ne({},V),{progress:c.progress,completed:c.completed||V.completed,last_accessed_at:c.timestamp||V.last_accessed_at})}):F})},[]),de=s.useCallback(()=>{const c=Object.values(N);if(c.length===0)return 0;const F=c.reduce((V,W)=>V+W.progress_percentage,0);return Math.round(F/c.length)},[N]),fe=s.useCallback(()=>{const c=Object.values(N).filter(V=>V.completed),F=Object.keys(N).length;return{completed:c.length,total:F,percentage:F>0?Math.round(c.length/F*100):0}},[N]);s.useEffect(()=>{l()},[l]);const Ce=s.useCallback(c=>{S(c),c&&N[c]&&n(c,"module_1",{last_accessed_at:new Date().toISOString()})},[N,n]);return{enrollmentData:A,lessonProgress:N,reflections:z,loading:w,error:x,updateLessonProgress:n,markLessonComplete:y,saveReflection:_,setActiveLessonTracking:Ce,calculateCourseProgress:de,getCompletionStats:fe,syncStatus:v,isOnline:k.isOnline,isSaving:Y.isSaving,isProcessingQueue:k.isProcessing,pendingChanges:Y.pendingChanges,queueSize:k.queueSize,lastSaved:Y.lastSaved,forceSave:Y.forceSave,processQueue:k.processQueue,loadFromStorage:Y.loadFromStorage,reloadData:l,isRealtimeConnected:h.isConnected,reconnectRealtime:h.connect,activeLesson:L}},ct=({src:a,title:g,thumbnail:p,onProgress:U,onComplete:I,initialTime:P=0,className:A="",autoPlay:E=!1,showTranscript:N=!1,transcript:Q="",captions:z=[]})=>{const $=s.useRef(null),w=s.useRef(null),T=s.useRef(null),[x,o]=s.useState(!1),[v,j]=s.useState(!0),[L,S]=s.useState(0),[B,q]=s.useState(0),[Y,k]=s.useState(1),[f,h]=s.useState(!1),[l,n]=s.useState(1),[y,_]=s.useState(!1),[J,de]=s.useState(!0),[fe,Ce]=s.useState(!1),[c,F]=s.useState(!1),[V]=s.useState(!1),[W,te]=s.useState(!1),[ee]=s.useState(0),[G,xe]=s.useState(0),[me,ie]=s.useState(""),ae=s.useRef();s.useEffect(()=>{const i=$.current;if(!i)return;const M=()=>j(!0),X=()=>{j(!1),P>0&&(i.currentTime=P)},ye=()=>{q(i.duration)},Le=()=>{const be=i.currentTime;if(S(be),!V&&U&&U(be/i.duration*100),z.length>0&&c){const Te=z.find(Ne=>be>=Ne.start&&be<=Ne.end);ie(Te?Te.text:"")}Math.floor(be)%10===0&&localStorage.setItem(`video-progress-${a}`,be.toString())},$e=()=>{if(i.buffered.length>0){const be=i.buffered.end(i.buffered.length-1);xe(be/i.duration*100)}},Se=()=>{o(!1),S(B),I&&I(),localStorage.removeItem(`video-progress-${a}`)},Ee=()=>{o(!0),te(!0)},Ue=()=>o(!1);return i.addEventListener("loadstart",M),i.addEventListener("canplay",X),i.addEventListener("loadedmetadata",ye),i.addEventListener("timeupdate",Le),i.addEventListener("progress",$e),i.addEventListener("ended",Se),i.addEventListener("play",Ee),i.addEventListener("pause",Ue),()=>{i.removeEventListener("loadstart",M),i.removeEventListener("canplay",X),i.removeEventListener("loadedmetadata",ye),i.removeEventListener("timeupdate",Le),i.removeEventListener("progress",$e),i.removeEventListener("ended",Se),i.removeEventListener("play",Ee),i.removeEventListener("pause",Ue)}},[a,P,U,I,V,B,z,c]),s.useEffect(()=>{const i=localStorage.getItem(`video-progress-${a}`);if(i&&$.current){const M=parseFloat(i);$.current.currentTime=M,S(M)}},[a]),s.useEffect(()=>{let i;return x&&!V&&(i=setInterval(()=>{console.log(`Watch time: ${ee+1}s`)},1e3)),()=>{i&&clearInterval(i)}},[x,V]);const pe=s.useCallback(()=>{ae.current&&clearTimeout(ae.current),de(!0),x&&(ae.current=setTimeout(()=>{de(!1)},3e3))},[x]),se=()=>{const i=$.current;i&&(x?i.pause():i.play())},u=i=>{const M=$.current;if(!M||!B)return;const X=i/100*B;M.currentTime=X,S(X)},_e=i=>{const M=$.current;M&&(M.currentTime=Math.max(0,Math.min(B,L+i)))},C=i=>{const M=$.current;M&&(M.volume=i,k(i),h(i===0))},t=()=>{const i=$.current;i&&(f?(i.volume=Y||.5,h(!1)):(i.volume=0,h(!0)))},Be=i=>{const M=$.current;M&&(M.playbackRate=i,n(i),Ce(!1))},Re=()=>H(void 0,null,function*(){const i=w.current;i&&(y?document.exitFullscreen&&(yield document.exitFullscreen()):i.requestFullscreen&&(yield i.requestFullscreen()))});s.useEffect(()=>{const i=()=>{_(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",i),()=>document.removeEventListener("fullscreenchange",i)},[]);const re=i=>{const M=T.current;if(!M||!B)return;const X=M.getBoundingClientRect(),ye=(i.clientX-X.left)/X.width*100;u(Math.max(0,Math.min(100,ye)))};s.useEffect(()=>{const i=M=>{if(W)switch(M.key){case" ":M.preventDefault(),se();break;case"ArrowLeft":M.preventDefault(),_e(-10);break;case"ArrowRight":M.preventDefault(),_e(10);break;case"ArrowUp":M.preventDefault(),C(Math.min(1,Y+.1));break;case"ArrowDown":M.preventDefault(),C(Math.max(0,Y-.1));break;case"m":M.preventDefault(),t();break;case"f":M.preventDefault(),Re();break;case"c":M.preventDefault(),F(!c);break}};return document.addEventListener("keydown",i),()=>document.removeEventListener("keydown",i)},[W,Y,c]);const je=i=>{const M=Math.floor(i/60),X=Math.floor(i%60);return`${M}:${X.toString().padStart(2,"0")}`};return e.jsxs("div",{ref:w,className:`relative bg-black rounded-lg overflow-hidden ${A}`,onMouseMove:pe,onMouseLeave:()=>x&&de(!1),children:[e.jsx("video",{ref:$,src:a,poster:p,className:"w-full h-full",autoPlay:E,playsInline:!0,preload:"metadata",onClick:se}),v&&e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-white"})}),!x&&!v&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("button",{onClick:se,className:"bg-orange-500 bg-opacity-90 hover:bg-opacity-100 rounded-full p-6 transition-all duration-200 transform hover:scale-105",children:e.jsx(fs,{className:"h-8 w-8 text-white ml-1",fill:"white"})})}),c&&me&&e.jsx("div",{className:"absolute bottom-20 left-1/2 transform -translate-x-1/2 bg-black bg-opacity-75 text-white px-4 py-2 rounded max-w-md text-center",children:me}),e.jsxs("div",{className:`absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black via-black to-transparent p-4 transition-opacity duration-300 ${J?"opacity-100":"opacity-0"}`,children:[e.jsx("div",{className:"mb-4",children:e.jsxs("div",{ref:T,className:"w-full h-2 bg-gray-600 rounded-full cursor-pointer relative overflow-hidden",onClick:re,children:[e.jsx("div",{className:"absolute top-0 left-0 h-full bg-gray-400 rounded-full",style:{width:`${G}%`}}),e.jsx("div",{className:"absolute top-0 left-0 h-full bg-orange-500 rounded-full transition-all duration-100",style:{width:`${L/B*100}%`}}),e.jsx("div",{className:"absolute top-1/2 transform -translate-y-1/2 w-4 h-4 bg-orange-500 rounded-full border-2 border-white shadow-lg transition-all duration-100",style:{left:`${L/B*100}%`,marginLeft:"-8px"}})]})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:se,className:"text-white hover:text-orange-400 transition-colors duration-200",children:x?e.jsx(Ms,{className:"h-6 w-6"}):e.jsx(fs,{className:"h-6 w-6"})}),e.jsx("button",{onClick:()=>_e(-10),className:"text-white hover:text-orange-400 transition-colors duration-200",children:e.jsx(Ds,{className:"h-5 w-5"})}),e.jsx("button",{onClick:()=>_e(10),className:"text-white hover:text-orange-400 transition-colors duration-200",children:e.jsx(Ps,{className:"h-5 w-5"})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:t,className:"text-white hover:text-orange-400 transition-colors duration-200",children:f||Y===0?e.jsx(Os,{className:"h-5 w-5"}):e.jsx(Us,{className:"h-5 w-5"})}),e.jsx("input",{type:"range",min:"0",max:"1",step:"0.1",value:f?0:Y,onChange:i=>C(parseFloat(i.target.value)),className:"w-20 h-1 bg-gray-600 rounded-lg appearance-none cursor-pointer slider"})]}),e.jsxs("div",{className:"text-white text-sm font-medium",children:[je(L)," / ",je(B)]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[z.length>0&&e.jsx("button",{onClick:()=>F(!c),className:`transition-colors duration-200 ${c?"text-orange-400":"text-white hover:text-orange-400"}`,children:e.jsx(Fs,{className:"h-5 w-5"})}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>Ce(!fe),className:"text-white hover:text-orange-400 transition-colors duration-200",children:e.jsx(zs,{className:"h-5 w-5"})}),fe&&e.jsxs("div",{className:"absolute bottom-8 right-0 bg-black bg-opacity-90 rounded-lg p-3 min-w-[120px]",children:[e.jsx("div",{className:"text-white text-sm font-medium mb-2",children:"Playback Speed"}),[.5,.75,1,1.25,1.5,2].map(i=>e.jsxs("button",{onClick:()=>Be(i),className:`block w-full text-left px-2 py-1 text-sm rounded transition-colors ${l===i?"bg-orange-500 text-white":"text-gray-300 hover:bg-gray-700"}`,children:[i,"x"]},i))]})]}),e.jsx("button",{onClick:Re,className:"text-white hover:text-orange-400 transition-colors duration-200",children:y?e.jsx(Qs,{className:"h-5 w-5"}):e.jsx(Vs,{className:"h-5 w-5"})})]})]})]}),g&&J&&e.jsx("div",{className:"absolute top-4 left-4 text-white font-medium text-lg bg-black bg-opacity-50 px-3 py-1 rounded",children:g}),L>=B-1&&B>0&&e.jsx("div",{className:"absolute top-4 right-4",children:e.jsxs("button",{onClick:()=>u(0),className:"bg-orange-500 bg-opacity-90 hover:bg-opacity-100 text-white px-4 py-2 rounded-lg flex items-center space-x-2 transition-all duration-200",children:[e.jsx(qs,{className:"h-4 w-4"}),e.jsx("span",{children:"Restart"})]})}),N&&Q&&e.jsxs("div",{className:"absolute right-0 top-0 bottom-0 w-80 bg-white bg-opacity-95 overflow-y-auto p-4 text-sm",children:[e.jsx("h3",{className:"font-semibold mb-4 text-gray-900",children:"Transcript"}),e.jsx("div",{className:"text-gray-700 leading-relaxed whitespace-pre-wrap",children:Q})]})]})},dt=({currentProgress:a,totalLessons:g,completedLessons:p,currentLessonTitle:U,onPrevious:I,onNext:P,hasPrevious:A=!1,hasNext:E=!1,estimatedTimeRemaining:N,visible:Q=!0,className:z=""})=>{const[$,w]=s.useState(!1),[T,x]=s.useState(a),[o,v]=s.useState(!1);s.useEffect(()=>{a>T&&[25,50,75,100].find(q=>T<q&&a>=q)&&(w(!0),setTimeout(()=>w(!1),3e3)),x(a)},[a,T]),s.useEffect(()=>{const S=()=>{v(window.scrollY>100)};return window.addEventListener("scroll",S),()=>window.removeEventListener("scroll",S)},[]);const j=()=>a>=100?"ðŸŽ‰ Congratulations! Course completed!":a>=75?"ðŸš€ Almost there! You're doing great!":a>=50?"ðŸ’ª Halfway through! Keep it up!":a>=25?"â­ Great progress! You're on track!":"",L=()=>a>=100?"from-green-400 to-emerald-500":a>=75?"from-blue-400 to-indigo-500":a>=50?"from-purple-400 to-pink-500":a>=25?"from-yellow-400 to-orange-500":"from-orange-400 to-red-500";return Q?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`fixed bottom-6 left-1/2 transform -translate-x-1/2 z-50 transition-all duration-300 translate-y-0 ${z}`,children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl border border-gray-200 p-4 min-w-[400px] max-w-2xl backdrop-blur-sm bg-opacity-95",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:`w-3 h-3 rounded-full bg-gradient-to-r ${L()}`}),e.jsxs("span",{className:"text-sm font-semibold text-gray-900",children:[p," of ",g," lessons"]})]}),a===100&&e.jsx(Me,{className:"h-5 w-5 text-yellow-500 animate-pulse"})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[N&&e.jsxs("div",{className:"flex items-center text-xs text-gray-600",children:[e.jsx(De,{className:"h-4 w-4 mr-1"}),N," left"]}),e.jsxs("div",{className:"text-sm font-bold text-gray-900",children:[Math.round(a),"%"]})]})]}),e.jsxs("div",{className:"relative mb-3",children:[e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3 overflow-hidden",children:e.jsx("div",{className:`h-3 rounded-full bg-gradient-to-r ${L()} transition-all duration-500 relative`,style:{width:`${a}%`},children:e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white to-transparent opacity-30 animate-pulse"})})}),e.jsx("div",{className:"absolute top-0 left-0 w-full h-3 flex justify-between items-center",children:[25,50,75,100].map(S=>e.jsx("div",{className:`w-1 h-5 -mt-1 rounded-full transition-colors duration-300 ${a>=S?"bg-white shadow-md":"bg-gray-300"}`,style:{marginLeft:"25%"}},S))})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900 truncate",children:U}),$&&e.jsx("div",{className:"text-xs text-green-600 font-medium animate-bounce mt-1",children:j()})]}),e.jsxs("div",{className:"flex items-center space-x-2 ml-4",children:[e.jsx("button",{onClick:I,disabled:!A,className:`p-2 rounded-lg transition-all duration-200 ${A?"text-gray-600 hover:text-gray-900 hover:bg-gray-100":"text-gray-300 cursor-not-allowed"}`,title:"Previous lesson",children:e.jsx(Bs,{className:"h-5 w-5"})}),e.jsx("button",{onClick:P,disabled:!E,className:`p-2 rounded-lg transition-all duration-200 ${E?"text-white bg-gradient-to-r from-orange-500 to-red-500 hover:from-orange-600 hover:to-red-600 shadow-lg":"text-gray-300 cursor-not-allowed bg-gray-200"}`,title:E?"Next lesson":"Course complete",children:a>=100?e.jsx(Me,{className:"h-5 w-5"}):e.jsx(Ys,{className:"h-5 w-5"})})]})]})]})}),$&&a>=100&&e.jsx("div",{className:"fixed inset-0 z-60 flex items-center justify-center bg-black bg-opacity-50 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white rounded-3xl p-8 max-w-md mx-4 text-center animate-bounce-in",children:[e.jsx("div",{className:"mb-6",children:e.jsx(Me,{className:"h-16 w-16 text-yellow-500 mx-auto animate-pulse"})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"ðŸŽ‰ Congratulations!"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"You've successfully completed the course! Your certificate is ready for download."}),e.jsxs("div",{className:"flex items-center justify-center space-x-4",children:[e.jsx("button",{className:"bg-gradient-to-r from-green-500 to-emerald-600 text-white px-6 py-3 rounded-xl font-semibold hover:from-green-600 hover:to-emerald-700 transition-all duration-200 shadow-lg",children:"Download Certificate"}),e.jsx("button",{onClick:()=>w(!1),className:"text-gray-600 hover:text-gray-900 px-6 py-3 font-medium",children:"Continue"})]})]})}),o&&e.jsx("div",{className:"fixed top-0 left-0 right-0 z-40",children:e.jsx("div",{className:`h-1 bg-gradient-to-r ${L()} transition-all duration-300`,style:{width:`${a}%`}})}),$&&a<100&&e.jsx("div",{className:"fixed top-6 right-6 z-50 animate-slide-in-right",children:e.jsx("div",{className:"bg-white rounded-xl shadow-xl border border-gray-200 p-4 max-w-sm",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"flex-shrink-0",children:a>=75?e.jsx(Ns,{className:"h-8 w-8 text-blue-500"}):a>=50?e.jsx(ws,{className:"h-8 w-8 text-purple-500"}):e.jsx(Z,{className:"h-8 w-8 text-orange-500"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-gray-900 text-sm",children:"Milestone Reached!"}),e.jsx("div",{className:"text-xs text-gray-600",children:j()})]})]})})})]}):null},mt=({course:a,completionData:g,keyTakeaways:p=[],nextSteps:U=[],recommendedCourses:I=[],onClose:P,onCertificateDownload:A,onShareComplete:E,className:N=""})=>{var Y,k;const[Q,z]=s.useState(!0),[$,w]=s.useState("summary"),[T,x]=s.useState(""),[o,v]=s.useState(!1);s.useEffect(()=>{const f=`${window.location.origin}/course/${a.id}/completed`;x(f);const h=setTimeout(()=>z(!1),5e3);return()=>clearTimeout(h)},[a.id]);const j=f=>{const h=Math.floor(f/60),l=f%60;return h>0?`${h}h ${l}m`:`${l}m`},L=f=>{switch(f==null?void 0:f.toUpperCase()){case"A":case"A+":case"A-":return"text-green-600 bg-green-50";case"B":case"B+":case"B-":return"text-blue-600 bg-blue-50";case"C":case"C+":case"C-":return"text-yellow-600 bg-yellow-50";default:return"text-gray-600 bg-gray-50"}},S=f=>H(void 0,null,function*(){const h=`Just completed "${a.title}"! ðŸŽ“ #Learning #ProfessionalDevelopment`;switch(f){case"linkedin":window.open(`https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(T)}&summary=${encodeURIComponent(h)}`,"_blank");break;case"twitter":window.open(`https://twitter.com/intent/tweet?text=${encodeURIComponent(h)}&url=${encodeURIComponent(T)}`,"_blank");break;case"email":window.open(`mailto:?subject=${encodeURIComponent(`Course Completion: ${a.title}`)}&body=${encodeURIComponent(`${h}

${T}`)}`,"_blank");break;case"copy":try{yield navigator.clipboard.writeText(T),v(!0),setTimeout(()=>v(!1),2e3)}catch(l){console.error("Failed to copy link:",l)}break}E&&E(f)}),B=((Y=a.modules)==null?void 0:Y.reduce((f,h)=>f+h.lessons.length,0))||0,q=((k=a.modules)==null?void 0:k.reduce((f,h)=>f+h.lessons.filter(l=>l.completed).length,0))||0;return e.jsxs("div",{className:`min-h-screen bg-gradient-to-br from-orange-50 via-red-50 to-pink-50 ${N}`,children:[Q&&e.jsx("div",{className:"fixed inset-0 pointer-events-none z-10",children:e.jsx("div",{className:"confetti-animation",children:Array.from({length:50}).map((f,h)=>e.jsx("div",{className:"confetti-piece",style:{left:`${Math.random()*100}%`,animationDelay:`${Math.random()*3}s`,backgroundColor:["#FF8895","#D72638","#3A7FFF","#2D9B66"][Math.floor(Math.random()*4)]}},h))})}),e.jsxs("div",{className:"container mx-auto px-4 py-12 relative z-20",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("div",{className:"mb-6",children:e.jsx(Me,{className:"h-20 w-20 text-yellow-500 mx-auto animate-bounce"})}),e.jsx("h1",{className:"text-4xl md:text-6xl font-bold text-gray-900 mb-4",children:"Congratulations!"}),e.jsxs("p",{className:"text-xl text-gray-600 mb-6 max-w-2xl mx-auto",children:["You've successfully completed ",e.jsxs("span",{className:"font-semibold text-gray-900",children:['"',a.title,'"']})]}),e.jsxs("div",{className:"flex flex-wrap items-center justify-center gap-6 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(De,{className:"h-4 w-4"}),e.jsxs("span",{children:["Completed in ",j(g.timeSpent)]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Z,{className:"h-4 w-4 text-green-500"}),e.jsxs("span",{children:[q,"/",B," lessons"]})]}),g.grade&&e.jsxs("div",{className:`flex items-center space-x-2 px-3 py-1 rounded-full ${L(g.grade)}`,children:[e.jsx(Ke,{className:"h-4 w-4"}),e.jsxs("span",{className:"font-medium",children:["Grade: ",g.grade]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ws,{className:"h-4 w-4 text-blue-500"}),e.jsxs("span",{children:["Completed ",g.completedAt.toLocaleDateString()]})]})]})]}),e.jsx("div",{className:"flex justify-center mb-8",children:e.jsx("div",{className:"bg-white rounded-xl p-1 shadow-lg border border-gray-200",children:[{id:"summary",label:"Summary",icon:Pe},{id:"certificate",label:"Certificate",icon:Oe},{id:"next-steps",label:"Next Steps",icon:qe}].map(({id:f,label:h,icon:l})=>e.jsxs("button",{onClick:()=>w(f),className:`px-6 py-3 rounded-lg font-medium transition-all duration-200 flex items-center space-x-2 ${$===f?"bg-gradient-to-r from-orange-500 to-red-500 text-white shadow-md":"text-gray-600 hover:text-gray-900 hover:bg-gray-50"}`,children:[e.jsx(l,{className:"h-4 w-4"}),e.jsx("span",{children:h})]},f))})}),e.jsxs("div",{className:"max-w-4xl mx-auto",children:[$==="summary"&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"bg-white rounded-2xl p-8 shadow-lg border border-gray-200",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Course Summary"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-start space-x-4",children:[a.thumbnail&&e.jsx("img",{src:a.thumbnail,alt:a.title,className:"w-16 h-16 rounded-lg object-cover"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:a.title}),a.instructor&&e.jsxs("p",{className:"text-sm text-gray-600",children:["by ",a.instructor]}),a.description&&e.jsx("p",{className:"text-sm text-gray-600 mt-2",children:a.description})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:q}),e.jsx("div",{className:"text-sm text-green-600",children:"Lessons Completed"})]}),e.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:j(g.timeSpent)}),e.jsx("div",{className:"text-sm text-blue-600",children:"Time Invested"})]})]}),g.score&&e.jsxs("div",{className:"text-center p-4 bg-purple-50 rounded-lg",children:[e.jsxs("div",{className:"text-2xl font-bold text-purple-600",children:[g.score,"%"]}),e.jsx("div",{className:"text-sm text-purple-600",children:"Overall Score"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl p-8 shadow-lg border border-gray-200",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Key Takeaways"}),p.length>0?e.jsx("ul",{className:"space-y-4",children:p.map((f,h)=>e.jsxs("li",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"flex-shrink-0 w-6 h-6 bg-gradient-to-r from-orange-400 to-red-500 rounded-full flex items-center justify-center text-white text-sm font-bold",children:h+1}),e.jsx("span",{className:"text-gray-700",children:f})]},h))}):e.jsxs("div",{className:"text-center text-gray-500 py-8",children:[e.jsx(Pe,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"No specific takeaways recorded for this course."})]}),e.jsxs("div",{className:"mt-8 pt-6 border-t border-gray-200",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Share Your Achievement"}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsxs("button",{onClick:()=>S("linkedin"),className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(Ks,{className:"h-4 w-4"}),e.jsx("span",{children:"LinkedIn"})]}),e.jsxs("button",{onClick:()=>S("twitter"),className:"flex items-center space-x-2 px-4 py-2 bg-sky-500 text-white rounded-lg hover:bg-sky-600 transition-colors",children:[e.jsx(Ws,{className:"h-4 w-4"}),e.jsx("span",{children:"Twitter"})]}),e.jsxs("button",{onClick:()=>S("email"),className:"flex items-center space-x-2 px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",children:[e.jsx(Gs,{className:"h-4 w-4"}),e.jsx("span",{children:"Email"})]}),e.jsxs("button",{onClick:()=>S("copy"),className:"flex items-center space-x-2 px-4 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600 transition-colors",children:[e.jsx(Hs,{className:"h-4 w-4"}),e.jsx("span",{children:o?"Copied!":"Copy Link"})]})]})]})]})]}),$==="certificate"&&e.jsxs("div",{className:"bg-white rounded-2xl p-8 shadow-lg border border-gray-200 text-center",children:[e.jsx(Oe,{className:"h-16 w-16 text-yellow-500 mx-auto mb-6"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Your Certificate"}),g.certificateUrl?e.jsxs("div",{className:"space-y-6",children:[e.jsx("p",{className:"text-gray-600",children:"Congratulations! Your certificate is ready for download."}),e.jsxs("div",{className:"bg-gradient-to-r from-orange-50 to-red-50 rounded-xl p-6 border border-orange-200",children:[e.jsx("div",{className:"font-semibold text-gray-900 mb-2",children:"Certificate of Completion"}),e.jsx("div",{className:"text-sm text-gray-600 mb-4",children:a.title}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Certificate ID: ",g.certificateId]})]}),e.jsxs("div",{className:"flex justify-center space-x-4",children:[e.jsxs("button",{onClick:A,className:"bg-gradient-to-r from-green-500 to-emerald-600 text-white px-8 py-3 rounded-xl font-semibold hover:from-green-600 hover:to-emerald-700 transition-all duration-200 shadow-lg flex items-center space-x-2",children:[e.jsx(Ve,{className:"h-5 w-5"}),e.jsx("span",{children:"Download Certificate"})]}),e.jsxs("a",{href:g.certificateUrl,target:"_blank",rel:"noopener noreferrer",className:"bg-white border border-gray-300 text-gray-700 px-8 py-3 rounded-xl font-medium hover:bg-gray-50 transition-all duration-200 flex items-center space-x-2",children:[e.jsx(Js,{className:"h-5 w-5"}),e.jsx("span",{children:"View Certificate"})]})]})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("p",{className:"text-gray-600",children:"Your certificate is being generated. Please check back in a few minutes."}),e.jsxs("button",{onClick:()=>window.location.reload(),className:"bg-gradient-to-r from-orange-500 to-red-500 text-white px-8 py-3 rounded-xl font-semibold hover:from-orange-600 hover:to-red-600 transition-all duration-200 shadow-lg flex items-center space-x-2 mx-auto",children:[e.jsx(We,{className:"h-5 w-5"}),e.jsx("span",{children:"Check Again"})]})]})]}),$==="next-steps"&&e.jsxs("div",{className:"space-y-8",children:[U.length>0&&e.jsxs("div",{className:"bg-white rounded-2xl p-8 shadow-lg border border-gray-200",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Recommended Next Steps"}),e.jsx("div",{className:"grid gap-6",children:U.map((f,h)=>e.jsxs("div",{className:"flex items-start space-x-4 p-4 bg-gray-50 rounded-xl",children:[e.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-gradient-to-r from-orange-400 to-red-500 rounded-full flex items-center justify-center text-white font-bold",children:h+1}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:f.title}),e.jsx("p",{className:"text-gray-600 mb-3",children:f.description}),(f.action||f.href)&&e.jsxs("button",{onClick:f.action,className:"text-orange-600 hover:text-orange-700 font-medium text-sm flex items-center space-x-1",children:[e.jsx("span",{children:"Get Started"}),e.jsx(qe,{className:"h-4 w-4"})]})]})]},h))})]}),I.length>0&&e.jsxs("div",{className:"bg-white rounded-2xl p-8 shadow-lg border border-gray-200",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Continue Learning"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:I.map(f=>e.jsxs("div",{className:"border border-gray-200 rounded-xl overflow-hidden hover:shadow-md transition-shadow",children:[e.jsx("img",{src:f.thumbnail,alt:f.title,className:"w-full h-32 object-cover"}),e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:f.title}),e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-600 mb-4",children:[e.jsx("span",{children:f.duration}),e.jsx("span",{className:"bg-gray-100 px-2 py-1 rounded",children:f.difficulty})]}),e.jsx("button",{className:"w-full bg-gradient-to-r from-orange-500 to-red-500 text-white py-2 rounded-lg font-medium hover:from-orange-600 hover:to-red-600 transition-all duration-200",children:"Start Course"})]})]},f.id))})]})]})]}),e.jsx("div",{className:"text-center mt-12",children:e.jsx("div",{className:"space-y-4",children:e.jsx("button",{onClick:P,className:"bg-white text-gray-700 border border-gray-300 px-8 py-3 rounded-xl font-medium hover:bg-gray-50 transition-all duration-200",children:"Return to Courses"})})})]}),e.jsx("style",{children:`
        .confetti-animation {
          position: absolute;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          overflow: hidden;
        }
        
        .confetti-piece {
          position: absolute;
          width: 8px;
          height: 8px;
          animation: confetti-fall 3s linear infinite;
        }
        
        @keyframes confetti-fall {
          0% {
            transform: translateY(-100vh) rotate(0deg);
            opacity: 1;
          }
          100% {
            transform: translateY(100vh) rotate(720deg);
            opacity: 0;
          }
        }
        
        @keyframes bounce-in {
          0% {
            transform: scale(0.3);
            opacity: 0;
          }
          50% {
            transform: scale(1.05);
            opacity: 1;
          }
          70% {
            transform: scale(0.9);
          }
          100% {
            transform: scale(1);
          }
        }
        
        .animate-bounce-in {
          animation: bounce-in 0.6s ease-out;
        }
      `})]})},jt=()=>{var Xe,Ze;const[a,g]=s.useState({clicks:0,timeSpent:0,interactions:0,completionPrediction:0}),[p,U]=s.useState([]),[I,P]=s.useState(!1),[A,E]=s.useState(null),N=s.useRef(),Q=s.useCallback(r=>H(void 0,null,function*(){N.current&&clearTimeout(N.current),N.current=setTimeout(()=>H(void 0,null,function*(){P(!0);try{E(new Date)}catch(m){}finally{P(!1)}}),2e3)}),[]),[z]=s.useState(Date.now()),$=s.useCallback((r,m)=>{g(d=>le(ne({},d),{clicks:d.clicks+(r==="click"?1:0),interactions:d.interactions+1,timeSpent:Date.now()-z}))},[z]),{moduleId:w,lessonId:T}=Xs(),x=Zs(),[o,v]=s.useState(0),[j,L]=s.useState(0),[S,B]=s.useState(""),[q,Y]=s.useState(0),[k,f]=s.useState({}),[h,l]=s.useState(!1),[n,y]=s.useState(null),[_,J]=s.useState({}),[de,fe]=s.useState(!1),[Ce,c]=s.useState(0),[F,V]=s.useState(0),[W,te]=s.useState(!0),ee=s.useRef(null),G=s.useRef(),[xe,me]=s.useState(Date.now()),[ie,ae]=s.useState(!1),[pe,se]=s.useState(!1),u=s.useMemo(()=>{const r=w?Ye.getCourse(w):null;return console.log("ðŸ“– Loading course data for ID:",w,"Found:",!!r,"Refresh time:",xe),r},[w,xe]),_e=r=>{var d;if(!r)return{isValid:!1,issues:["Course not found"]};const m=[];return(!r.modules||r.modules.length===0)&&m.push("No modules found"),r.title||m.push("Course title missing"),(d=r.modules)==null||d.forEach((O,R)=>{var D;(!O.lessons||O.lessons.length===0)&&m.push(`Module ${R+1} has no lessons`),(D=O.lessons)==null||D.forEach((ue,ke)=>{var Ae;ue.type==="video"&&!((Ae=ue.content)!=null&&Ae.videoUrl)&&m.push(`Module ${R+1}, Lesson ${ke+1}: Video lesson missing videoUrl`),ue.title||m.push(`Module ${R+1}, Lesson ${ke+1}: Missing title`)})}),{isValid:m.length===0,issues:m}},C=(Xe=u==null?void 0:u.modules)==null?void 0:Xe[o],t=C==null?void 0:C.lessons[j],Be=_e(u);console.log("ðŸ” Course Data Validation:",Be),console.log("ðŸ“š LMS Module Debug:",{moduleIdParam:w,lessonIdParam:T,course:u,courseModules:u==null?void 0:u.modules,currentModuleIndex:o,currentLessonIndex:j,currentModule:C,currentLessonData:t}),s.useEffect(()=>{const r=()=>{te(!0),G.current=setInterval(()=>{V(d=>d+1)},1e3)},m=()=>{te(!1),G.current&&clearInterval(G.current)};return window.addEventListener("focus",r),window.addEventListener("blur",m),r(),()=>{window.removeEventListener("focus",r),window.removeEventListener("blur",m),G.current&&clearInterval(G.current)}},[]),s.useEffect(()=>{w&&!u&&(console.log("ðŸ”„ Course not found, forcing store refresh for ID:",w),window.location.reload())},[w,u]);const Re=s.useCallback(()=>H(void 0,null,function*(){if(!ie){ae(!0);try{console.log("ðŸ”„ Manually refreshing course data..."),yield Ye.init(),me(Date.now()),setTimeout(()=>{ae(!1),se(!0),console.log("âœ… Course data refreshed successfully"),setTimeout(()=>{se(!1)},3e3)},1e3)}catch(r){console.error("âŒ Failed to refresh course data:",r),ae(!1)}}}),[ie]);s.useEffect(()=>{const r=setInterval(()=>H(void 0,null,function*(){!ie&&document.visibilityState==="visible"&&(console.log("ðŸ”„ Auto-refreshing course data..."),yield Ye.init(),me(Date.now()))}),3e4);return()=>clearInterval(r)},[ie]),s.useEffect(()=>{const r=ys.subscribeToCourseUpdates(d=>{console.log("ðŸ”„ Real-time course update received:",d),(d.courseId===w||d.manual)&&(me(Date.now()),d.manual&&(se(!0),setTimeout(()=>se(!1),3e3)))}),m=ys.subscribeToRefresh(d=>{console.log("ðŸ”„ Global refresh received:",d),me(Date.now()),d.manual&&(se(!0),setTimeout(()=>se(!1),3e3))});return()=>{r(),m()}},[w]),s.useEffect(()=>{const r=()=>{document.visibilityState==="visible"&&!ie&&(console.log("ðŸ‘ï¸ Page became visible, checking for course updates..."),Re())};return document.addEventListener("visibilitychange",r),()=>document.removeEventListener("visibilitychange",r)},[Re,ie]);const{lessonProgress:re,reflections:je,loading:i,error:M,updateLessonProgress:X,markLessonComplete:ye,saveReflection:Le,setActiveLessonTracking:$e}=it(w||"",{enableAutoSave:!0,enableRealtime:!0,autoSaveInterval:3e4});s.useEffect(()=>{t!=null&&t.id&&je[t.id]?B(je[t.id].content):B("")},[o,j,je,t]),s.useEffect(()=>{t!=null&&t.id&&$e&&$e(t.id)},[t==null?void 0:t.id,$e]),s.useEffect(()=>{if(u&&T)for(let r=0;r<(u.modules||[]).length;r++){const d=(u.modules||[])[r].lessons.findIndex(O=>O.id===T);if(d!==-1){v(r),L(d);return}}},[T,u]);const Se=s.useCallback(()=>H(void 0,null,function*(){const r=re[(t==null?void 0:t.id)||""];if(!((r==null?void 0:r.completed)||!1)&&t&&C&&(yield ye(t.id,C.id)),C&&j<C.lessons.length-1){const d=j+1;L(d),x(`/lms/module/${w}/lesson/${C.lessons[d].id}`)}else if(u&&o<(u.modules||[]).length-1){const d=o+1;v(d),L(0),x(`/lms/module/${w}/lesson/${(u.modules||[])[d].lessons[0].id}`)}f({}),l(!1),y(null),J({}),fe(!1)}),[j,o,u,C,t,re,ye,w,x]),Ee=s.useCallback(()=>{if(C&&j>0){const r=j-1;L(r),x(`/lms/module/${w}/lesson/${C.lessons[r].id}`)}else if(u&&o>0){const r=o-1,m=(u.modules||[])[r];v(r),L(m.lessons.length-1),x(`/lms/module/${w}/lesson/${m.lessons[m.lessons.length-1].id}`)}f({}),l(!1),y(null),J({}),fe(!1)},[j,o,u,C,w,x]),Ue=s.useCallback(r=>H(void 0,null,function*(){if(!(!t||!C))return X(t.id,C.id,r)}),[t,C,X]),be=s.useCallback(()=>H(void 0,null,function*(){if(!(!S.trim()||!t))try{yield Le(t.id,S)}catch(r){console.error("Error saving reflection:",r)}}),[S,t,Le]),Te=s.useCallback(()=>{if(!C||!t)return;const r=[],m=re[t.id],d=(m==null?void 0:m.completed)||!1;Ce<50&&a.timeSpent>3e5&&r.push({type:"speed",title:"Try adjusting video speed",description:"Consider increasing playback speed to 1.25x for better engagement",action:()=>{ee.current&&(ee.current.playbackRate=1.25)}}),d&&j<((C==null?void 0:C.lessons.length)||0)-1&&r.push({type:"next",title:"Continue momentum",description:"You're doing great! Ready for the next lesson?",action:Se}),S.length>0&&S.length<50&&r.push({type:"reflect",title:"Expand your reflection",description:"Add more details to deepen your learning experience",action:()=>{var O;return(O=document.querySelector("textarea"))==null?void 0:O.focus()}}),U(r)},[Ce,a,j,C,S,re,t,Se]);s.useEffect(()=>{a.interactions>0&&Te()},[a.interactions,Te]);const Ne=s.useMemo(()=>{var D;if(!u||a.timeSpent<6e4)return null;const r=((D=u.modules)==null?void 0:D.reduce((ue,ke)=>ue+ke.lessons.length,0))||0,m=Object.values(re).filter(ue=>ue.completed).length,d=a.timeSpent/Math.max(m,1),O=r-m,R=O*d;return{totalLessons:r,completedLessons:m,remainingLessons:O,estimatedTimeRemaining:R,completionPercentage:Math.round(m/r*100)}},[u,re,a.timeSpent]);if(!u)return e.jsxs("div",{className:"p-6 max-w-4xl mx-auto text-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Course Not Found"}),e.jsx(ze,{to:"/lms/courses",className:"text-orange-500 hover:text-orange-600",children:"â† Back to Courses"})]});if(i)return e.jsxs("div",{className:"p-6 max-w-4xl mx-auto text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-orange-500 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Loading course..."})]});if(M)return e.jsx("div",{className:"p-6 max-w-4xl mx-auto text-center",children:e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-red-900 mb-2",children:"Unable to Load Course"}),e.jsx("p",{className:"text-red-700 mb-4",children:"Please make sure you're logged in and try again."}),e.jsx(ze,{to:"/lms/login",className:"inline-flex items-center bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700",children:"Go to Login"})]})});if(!C||!t)return e.jsx("div",{className:"p-6",children:"Loading..."});const oe=re[t.id],Ge=(oe==null?void 0:oe.completed)||!1,He=()=>H(void 0,null,function*(){if(!t.content.questions)return;const r=t.content.questions;let m=0;const d=r.length;r.forEach(D=>{k[D.id]===D.correctAnswerIndex&&m++});const R=Math.round(m/d*100)>=(t.content.passingScore||80);y({score:m,maxScore:d,passed:R}),l(!0)}),Cs=()=>{fe(!0),Object.entries(_).some(([m,d])=>{var R,D;if(!d)return!1;const O=(D=(R=t.content)==null?void 0:R.options)==null?void 0:D[parseInt(m)];return O==null?void 0:O.isCorrect})&&Ue({completed:!0,progress_percentage:100})},Ss=r=>{switch(r){case"video":return e.jsx(nt,{className:"h-5 w-5"});case"interactive":return e.jsx(Qe,{className:"h-5 w-5"});case"quiz":return e.jsx(Z,{className:"h-5 w-5"});case"download":return e.jsx(Ve,{className:"h-5 w-5"});case"text":return e.jsx(Pe,{className:"h-5 w-5"});default:return e.jsx(Pe,{className:"h-5 w-5"})}},ks=()=>{var r,m;return e.jsxs("div",{className:"bg-orange-50 p-6 rounded-lg",children:[(r=t.content.questions)==null?void 0:r.map((d,O)=>e.jsxs("div",{className:"mb-8 last:mb-6",children:[e.jsxs("h4",{className:"font-medium text-orange-900 mb-4 text-lg",children:["Question ",O+1,": ",d.text]}),e.jsx("div",{className:"space-y-3",children:d.options.map((R,D)=>e.jsx("button",{onClick:()=>{h||f(ue=>le(ne({},ue),{[d.id]:D}))},disabled:h,className:`w-full text-left p-4 border-2 rounded-lg transition-all duration-200 ${h?D===d.correctAnswerIndex?"border-green-500 bg-green-50":k[d.id]===D?"border-red-500 bg-red-50":"border-gray-200 bg-gray-50":k[d.id]===D?"border-orange-500 bg-orange-50":"border-orange-200 hover:border-orange-300 hover:bg-orange-50"} ${h?"cursor-default":"cursor-pointer"}`,children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`w-4 h-4 rounded-full border-2 ${h?D===d.correctAnswerIndex?"border-green-500 bg-green-500":k[d.id]===D?"border-red-500 bg-red-500":"border-gray-300":k[d.id]===D?"border-orange-500 bg-orange-500":"border-orange-300"}`,children:(h&&D===d.correctAnswerIndex||!h&&k[d.id]===D)&&e.jsx("div",{className:"w-full h-full rounded-full bg-white scale-50"})}),e.jsx("span",{className:"text-orange-900",children:R})]})},D))}),h&&d.explanation&&e.jsxs("div",{className:"mt-4 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsx("h5",{className:"font-medium text-blue-900 mb-2",children:"Explanation:"}),e.jsx("p",{className:"text-blue-800 text-sm",children:d.explanation})]})]},d.id)),!h&&e.jsx("div",{className:"text-center",children:e.jsxs("button",{onClick:He,disabled:Object.keys(k).length!==((m=t.content.questions)==null?void 0:m.length),className:"bg-orange-600 text-white px-8 py-3 rounded-lg hover:bg-orange-700 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center mx-auto space-x-2",children:[e.jsx(js,{className:"h-5 w-5"}),e.jsx("span",{children:"Submit Quiz"})]})}),h&&n&&e.jsx("div",{className:`mt-6 p-6 rounded-lg border-2 ${n.passed?"border-green-500 bg-green-50":"border-red-500 bg-red-50"}`,children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:`text-3xl font-bold mb-2 ${n.passed?"text-green-600":"text-red-600"}`,children:[Math.round(n.score/n.maxScore*100),"%"]}),e.jsx("p",{className:`text-lg font-medium mb-2 ${n.passed?"text-green-800":"text-red-800"}`,children:n.passed?"Congratulations! You passed!":"Keep studying and try again"}),e.jsxs("p",{className:`text-sm ${n.passed?"text-green-700":"text-red-700"}`,children:["You scored ",n.score," out of ",n.maxScore," questions correctly"]}),n.passed&&e.jsxs("div",{className:"mt-4 flex items-center justify-center space-x-2 text-green-700",children:[e.jsx(Oe,{className:"h-5 w-5"}),e.jsx("span",{className:"font-medium",children:"Lesson completed!"})]})]})})]})},_s=()=>{var R,D,ue,ke,Ae,es,ss,ts,rs,ns,as,os,ls,is,cs,ds,ms;if(console.log("ðŸŽ¥ Rendering lesson content:",{lessonData:t,type:t.type,content:t.content,videoUrl:(R=t.content)==null?void 0:R.videoUrl}),console.log("ðŸ” Video Debug Details:",{lessonType:t.type,content:t.content,videoUrl:(D=t.content)==null?void 0:D.videoUrl,videoSourceType:(ue=t.content)==null?void 0:ue.videoSourceType,hasContent:!!t.content}),((ke=t.content)==null?void 0:ke.videoUrl)||t.type==="video"||t.type==="video"){let b=(Ae=t.content)==null?void 0:Ae.videoUrl;console.log("ðŸŽ¯ Current Lesson Debug:",{lessonId:t.id,lessonTitle:t.title,lessonType:t.type,courseId:u==null?void 0:u.id,courseTitle:u==null?void 0:u.title,moduleId:C==null?void 0:C.id,moduleTitle:C==null?void 0:C.title,contentKeys:Object.keys(t.content||{}),videoUrl:b});const ve=b&&b.trim()!==""&&b!=="undefined"&&b!=="null"&&!b.includes("placeholder")&&(b.startsWith("http")||b.startsWith("blob:")||b.startsWith("data:"));(b==null?void 0:b.startsWith("blob:"))&&console.log("âš ï¸ Warning: Blob URL detected - this may not work after page reload:",b),console.log("ðŸ” Video URL Validation:",{rawVideoUrl:b,isValidVideoUrl:ve,urlLength:b==null?void 0:b.length,trimmed:b==null?void 0:b.trim()});const Fe=ve?b:"https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4",Ie=!ve;return console.log("ðŸŽ¬ Video URL Decision:",{videoUrl:b,finalVideoUrl:Fe,isUsingFallback:Ie}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(ct,{src:Fe,title:t.title,onProgress:ce=>{var xs;if(c(ce),ce>((oe==null?void 0:oe.progress_percentage)||0)){const $s={progress_percentage:ce,time_spent:Math.round(ce/100*(((xs=ee.current)==null?void 0:xs.duration)||0))};Q({lessonId:t.id,moduleId:C.id,progress:$s})}(ce===25||ce===50||ce===75)&&$("progress_milestone",{milestone:ce})},onComplete:()=>{$("video_complete"),X(t.id,C.id,{completed:!0,progress_percentage:100});const ce=new CustomEvent("show-notification",{detail:{type:"success",message:"ðŸŽ‰ Lesson completed! Great job!",duration:3e3}});window.dispatchEvent(ce)},initialTime:(oe==null?void 0:oe.time_spent)||0,autoPlay:!1,showTranscript:!!((es=t.content)!=null&&es.transcript),transcript:((ss=t.content)==null?void 0:ss.transcript)||"",captions:((rs=(ts=t.content)==null?void 0:ts.captions)==null?void 0:rs.map(ce=>({start:ce.startTime||0,end:ce.endTime||0,text:ce.text||""})))||[],className:"aspect-video"}),Ie&&e.jsx("div",{className:"bg-yellow-50 p-4 rounded-lg border border-yellow-200",children:e.jsxs("p",{className:"text-yellow-800 text-sm",children:[e.jsx("strong",{children:"ðŸš§ Demo Video:"})," Using fallback video for demonstration."]})}),!Ie&&e.jsx("div",{className:"bg-green-50 p-4 rounded-lg border border-green-200",children:e.jsxs("p",{className:"text-green-800 text-sm",children:[e.jsx("strong",{children:"âœ… Course Video:"})," Playing actual lesson video content."]})}),Ie&&e.jsxs("div",{className:"bg-yellow-50 p-4 rounded-lg border border-yellow-200",children:[e.jsx("p",{className:"text-yellow-800 text-sm",children:e.jsxs(e.Fragment,{children:[e.jsx("strong",{children:"ðŸš§ Demo Video:"})," No valid video URL found in lesson content. Playing fallback video for demonstration."]})}),e.jsx("div",{className:"mt-3 text-xs text-yellow-700 bg-yellow-100 p-2 rounded",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("strong",{children:"Debug Info:"}),e.jsx("br",{}),"Course ID: ",(u==null?void 0:u.id)||"undefined",e.jsx("br",{}),"Lesson ID: ",(t==null?void 0:t.id)||"undefined",e.jsx("br",{}),"Lesson Type: ",(t==null?void 0:t.type)||"undefined",e.jsx("br",{}),"Video URL: ",b||"undefined",e.jsx("br",{}),"Content Keys: ",Object.keys((t==null?void 0:t.content)||{}).join(", ")||"none"]}),e.jsxs("div",{className:"ml-4 flex flex-col space-y-1",children:[e.jsx("button",{onClick:()=>{console.log("ðŸ”„ Force refreshing course data..."),window.location.reload()},className:"bg-yellow-600 text-white px-2 py-1 rounded text-xs hover:bg-yellow-700",children:"Refresh"}),e.jsx("button",{onClick:()=>{console.log("ðŸ” Course Data:",u),console.log("ðŸ“Š Current Lesson:",t),alert("Check browser console for detailed course data")},className:"bg-blue-600 text-white px-2 py-1 rounded text-xs hover:bg-blue-700",children:"Debug"})]})]})})]}),!Ie&&e.jsx("div",{className:"bg-green-50 p-4 rounded-lg border border-green-200",children:e.jsxs("p",{className:"text-green-800 text-sm",children:[e.jsx("strong",{children:"âœ… Course Video:"})," Playing actual lesson video content."]})}),((ns=t.content)==null?void 0:ns.transcript)&&e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Transcript"}),e.jsx("p",{className:"text-gray-700 text-sm whitespace-pre-wrap",children:t.content.transcript})]}),((as=t.content)==null?void 0:as.notes)&&e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"Key Notes"}),e.jsx("p",{className:"text-blue-800 text-sm",children:t.content.notes})]})]})}const m=((os=t.content)==null?void 0:os.questions)&&t.content.questions.length>0,d=((ls=t.content)==null?void 0:ls.content)||((is=t.content)==null?void 0:is.textContent),O=[];if(m&&O.push(e.jsx("div",{className:"mt-8",children:e.jsxs("div",{className:"border-t border-gray-200 pt-8",children:[e.jsxs("h3",{className:"text-xl font-bold text-gray-900 mb-6 flex items-center",children:[e.jsx(Z,{className:"h-6 w-6 mr-2 text-orange-500"}),"Knowledge Check"]}),ks()]})},"quiz-section")),d&&O.push(e.jsx("div",{className:"mt-8",children:e.jsx("div",{className:"border-t border-gray-200 pt-8",children:e.jsx("div",{className:"prose max-w-none",children:e.jsxs("div",{className:"bg-blue-50 p-6 rounded-lg",children:[e.jsx("h3",{className:"text-xl font-bold text-blue-900 mb-4",children:t.content.title||"Additional Reading"}),e.jsx("div",{className:"text-blue-800 whitespace-pre-wrap",children:t.content.content||t.content.textContent})]})})})},"text-section")),O.length>0)return e.jsx("div",{className:"space-y-6",children:O});switch(t.type){case"interactive":return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-green-50 p-6 rounded-lg",children:[e.jsx("h3",{className:"text-xl font-bold text-green-900 mb-4",children:"Interactive Exercise"}),e.jsx("p",{className:"text-green-800 text-lg mb-6",children:t.content.scenarioText}),t.content.instructions&&e.jsx("div",{className:"bg-green-100 p-4 rounded-lg mb-6",children:e.jsx("p",{className:"text-green-800 text-sm font-medium",children:t.content.instructions})}),e.jsx("div",{className:"space-y-3",children:(cs=t.content.options)==null?void 0:cs.map((b,ve)=>e.jsxs("button",{onClick:()=>{J({[ve]:!0}),de||fe(!0)},className:`w-full text-left p-4 border-2 rounded-lg transition-all duration-200 ${_[ve]?b.isCorrect?"border-green-500 bg-green-50":"border-red-500 bg-red-50":"border-green-200 hover:border-green-300 hover:bg-green-50"}`,children:[e.jsx("p",{className:"font-medium text-green-900 mb-2",children:b.text}),de&&_[ve]&&e.jsxs("div",{className:`mt-3 p-3 rounded-lg ${b.isCorrect?"bg-green-100":"bg-red-100"}`,children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[b.isCorrect?e.jsx(Z,{className:"h-5 w-5 text-green-600"}):e.jsx(bs,{className:"h-5 w-5 text-red-600"}),e.jsx("span",{className:`font-medium ${b.isCorrect?"text-green-800":"text-red-800"}`,children:b.isCorrect?"Correct!":"Not quite right"})]}),e.jsx("p",{className:`text-sm ${b.isCorrect?"text-green-700":"text-red-700"}`,children:b.feedback})]})]},ve))}),de&&e.jsx("div",{className:"mt-6 text-center",children:e.jsxs("button",{onClick:Cs,className:"bg-green-600 text-white px-6 py-3 rounded-lg hover:bg-green-700 transition-colors duration-200 flex items-center mx-auto space-x-2",children:[e.jsx(Z,{className:"h-5 w-5"}),e.jsx("span",{children:"Complete Exercise"})]})})]})});case"quiz":return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-orange-50 p-6 rounded-lg",children:[e.jsx("h3",{className:"text-xl font-bold text-orange-900 mb-6",children:"Knowledge Check"}),(ds=t.content.questions)==null?void 0:ds.map((b,ve)=>e.jsxs("div",{className:"mb-8 last:mb-6",children:[e.jsxs("h4",{className:"font-medium text-orange-900 mb-4 text-lg",children:["Question ",ve+1,": ",b.text]}),e.jsx("div",{className:"space-y-3",children:b.options.map((us,he)=>e.jsx("button",{onClick:()=>{h||f(Fe=>le(ne({},Fe),{[b.id]:he}))},disabled:h,className:`w-full text-left p-4 border-2 rounded-lg transition-all duration-200 ${h?he===b.correctAnswerIndex?"border-green-500 bg-green-50":k[b.id]===he?"border-red-500 bg-red-50":"border-gray-200 bg-gray-50":k[b.id]===he?"border-orange-500 bg-orange-50":"border-orange-200 hover:border-orange-300 hover:bg-orange-50"} ${h?"cursor-default":"cursor-pointer"}`,children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`w-4 h-4 rounded-full border-2 ${h?he===b.correctAnswerIndex?"border-green-500 bg-green-500":k[b.id]===he?"border-red-500 bg-red-500":"border-gray-300":k[b.id]===he?"border-orange-500 bg-orange-500":"border-orange-300"}`,children:(h&&he===b.correctAnswerIndex||!h&&k[b.id]===he)&&e.jsx("div",{className:"w-full h-full rounded-full bg-white scale-50"})}),e.jsx("span",{className:"text-orange-900",children:us})]})},he))}),h&&b.explanation&&e.jsxs("div",{className:"mt-4 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsx("h5",{className:"font-medium text-blue-900 mb-2",children:"Explanation:"}),e.jsx("p",{className:"text-blue-800 text-sm",children:b.explanation})]})]},b.id)),!h&&e.jsx("div",{className:"text-center",children:e.jsxs("button",{onClick:He,disabled:Object.keys(k).length!==((ms=t.content.questions)==null?void 0:ms.length),className:"bg-orange-600 text-white px-8 py-3 rounded-lg hover:bg-orange-700 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center mx-auto space-x-2",children:[e.jsx(js,{className:"h-5 w-5"}),e.jsx("span",{children:"Submit Quiz"})]})}),h&&n&&e.jsx("div",{className:`mt-6 p-6 rounded-lg border-2 ${n.passed?"border-green-500 bg-green-50":"border-red-500 bg-red-50"}`,children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:`text-3xl font-bold mb-2 ${n.passed?"text-green-600":"text-red-600"}`,children:[Math.round(n.score/n.maxScore*100),"%"]}),e.jsx("p",{className:`text-lg font-medium mb-2 ${n.passed?"text-green-800":"text-red-800"}`,children:n.passed?"Congratulations! You passed!":"Keep studying and try again"}),e.jsxs("p",{className:`text-sm ${n.passed?"text-green-700":"text-red-700"}`,children:["You scored ",n.score," out of ",n.maxScore," questions correctly"]}),n.passed&&e.jsxs("div",{className:"mt-4 flex items-center justify-center space-x-2 text-green-700",children:[e.jsx(Oe,{className:"h-5 w-5"}),e.jsx("span",{className:"font-medium",children:"Lesson completed!"})]})]})})]})});case"document":return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-blue-50 p-6 rounded-lg",children:[e.jsx("h3",{className:"text-xl font-bold text-blue-900 mb-4",children:t.content.title||t.title}),e.jsx("p",{className:"text-blue-800 mb-6",children:t.content.description||"Download the resource below to continue your learning."}),t.content.fileUrl&&t.content.fileUrl.trim()?e.jsx("div",{className:"text-center",children:e.jsxs("a",{href:t.content.fileUrl,download:t.content.fileName,onClick:()=>{X(t.id,C.id,{completed:!0,progress_percentage:100})},target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center bg-blue-600 text-white px-8 py-4 rounded-lg hover:bg-blue-700 transition-colors duration-200 space-x-3 text-lg font-medium",children:[e.jsx(Ve,{className:"h-6 w-6"}),e.jsxs("span",{children:["Download ",t.content.fileName||"Resource"]}),t.content.fileSize&&e.jsxs("span",{className:"text-blue-200",children:["(",t.content.fileSize,")"]})]})}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(vs,{className:"h-12 w-12 text-blue-400 mx-auto mb-4"}),e.jsx("p",{className:"text-blue-700",children:"Resource is being prepared"}),e.jsx("p",{className:"text-blue-600 text-sm mt-1",children:"Please check back later or contact your instructor"})]}),t.content.instructions&&e.jsxs("div",{className:"mt-6 bg-blue-100 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"Instructions"}),e.jsx("p",{className:"text-blue-800 text-sm",children:t.content.instructions})]})]})});case"text":return e.jsx("div",{className:"space-y-6",children:e.jsx("div",{className:"bg-indigo-50 p-6 rounded-lg",children:e.jsxs("div",{className:"prose max-w-none",children:[t.content.content&&e.jsx("div",{className:"text-gray-900 leading-relaxed whitespace-pre-wrap mb-6",children:t.content.content}),t.content.allowReflection&&t.content.reflectionPrompt&&e.jsxs("div",{className:"mt-8 bg-indigo-100 p-6 rounded-lg border border-indigo-200",children:[e.jsxs("h4",{className:"font-medium text-indigo-900 mb-4 flex items-center",children:[e.jsx(Qe,{className:"h-5 w-5 mr-2"}),"Reflection",t.content.requireReflection&&e.jsx("span",{className:"ml-2 text-sm text-indigo-700 bg-indigo-200 px-2 py-1 rounded",children:"Required"})]}),e.jsx("p",{className:"text-indigo-800 mb-4",children:t.content.reflectionPrompt}),e.jsx("textarea",{rows:6,className:"w-full p-4 border border-indigo-200 rounded-lg resize-vertical focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent",placeholder:"Share your thoughts and reflections here...",onChange:b=>{b.target.value.length>50&&X(t.id,C.id,{progress_percentage:Math.max((oe==null?void 0:oe.progress_percentage)||0,75),time_spent:((oe==null?void 0:oe.time_spent)||0)+1})}}),e.jsxs("div",{className:"mt-4 flex justify-between items-center",children:[e.jsx("p",{className:"text-sm text-indigo-600",children:"Take your time to reflect on the content above."}),e.jsxs("button",{onClick:()=>{X(t.id,C.id,{completed:!0,progress_percentage:100})},className:"bg-indigo-600 text-white px-6 py-2 rounded-lg hover:bg-indigo-700 transition-colors duration-200 flex items-center space-x-2",children:[e.jsx(Z,{className:"h-4 w-4"}),e.jsx("span",{children:"Complete Reflection"})]})]})]}),!t.content.allowReflection&&e.jsx("div",{className:"mt-8 text-center",children:e.jsxs("button",{onClick:()=>{X(t.id,C.id,{completed:!0,progress_percentage:100})},className:"bg-indigo-600 text-white px-8 py-3 rounded-lg hover:bg-indigo-700 transition-colors duration-200 flex items-center mx-auto space-x-2",children:[e.jsx(Z,{className:"h-5 w-5"}),e.jsx("span",{children:"Mark as Complete"})]})})]})})});default:return e.jsxs("div",{className:"bg-gray-50 p-6 rounded-lg text-center",children:[e.jsx(Pe,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:t.title}),e.jsx("p",{className:"text-gray-600",children:"Content for this lesson type is not yet available."})]})}},we=(()=>{const r=(u.modules||[]).reduce((d,O)=>d+O.lessons.length,0),m=Object.values(re).filter(d=>d.completed).length;return r>0?Math.round(m/r*100):0})(),[Rs,Je]=s.useState(!1);return s.useEffect(()=>{we>=100&&Je(!0)},[we]),e.jsxs("div",{className:"p-6 max-w-7xl mx-auto",style:{minHeight:"100vh"},children:[e.jsx(dt,{currentProgress:we,totalLessons:(u.modules||[]).reduce((r,m)=>r+m.lessons.length,0),completedLessons:Object.values(re).filter(r=>r.completed).length,currentLessonTitle:t.title,onPrevious:Ee,onNext:Se,hasPrevious:!(o===0&&j===0),hasNext:!0,estimatedTimeRemaining:Ne?`${Math.round(Ne.estimatedTimeRemaining/(1e3*60*60*24))} days`:void 0,visible:!0}),pe&&e.jsxs("div",{className:"fixed top-4 right-4 z-50 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg flex items-center space-x-2 animate-fade-in",children:[e.jsx(Z,{className:"h-5 w-5"}),e.jsx("span",{children:"Course content refreshed successfully!"})]}),we>=100&&Rs&&e.jsx(mt,{course:{id:u.id,title:u.title,description:u.description||"",instructor:u.instructorName||"Course Instructor",duration:u.duration,modules:(Ze=u.modules)==null?void 0:Ze.map(r=>({id:r.id,title:r.title,lessons:r.lessons.map(m=>{var d;return{id:m.id,title:m.title,completed:((d=re[m.id])==null?void 0:d.completed)||!1}})}))},completionData:{completedAt:new Date,timeSpent:Math.round(F/60),score:85,grade:"A",certificateId:`cert-${u.id}-${Date.now()}`,certificateUrl:`/certificates/${u.id}`},keyTakeaways:u.keyTakeaways||["Enhanced leadership skills through practical application","Improved understanding of team dynamics and communication","Developed strategic thinking and decision-making abilities"],nextSteps:[{title:"Advanced Leadership Course",description:"Continue your leadership journey with advanced concepts",href:"/lms/courses/advanced-leadership"},{title:"Mentorship Program",description:"Apply your skills by mentoring other learners",href:"/lms/mentorship"}],onClose:()=>{Je(!1),x("/lms/courses")},onCertificateDownload:()=>H(void 0,null,function*(){$("certificate_downloaded")}),onShareComplete:r=>{$("achievement_shared",{platform:r})}}),e.jsxs("div",{className:"mb-6",children:[e.jsxs(ze,{to:"/lms/courses",className:"inline-flex items-center text-orange-500 hover:text-orange-600 mb-4",children:[e.jsx(ps,{className:"h-4 w-4 mr-2"}),"Back to Courses"]}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:u.title}),e.jsx("p",{className:"text-gray-600",children:u.description}),e.jsxs("div",{className:"mt-2 flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm text-gray-500",children:["Module ",o+1," of ",(u.modules||[]).length,": ",C.title]}),e.jsxs("button",{onClick:Re,disabled:ie,className:"inline-flex items-center px-3 py-1.5 text-sm font-medium text-gray-700 bg-gray-100 border border-gray-300 rounded-lg hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",title:"Refresh course content",children:[e.jsx(We,{className:`h-4 w-4 mr-1 ${ie?"animate-spin":""}`}),ie?"Refreshing...":"Refresh Content"]})]})]}),pe&&e.jsxs("div",{className:"fixed top-4 right-4 z-50 bg-green-100 border border-green-400 text-green-800 px-4 py-3 rounded-lg shadow-lg flex items-center space-x-2",children:[e.jsx(Z,{className:"h-5 w-5 text-green-600"}),e.jsx("span",{className:"font-medium",children:"Course content updated successfully!"})]}),e.jsxs("div",{className:"flex flex-col lg:flex-row gap-6",children:[u&&u.modules&&u.modules.length>0&&e.jsx("div",{className:"lg:w-80 flex-shrink-0",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Course Progress"}),e.jsx("div",{className:"space-y-4",children:(u.modules||[]).map((r,m)=>e.jsxs("div",{className:"border border-gray-200 rounded-lg",children:[e.jsx("div",{className:"p-3 bg-gray-50 border-b border-gray-200",children:e.jsx("h4",{className:"font-medium text-gray-900",children:r.title})}),e.jsx("div",{className:"p-2 space-y-1",children:r.lessons.map((d,O)=>{const R=re[d.id],D=m===o&&O===j;return e.jsx("button",{onClick:()=>{v(m),L(O),f({}),l(!1),y(null),x(`/lms/module/${r.id}/lesson/${d.id}`)},className:`w-full text-left p-2 rounded-lg transition-colors duration-200 ${D?"bg-orange-50 border border-orange-200":"hover:bg-gray-50"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`p-1 rounded ${D?"text-orange-500":R!=null&&R.completed?"text-green-500":"text-gray-400"}`,children:R!=null&&R.completed?e.jsx(Z,{className:"h-5 w-5"}):e.jsx(De,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("p",{className:`font-medium text-sm ${D?"text-orange-900":"text-gray-900"}`,children:d.title}),e.jsx("p",{className:"text-xs text-gray-600",children:d.duration})]})]}),(R==null?void 0:R.completed)&&e.jsx(Z,{className:"h-4 w-4 text-green-500"})]})},d.id)})})]},r.id))})]})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 mb-6",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:t.title}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-600",children:[e.jsxs("span",{className:"flex items-center",children:[e.jsx(De,{className:"h-4 w-4 mr-1"}),t.duration]}),e.jsx("span",{className:"capitalize",children:t.type}),Ge&&e.jsxs("span",{className:"flex items-center text-green-600",children:[e.jsx(Z,{className:"h-4 w-4 mr-1"}),"Completed"]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:Ee,disabled:o===0&&j===0,className:"p-2 rounded-lg border border-gray-300 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(ps,{className:"h-5 w-5"})}),e.jsx("button",{onClick:Se,className:"p-2 rounded-lg border border-gray-300 hover:bg-gray-50",children:e.jsx(qe,{className:"h-5 w-5"})}),!Ge&&t.type!=="quiz"&&e.jsxs("button",{onClick:()=>ye(t.id,C.id),className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors duration-200 flex items-center space-x-2",children:[e.jsx(Z,{className:"h-4 w-4"}),e.jsx("span",{children:"Mark Complete"})]})]})]})}),e.jsx("div",{className:"p-6",children:_s()})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-900 flex items-center",children:[e.jsx(Qe,{className:"h-5 w-5 mr-2 text-blue-500"}),"Reflection & Notes"]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[I&&e.jsxs("div",{className:"flex items-center text-orange-600 text-sm",children:[e.jsx(We,{className:"h-4 w-4 mr-1 animate-spin"}),"Auto-saving..."]}),A&&e.jsxs("div",{className:"flex items-center text-green-600 text-sm",children:[e.jsx(Z,{className:"h-4 w-4 mr-1"}),"Saved ",A.toLocaleTimeString()]})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("textarea",{value:S,onChange:r=>{B(r.target.value),$("reflection_edit"),Q({lessonId:t.id,moduleId:C.id,progress:{reflection:r.target.value}})},onFocus:()=>$("reflection_focus"),placeholder:"What are your key takeaways from this lesson? How will you apply these concepts in your leadership role?",className:"w-full h-32 p-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent resize-none transition-all duration-200"}),e.jsx("div",{className:"absolute bottom-2 right-2 flex items-center space-x-2",children:e.jsxs("div",{className:`text-xs px-2 py-1 rounded ${S.length>200?"bg-green-100 text-green-600":S.length>50?"bg-yellow-100 text-yellow-600":"bg-gray-100 text-gray-600"}`,children:[S.length," chars"]})})]}),S.length<50&&e.jsxs("div",{className:"mt-3 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsx("p",{className:"text-sm text-blue-800 font-medium mb-2",children:"ðŸ’¡ Writing Prompts:"}),e.jsxs("ul",{className:"text-sm text-blue-700 space-y-1",children:[e.jsx("li",{children:"â€¢ What surprised you most about this content?"}),e.jsx("li",{children:"â€¢ How does this relate to your current leadership challenges?"}),e.jsx("li",{children:"â€¢ What specific action will you take this week?"})]})]}),e.jsxs("div",{className:"flex justify-between items-center mt-4",children:[e.jsx("p",{className:"text-sm text-gray-600",children:je[t.id]?`Previously saved: ${new Date(je[t.id].updated_at).toLocaleString()}`:"Notes are auto-saved as you type"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[S.length>=100&&e.jsxs("div",{className:"flex items-center text-green-600 text-sm",children:[e.jsx(Me,{className:"h-4 w-4 mr-1"}),"Great reflection!"]}),e.jsxs("button",{onClick:be,disabled:!S.trim(),className:"bg-orange-500 text-white px-4 py-2 rounded-lg hover:bg-orange-600 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:[e.jsx(et,{className:"h-4 w-4"}),e.jsx("span",{children:"Save Now"})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Key Takeaways"}),e.jsx("ul",{className:"space-y-3",children:(u.keyTakeaways||[]).map((r,m)=>e.jsxs("li",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"w-2 h-2 bg-orange-400 rounded-full mt-2 flex-shrink-0"}),e.jsx("span",{className:"text-gray-700",children:r})]},m))})]})]}),e.jsxs("div",{className:"lg:w-80 flex-shrink-0 space-y-6",children:[p.length>0&&e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-xl shadow-sm border border-blue-200 p-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-blue-900 mb-4 flex items-center",children:[e.jsx(st,{className:"h-5 w-5 mr-2 text-yellow-500"}),"Smart Recommendations"]}),e.jsx("div",{className:"space-y-3",children:p.map((r,m)=>e.jsx("div",{className:"bg-white/80 backdrop-blur-sm rounded-lg p-4 border border-blue-200/50 hover:bg-white/90 transition-all duration-200",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold text-blue-900 mb-1",children:r.title}),e.jsx("p",{className:"text-sm text-blue-700 mb-3",children:r.description}),e.jsxs("button",{onClick:r.action,className:"inline-flex items-center px-3 py-1.5 bg-blue-600 text-white text-sm font-medium rounded-md hover:bg-blue-700 transition-colors duration-200",children:[e.jsx(Ns,{className:"h-3 w-3 mr-1"}),"Apply"]})]}),e.jsxs("div",{className:"ml-3",children:[r.type==="speed"&&e.jsx(tt,{className:"h-5 w-5 text-blue-500"}),r.type==="next"&&e.jsx(qe,{className:"h-5 w-5 text-green-500"}),r.type==="reflect"&&e.jsx(Qe,{className:"h-5 w-5 text-orange-500"})]})]})},m))})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-900 mb-4 flex items-center",children:[e.jsx(rt,{className:"h-5 w-5 mr-2 text-green-500"}),"Your Progress Today"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:Math.round(F/60)}),e.jsx("div",{className:"text-xs text-gray-600",children:"Minutes Focused"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:a.interactions}),e.jsx("div",{className:"text-xs text-gray-600",children:"Interactions"})]})]}),Ne&&e.jsxs("div",{className:"mt-4 p-3 bg-gradient-to-r from-purple-50 to-pink-50 rounded-lg border border-purple-200",children:[e.jsx("div",{className:"text-sm font-medium text-purple-900 mb-1",children:"Completion Prediction"}),e.jsxs("div",{className:"text-lg font-bold text-purple-600",children:[Math.round(Ne.estimatedTimeRemaining/(1e3*60*60*24))," days"]}),e.jsxs("div",{className:"text-xs text-purple-700",children:[Ne.remainingLessons," lessons remaining"]})]}),!W&&e.jsxs("div",{className:"mt-3 flex items-center text-amber-600 text-sm",children:[e.jsx(bs,{className:"h-4 w-4 mr-1"}),"Focus to continue tracking progress"]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Course Progress"}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex justify-between text-sm text-gray-600 mb-2",children:[e.jsx("span",{children:"Overall Progress"}),e.jsxs("span",{children:[we,"%"]})]}),e.jsxs("div",{className:"w-full bg-gray-200 rounded-full h-3 relative overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-orange-400 to-red-500 h-3 rounded-full transition-all duration-700 ease-out relative",style:{width:`${we}%`},children:e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent animate-pulse"})}),[25,50,75].map(r=>e.jsx("div",{className:`absolute top-0 bottom-0 w-0.5 transition-colors duration-300 ${we>=r?"bg-green-400":"bg-gray-300"}`,style:{left:`${r}%`}},r))]})]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"font-medium",children:Object.values(re).filter(r=>r.completed).length})," of"," ",e.jsx("span",{className:"font-medium",children:(u.modules||[]).reduce((r,m)=>r+m.lessons.length,0)})," lessons completed"]}),we===100&&e.jsxs("div",{className:"mt-4 p-4 bg-gradient-to-r from-green-50 to-emerald-50 border-2 border-green-200 rounded-lg text-center relative overflow-hidden animate-pulse",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-green-100/0 via-green-100/50 to-green-100/0 animate-pulse"}),e.jsxs("div",{className:"relative",children:[e.jsx(Oe,{className:"h-10 w-10 text-green-600 mx-auto mb-3 animate-bounce"}),e.jsxs("div",{className:"flex items-center justify-center space-x-1 mb-2",children:[e.jsx("span",{className:"text-2xl",children:"ðŸŽ‰"}),e.jsx("p",{className:"font-bold text-green-800 text-lg",children:"Course Completed!"}),e.jsx("span",{className:"text-2xl",children:"ðŸŽ‰"})]}),e.jsx("p",{className:"text-sm text-green-700 mb-3",children:"Congratulations! You've successfully completed all lessons."}),e.jsxs("div",{className:"flex justify-center space-x-4 text-xs text-green-600",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Z,{className:"h-3 w-3"}),e.jsxs("span",{children:[Object.values(re).filter(r=>r.completed).length," Lessons"]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(De,{className:"h-3 w-3"}),e.jsx("span",{children:u.duration})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Ke,{className:"h-3 w-3"}),e.jsx("span",{children:"100% Complete"})]})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Course Content"}),e.jsx("div",{className:"space-y-4",children:(u.modules||[]).map((r,m)=>e.jsxs("div",{className:"border border-gray-200 rounded-lg",children:[e.jsxs("div",{className:"p-3 bg-gray-50 border-b border-gray-200",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:r.title}),e.jsxs("p",{className:"text-sm text-gray-600",children:[r.lessons.length," lessons â€¢ ",r.duration]})]}),e.jsx("div",{className:"p-2 space-y-1",children:r.lessons.map((d,O)=>{const R=re[d.id],D=m===o&&O===j;return e.jsxs("button",{onClick:()=>{v(m),L(O),f({}),l(!1),y(null),J({}),fe(!1),x(`/lms/module/${w}/lesson/${d.id}`)},className:`w-full text-left p-2 rounded-lg transition-colors duration-200 ${D?"bg-orange-50 border border-orange-200":"hover:bg-gray-50"}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`p-1 rounded ${D?"text-orange-500":R!=null&&R.completed?"text-green-500":"text-gray-400"}`,children:R!=null&&R.completed?e.jsx(Z,{className:"h-5 w-5"}):Ss(d.type)}),e.jsxs("div",{children:[e.jsx("p",{className:`font-medium text-sm ${D?"text-orange-900":"text-gray-900"}`,children:d.title}),e.jsx("p",{className:"text-xs text-gray-600",children:d.duration})]})]}),(R==null?void 0:R.completed)&&e.jsx(Z,{className:"h-4 w-4 text-green-500"})]}),R&&R.progress_percentage>0&&R.progress_percentage<100&&e.jsx("div",{className:"mt-2 ml-8",children:e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-1",children:e.jsx("div",{className:"bg-orange-400 h-1 rounded-full",style:{width:`${R.progress_percentage}%`}})})})]},d.id)})})]},r.id))})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Module Resources"}),e.jsxs("div",{className:"space-y-3",children:[(C.resources||[]).map((r,m)=>e.jsxs("a",{href:r.downloadUrl,className:"flex items-center justify-between p-3 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors duration-200",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(vs,{className:"h-5 w-5 text-blue-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:r.title}),e.jsxs("p",{className:"text-sm text-gray-600",children:[r.type," â€¢ ",r.size]})]})]}),e.jsx(Ve,{className:"h-5 w-5 text-gray-400"})]},m)),(C.resources||[]).length===0&&e.jsx("p",{className:"text-gray-500 text-center py-4",children:"No additional resources for this module"})]})]}),e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-green-50 rounded-xl p-6",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-2",children:"Rate This Module"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Help us improve the learning experience"}),e.jsxs("div",{className:"flex items-center space-x-1 mb-4",children:[[1,2,3,4,5].map(r=>e.jsx("button",{onClick:()=>Y(r),className:`hover:text-yellow-500 ${q>=r?"text-yellow-400":"text-gray-300"}`,children:e.jsx(Ke,{className:"h-6 w-6 fill-current"})},r)),q>0&&e.jsxs("span",{className:"ml-2 text-sm text-gray-600",children:["Thanks for rating! (",q,"/5)"]})]}),e.jsx(ze,{to:"/lms/feedback",className:"text-sm text-blue-600 hover:text-blue-700 font-medium",children:"Leave detailed feedback â†’"})]})]})]})]})};export{jt as default};
