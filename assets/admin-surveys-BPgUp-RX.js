const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/AssignmentModal-V0C7Cq-T.js","assets/vendor-react-DvkU9ZSQ.js","assets/supabase-CqkleIqs.js","assets/vendor-Dox2Yl3q.js","assets/vendor-react-dom-Dki47u2n.js","assets/SurveySettingsModal-DwahSr7F.js"])))=>i.map(i=>d[i]);
var Be=Object.defineProperty,$e=Object.defineProperties;var Fe=Object.getOwnPropertyDescriptors;var me=Object.getOwnPropertySymbols;var We=Object.prototype.hasOwnProperty,Ue=Object.prototype.propertyIsEnumerable;var ge=(g,u,m)=>u in g?Be(g,u,{enumerable:!0,configurable:!0,writable:!0,value:m}):g[u]=m,o=(g,u)=>{for(var m in u||(u={}))We.call(u,m)&&ge(g,m,u[m]);if(me)for(var m of me(u))Ue.call(u,m)&&ge(g,m,u[m]);return g},l=(g,u)=>$e(g,Fe(u));var A=(g,u,m)=>new Promise((N,n)=>{var x=v=>{try{w(m.next(v))}catch(L){n(L)}},f=v=>{try{w(m.throw(v))}catch(L){n(L)}},w=v=>v.done?N(v.value):Promise.resolve(v.value).then(x,f);w((m=m.apply(g,u)).next())});import{r as C,d as He,aj as Ge,v as $,j as e,N as Ve,a3 as Ye,a as pe,a5 as Je,z as Ze,h as Ke,E as Xe,B as xe,e as qe,Z as et,m as tt,n as st,k as R,ai as he,i as ye,b as at,t as fe,U as nt,aw as rt,ax as ot}from"./vendor-react-DvkU9ZSQ.js";import{s as ve}from"./admin-secondary-DnwfLwy7.js";const it="modulepreload",lt=function(g){return"/"+g},be={},G=function(u,m,N){let n=Promise.resolve();if(m&&m.length>0){document.getElementsByTagName("link");const f=document.querySelector("meta[property=csp-nonce]"),w=(f==null?void 0:f.nonce)||(f==null?void 0:f.getAttribute("nonce"));n=Promise.allSettled(m.map(v=>{if(v=lt(v),v in be)return;be[v]=!0;const L=v.endsWith(".css"),_=L?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${v}"]${_}`))return;const I=document.createElement("link");if(I.rel=L?"stylesheet":it,L||(I.as="script"),I.crossOrigin="",I.href=v,w&&I.setAttribute("nonce",w),document.head.appendChild(I),L)return new Promise((F,W)=>{I.addEventListener("load",F),I.addEventListener("error",()=>W(new Error(`Unable to preload CSS for ${v}`)))})}))}function x(f){const w=new Event("vite:preloadError",{cancelable:!0});if(w.payload=f,window.dispatchEvent(w),!w.defaultPrevented)throw f}return n.then(f=>{for(const w of f||[])w.status==="rejected"&&x(w.reason);return u().catch(x)})},ct=[{id:"climate-assessment",name:"Organizational Climate Assessment",description:"Comprehensive assessment of workplace culture, inclusion, and belonging",category:"climate",tags:["culture","climate","belonging","comprehensive"],previewImage:"https://images.pexels.com/photos/3184465/pexels-photo-3184465.jpeg?auto=compress&cs=tinysrgb&w=400",sections:[{title:"Demographics",description:"Help us understand your background (all responses are confidential)",order:1,questions:[{id:"demo-department",type:"demographics",title:"Which department do you work in?",required:!1,order:1,options:["Human Resources","Engineering","Marketing","Sales","Operations","Finance","Other"]},{id:"demo-tenure",type:"demographics",title:"How long have you been with the organization?",required:!1,order:2,options:["Less than 1 year","1-2 years","3-5 years","6-10 years","More than 10 years"]},{id:"demo-level",type:"demographics",title:"What is your role level?",required:!1,order:3,options:["Individual Contributor","Team Lead","Manager","Director","VP/Executive","C-Suite"]}]},{title:"Belonging & Inclusion",description:"Your experience of belonging and inclusion in the workplace",order:2,questions:[{id:"belonging-1",type:"likert-scale",title:"I feel a strong sense of belonging at this organization",required:!0,order:1,scale:{min:1,max:5,minLabel:"Strongly Disagree",maxLabel:"Strongly Agree",midLabel:"Neutral"}},{id:"belonging-2",type:"likert-scale",title:"I can be my authentic self at work",required:!0,order:2,scale:{min:1,max:5,minLabel:"Strongly Disagree",maxLabel:"Strongly Agree",midLabel:"Neutral"}},{id:"belonging-3",type:"likert-scale",title:"My unique perspective is valued by my team",required:!0,order:3,scale:{min:1,max:5,minLabel:"Strongly Disagree",maxLabel:"Strongly Agree",midLabel:"Neutral"}},{id:"belonging-open",type:"open-ended",title:"What would make you feel a stronger sense of belonging at work?",description:"Please share specific examples or suggestions",required:!1,order:4,validation:{maxLength:500}}]},{title:"Psychological Safety",description:"Your comfort level speaking up and sharing ideas",order:3,questions:[{id:"safety-1",type:"likert-scale",title:"I feel safe speaking up about problems or concerns",required:!0,order:1,scale:{min:1,max:5,minLabel:"Strongly Disagree",maxLabel:"Strongly Agree",midLabel:"Neutral"}},{id:"safety-2",type:"likert-scale",title:"I can share ideas without fear of negative consequences",required:!0,order:2,scale:{min:1,max:5,minLabel:"Strongly Disagree",maxLabel:"Strongly Agree",midLabel:"Neutral"}},{id:"safety-barriers",type:"multiple-choice",title:"What barriers prevent you from speaking up? (Select all that apply)",required:!1,order:3,options:["Fear of retaliation","Concern about being judged","Past negative experiences","Lack of confidence my input matters","Cultural or language barriers","No barriers - I feel comfortable speaking up"],allowMultiple:!0}]}],defaultSettings:{allowAnonymous:!0,allowSaveAndContinue:!0,showProgressBar:!0,randomizeQuestions:!1,randomizeOptions:!1,requireCompletion:!1,accessControl:{requireLogin:!1},notifications:{sendReminders:!0,reminderSchedule:[3,7,14],completionNotification:!0}}},{id:"inclusion-index",name:"Inclusion Index Survey",description:"Measure inclusion across key dimensions with benchmarking capabilities",category:"inclusion",tags:["inclusion","index","benchmarking","metrics"],previewImage:"https://images.pexels.com/photos/3184291/pexels-photo-3184291.jpeg?auto=compress&cs=tinysrgb&w=400",sections:[{title:"Inclusion Dimensions",description:"Rate your experience across key inclusion factors",order:1,questions:[{id:"inclusion-matrix",type:"matrix",title:"Rate your agreement with the following statements",required:!0,order:1,matrixRows:["I am treated with respect by my colleagues","My manager values my input and ideas","I have equal access to opportunities","I feel comfortable expressing disagreement","My workload is fair compared to others"],matrixColumns:["Strongly Disagree","Disagree","Neutral","Agree","Strongly Agree"],matrixType:"single"},{id:"inclusion-ranking",type:"ranking",title:"Rank these factors by importance for feeling included (1 = most important)",required:!0,order:2,rankingItems:["Being heard in meetings","Having a mentor or sponsor","Flexible work arrangements","Recognition for contributions","Access to development opportunities","Diverse leadership representation"],maxRankings:6}]}],defaultSettings:{allowAnonymous:!0,allowSaveAndContinue:!0,showProgressBar:!0,randomizeQuestions:!1,randomizeOptions:!0,requireCompletion:!0,accessControl:{requireLogin:!1},notifications:{sendReminders:!0,reminderSchedule:[5,10],completionNotification:!0}}},{id:"equity-lens",name:"Equity Lens Evaluation",description:"Assess organizational practices through an equity lens",category:"equity",tags:["equity","fairness","practices","evaluation"],previewImage:"https://images.pexels.com/photos/3184338/pexels-photo-3184338.jpeg?auto=compress&cs=tinysrgb&w=400",sections:[{title:"Equity in Practices",description:"Evaluate fairness in organizational systems and processes",order:1,questions:[{id:"equity-hiring",type:"likert-scale",title:"Our hiring process is fair and unbiased",required:!0,order:1,scale:{min:1,max:7,minLabel:"Strongly Disagree",maxLabel:"Strongly Agree",midLabel:"Neutral"}},{id:"equity-promotion",type:"likert-scale",title:"Promotion decisions are based on merit and are transparent",required:!0,order:2,scale:{min:1,max:7,minLabel:"Strongly Disagree",maxLabel:"Strongly Agree",midLabel:"Neutral"}},{id:"equity-barriers",type:"open-ended",title:"What systemic barriers do you observe that prevent equitable outcomes?",description:"Think about policies, processes, or practices that may unintentionally disadvantage certain groups",required:!1,order:3,validation:{maxLength:750}}]}],defaultSettings:{allowAnonymous:!0,allowSaveAndContinue:!0,showProgressBar:!0,randomizeQuestions:!1,randomizeOptions:!1,requireCompletion:!1,accessControl:{requireLogin:!1},notifications:{sendReminders:!0,reminderSchedule:[7,14,21],completionNotification:!0}}}],dt=[{id:"multiple-choice",name:"Multiple Choice",description:"Single or multiple selection from predefined options",icon:"CheckCircle",category:"Selection"},{id:"likert-scale",name:"Likert Scale",description:"Rating scale for measuring agreement or satisfaction",icon:"BarChart3",category:"Rating"},{id:"ranking",name:"Ranking",description:"Rank items in order of preference or importance",icon:"ArrowUpDown",category:"Ordering"},{id:"open-ended",name:"Open-Ended",description:"Free text response for detailed feedback",icon:"MessageSquare",category:"Text"},{id:"matrix",name:"Matrix/Grid",description:"Multiple questions with the same response options",icon:"Grid3X3",category:"Complex"},{id:"demographics",name:"Demographics",description:"Collect demographic information for analysis",icon:"Users",category:"Data"}],ut=[{type:"likert-scale",title:"I feel comfortable expressing my authentic self at work",description:"This question measures psychological safety and authenticity in the workplace",scale:{min:1,max:5,minLabel:"Strongly Disagree",maxLabel:"Strongly Agree",midLabel:"Neutral"},category:"Belonging & Authenticity"},{type:"multiple-choice",title:"Which of the following best describes your experience with career advancement opportunities?",description:"Assesses equity in career development and advancement",options:["I have clear pathways and support for advancement","Opportunities exist but are not clearly communicated","I face barriers that others do not seem to experience","I am unsure about advancement opportunities","I do not see advancement as relevant to my role"],allowMultiple:!1,allowOther:!0,category:"Equity & Advancement"},{type:"ranking",title:"Rank these factors by their importance for creating an inclusive workplace (1 = most important)",description:"Identifies organizational priorities for inclusion initiatives",rankingItems:["Leadership commitment and modeling","Clear policies against discrimination","Employee resource groups and networks","Inclusive hiring and promotion practices","Regular training and education","Open dialogue and feedback mechanisms"],maxRankings:6,category:"Inclusion Priorities"},{type:"matrix",title:"Rate your experience with the following aspects of our organization",description:"Comprehensive assessment across multiple inclusion dimensions",matrixRows:["Feeling valued for my contributions","Having my voice heard in decisions","Receiving fair treatment from supervisors","Access to development opportunities","Feeling safe to share concerns"],matrixColumns:["Poor","Fair","Good","Very Good","Excellent"],matrixType:"single",category:"Multi-Dimensional Assessment"},{type:"open-ended",title:"Describe a time when you felt most included and valued at work. What made that experience meaningful?",description:"Captures positive inclusion experiences to identify best practices",validation:{minLength:50,maxLength:500},category:"Positive Experiences"},{type:"demographics",title:"Which of the following best describes your racial/ethnic identity?",description:"Census-aligned demographic data for intersectional analysis",options:["American Indian or Alaska Native","Asian","Black or African American","Hispanic or Latino","Native Hawaiian or Other Pacific Islander","White","Two or more races","Prefer not to answer"],allowMultiple:!0,allowOther:!0,category:"Demographics"},{type:"demographics",title:"What is your gender identity?",description:"Inclusive gender identity options for comprehensive analysis",options:["Woman","Man","Non-binary","Transgender woman","Transgender man","Genderfluid","Agender","Prefer to self-describe","Prefer not to answer"],allowMultiple:!1,allowOther:!0,category:"Demographics"},{type:"multiple-choice",title:"Do you identify as a person with a disability?",description:"Disability status for accessibility and accommodation analysis",options:["Yes, I have a visible disability","Yes, I have a non-visible disability","No, I do not have a disability","Prefer not to answer"],allowMultiple:!1,allowOther:!1,category:"Demographics"},{type:"likert-scale",title:"My manager actively supports diversity and inclusion in our team",description:"Measures leadership commitment to DEI at the direct supervisor level",scale:{min:1,max:7,minLabel:"Strongly Disagree",maxLabel:"Strongly Agree",midLabel:"Neutral"},category:"Leadership & Management"},{type:"multiple-choice",title:"In the past year, have you experienced or witnessed any of the following? (Select all that apply)",description:"Identifies specific incidents and patterns of exclusion or bias",options:["Microaggressions or subtle bias","Exclusion from informal networks or conversations","Unequal access to opportunities or resources","Discrimination based on identity","Retaliation for speaking up about concerns","None of the above","Prefer not to answer"],allowMultiple:!0,allowOther:!0,category:"Experiences & Incidents"}],we={race:["American Indian or Alaska Native","Asian","Black or African American","Hispanic or Latino","Native Hawaiian or Other Pacific Islander","White","Two or more races","Prefer not to answer"],gender:["Woman","Man","Non-binary","Transgender woman","Transgender man","Genderfluid","Agender","Prefer to self-describe","Prefer not to answer"],age:["Under 18","18-24","25-34","35-44","45-54","55-64","65 or older","Prefer not to answer"],education:["Less than high school","High school diploma or equivalent","Some college, no degree","Associate degree","Bachelor's degree","Master's degree","Professional degree","Doctoral degree","Prefer not to answer"],disability:["Yes, I have a visible disability","Yes, I have a non-visible disability","No, I do not have a disability","Prefer not to answer"],veteranStatus:["Veteran","Active military","Military spouse/family","Not applicable","Prefer not to answer"],sexualOrientation:["Heterosexual/Straight","Gay","Lesbian","Bisexual","Pansexual","Asexual","Queer","Prefer to self-describe","Prefer not to answer"]},H={primaryColor:"#FF8895",secondaryColor:"#D72638",accentColor:"#3A7DFF",fontFamily:{heading:"Montserrat",body:"Lato",highlight:"Quicksand"}},je=g=>A(void 0,null,function*(){try{const{data:u,error:m}=yield ve.from("survey_assignments").select("*").eq("survey_id",g).limit(1).single();return m?(console.warn("getAssignments supabase error:",m.message||m),null):u}catch(u){return console.warn("getAssignments exception:",u),null}}),Ne=(g,u)=>A(void 0,null,function*(){try{const m={survey_id:g,organization_ids:u,updated_at:new Date().toISOString()},{data:N,error:n}=yield ve.from("survey_assignments").upsert(m).select();return n?(console.warn("saveAssignments supabase error:",n.message||n),null):N}catch(m){return console.warn("saveAssignments exception:",m),null}}),mt=g=>A(void 0,null,function*(){return{surveyId:g,title:"Mock Survey Analytics",totalResponses:180,completionRate:78,avgCompletionTime:13,questionSummaries:[{questionId:"belonging-1",avgScore:3.8},{questionId:"safety-1",avgScore:3.6}],insights:["Belonging scores above average in Engineering","New hires report lower psychological safety"]}}),Se=g=>A(void 0,null,function*(){try{const u="local_surveys",m=localStorage.getItem(u),N=m?JSON.parse(m):[],n=N.findIndex(x=>x.id===g.id);return n>=0?N[n]=g:N.push(g),localStorage.setItem(u,JSON.stringify(N)),g}catch(u){return console.warn("saveSurvey error:",u),null}}),D=[];let z=null;const gt=3e3,pt=()=>{z||(z=window.setTimeout(()=>A(void 0,null,function*(){z=null,yield ke()}),gt))},ke=()=>A(void 0,null,function*(){if(D.length===0)return;const g=D.splice(0,D.length);try{const u="local_surveys",m=localStorage.getItem(u),N=m?JSON.parse(m):[];g.forEach(n=>{const x=N.findIndex(f=>f.id===n.id);x>=0?N[x]=n:N.push(n)}),localStorage.setItem(u,JSON.stringify(N))}catch(u){console.warn("flushQueue local merge failed",u)}{console.warn("Supabase not configured - flushQueue saved to localStorage only");return}}),Ce=g=>A(void 0,null,function*(){try{yield Se(g);const u=D.findIndex(m=>m.id===g.id);return u>=0?D[u]=g:D.push(g),pt(),g}catch(u){return console.warn("queueSaveSurvey error:",u),null}});let xt=null;const ht=new EventTarget,yt=()=>[...D],ft=()=>D.length,bt=()=>xt,wt=()=>A(void 0,null,function*(){z&&(window.clearTimeout(z),z=null),yield ke()}),Ae=g=>A(void 0,null,function*(){try{const m=localStorage.getItem("local_surveys");return(m?JSON.parse(m):[]).find(n=>n.id===g)||null}catch(u){return console.warn("getSurveyById error:",u),null}}),vt=Object.freeze(Object.defineProperty({__proto__:null,flushNow:wt,getAnalytics:mt,getAssignments:je,getLastFlushTime:bt,getQueueLength:ft,getQueueSnapshot:yt,getSurveyById:Ae,queueSaveSurvey:Ce,saveAssignments:Ne,saveSurvey:Se,surveyQueueEvents:ht},Symbol.toStringTag,{value:"Module"})),jt=C.lazy(()=>G(()=>import("./AssignmentModal-V0C7Cq-T.js"),__vite__mapDeps([0,1,2,3,4]))),Nt=C.lazy(()=>G(()=>import("./SurveySettingsModal-DwahSr7F.js"),__vite__mapDeps([5,1,2,3,4]))),St=()=>{var re,oe;const{surveyId:g}=He(),[u]=Ge(),m=u.get("template"),N=u.get("ai")==="1",[n,x]=C.useState(null),[f,w]=C.useState(""),[v,L]=C.useState(null),[_,I]=C.useState(!1),[F,W]=C.useState(!1),[V,Y]=C.useState(!1),[U,J]=C.useState(!1),[Z,Le]=C.useState(""),T=$.useRef(null),K=$.useRef(!0),[X,q]=C.useState(0),[ee,te]=C.useState(null),Ie=[{id:"1",name:"Pacific Coast University",type:"University",learners:45},{id:"2",name:"Mountain View High School",type:"K-12 Education",learners:23},{id:"3",name:"Community Impact Network",type:"Nonprofit",learners:28},{id:"4",name:"Regional Fire Department",type:"Government",learners:67},{id:"5",name:"TechForward Solutions",type:"Corporate",learners:34},{id:"6",name:"Regional Medical Center",type:"Healthcare",learners:89},{id:"7",name:"Unity Community Church",type:"Religious",learners:15}];C.useEffect(()=>{g&&g!=="new"?Oe(g):m?Re(m):se()},[g,m]);const Oe=t=>{A(void 0,null,function*(){const i=yield Ae(t);if(i){x(i),i.sections.length>0&&w(i.sections[0].id);return}});const s={id:t,title:"Q1 2025 Climate Assessment",description:"Quarterly organizational climate and culture assessment",status:"draft",createdBy:"Mya Dennis",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),sections:[],branding:H,settings:{anonymityMode:"anonymous",anonymityThreshold:5,allowMultipleResponses:!1,showProgressBar:!0,consentRequired:!1,allowAnonymous:!0,allowSaveAndContinue:!0,randomizeQuestions:!1,randomizeOptions:!1},assignedTo:{organizationIds:[],userIds:[],cohortIds:[]},blocks:[],defaultLanguage:"en",supportedLanguages:["en"],completionSettings:{thankYouMessage:"Thank you for completing our survey!",showResources:!0,recommendedCourses:[]},reflectionPrompts:["What's one change that would make you feel a stronger sense of belonging?","How can leadership better support inclusion in your daily work?","What would you like to see more of in our organization's culture?"]};x(s),s.sections.length>0&&w(s.sections[0].id),A(void 0,null,function*(){const i=yield je(t);i&&i.organization_ids&&x(c=>{var y,b,S;return c&&l(o({},c),{assignedTo:{organizationIds:i.organization_ids,userIds:((y=c.assignedTo)==null?void 0:y.userIds)||[],departmentIds:((b=c.assignedTo)==null?void 0:b.departmentIds)||[],cohortIds:((S=c.assignedTo)==null?void 0:S.cohortIds)||[]}})})})},Re=t=>{var c,y;const s=ct.find(b=>b.id===t);if(!s){se();return}const i={id:`survey-${Date.now()}`,title:s.name,description:s.description,status:"draft",createdBy:"Mya Dennis",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),sections:s.sections.map((b,S)=>l(o({},b),{id:`section-${Date.now()}-${S}`,questions:b.questions.map((P,M)=>l(o({},P),{id:`question-${Date.now()}-${S}-${M}`}))})),branding:H,settings:l(o({},s.defaultSettings),{accessControl:o({requireLogin:!1},(c=s.defaultSettings)==null?void 0:c.accessControl),notifications:o({sendReminders:!0,reminderSchedule:[3,7,14],completionNotification:!0},(y=s.defaultSettings)==null?void 0:y.notifications)}),assignedTo:{organizationIds:[],userIds:[],cohortIds:[]},reflectionPrompts:["What's one change that would make you feel a stronger sense of belonging?","How can leadership better support inclusion in your daily work?","What would you like to see more of in our organization's culture?"],blocks:[],defaultLanguage:"en",supportedLanguages:["en"],completionSettings:{thankYouMessage:"Thank you for completing our survey!",showResources:!0,recommendedCourses:[]}};x(i),i.sections.length>0&&w(i.sections[0].id)},se=()=>{const t={id:`survey-${Date.now()}`,title:"New Survey",description:"Survey description",status:"draft",createdBy:"Mya Dennis",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),sections:[],blocks:[],branding:H,settings:{anonymityMode:"anonymous",anonymityThreshold:5,allowMultipleResponses:!1,showProgressBar:!0,consentRequired:!1,allowAnonymous:!0,allowSaveAndContinue:!0,randomizeQuestions:!1,randomizeOptions:!1},defaultLanguage:"en",supportedLanguages:["en"],completionSettings:{thankYouMessage:"Thank you for completing our survey!",showResources:!0,recommendedCourses:[]},assignedTo:{organizationIds:[],userIds:[],cohortIds:[]},reflectionPrompts:["What's one change that would make you feel a stronger sense of belonging?"]};x(t)},ae=()=>{if(!n)return;const t={id:`section-${Date.now()}`,title:"New Section",description:"",order:n.sections.length+1,questions:[]};x(s=>s?l(o({},s),{sections:[...s.sections,t],updatedAt:new Date().toISOString()}):null),w(t.id)},De=(t,s)=>{if(!n)return;const i=n.sections.find(y=>y.id===t);if(!i)return;const c=o(o(o(o(o({id:`question-${Date.now()}`,type:s,title:"New Question",required:!1,order:i.questions.length+1},s==="multiple-choice"&&{options:["Option 1","Option 2","Option 3"],allowMultiple:!1,allowOther:!1}),s==="likert-scale"&&{scale:{min:1,max:5,minLabel:"Strongly Disagree",maxLabel:"Strongly Agree",midLabel:"Neutral"}}),s==="ranking"&&{rankingItems:["Item 1","Item 2","Item 3"],maxRankings:3}),s==="matrix"&&{matrixRows:["Row 1","Row 2","Row 3"],matrixColumns:["Column 1","Column 2","Column 3"],matrixType:"single"}),s==="demographics"&&{options:["Option 1","Option 2","Option 3"]});x(y=>y?l(o({},y),{sections:y.sections.map(b=>b.id===t?l(o({},b),{questions:[...b.questions,c]}):b),updatedAt:new Date().toISOString()}):null)},Pe=(t,s)=>{L(s),t.dataTransfer.effectAllowed="move"},Me=t=>{t.preventDefault(),t.dataTransfer.dropEffect="move"},Te=(t,s,i)=>{t.preventDefault(),!(!n||!v)&&(x(c=>{if(!c)return c;const y=c.sections.map(b=>{if(b.id!==s)return b;const S=[...b.questions],P=S.findIndex(O=>O.id===v);if(P===-1)return b;const[M]=S.splice(P,1);if(!i)S.push(M);else{const O=S.findIndex(E=>E.id===i);S.splice(O===-1?S.length:O,0,M)}const B=S.map((O,E)=>l(o({},O),{order:E+1}));return l(o({},b),{questions:B})});return l(o({},c),{sections:y,updatedAt:new Date().toISOString()})}),L(null))},p=(t,s,i)=>{n&&x(c=>c?l(o({},c),{sections:c.sections.map(y=>y.id===t?l(o({},y),{questions:y.questions.map(b=>b.id===s?o(o({},b),i):b)}):y),updatedAt:new Date().toISOString()}):null)},Ee=(t,s)=>{n&&x(i=>i?l(o({},i),{sections:i.sections.map(c=>c.id===t?l(o({},c),{questions:c.questions.filter(y=>y.id!==s)}):c),updatedAt:new Date().toISOString()}):null)},ze=()=>{if(!n||!f)return;const t=ut.slice(0,3).map((s,i)=>l(o({},s),{id:`ai-question-${Date.now()}-${i}`,required:!0,order:n.sections.find(c=>c.id===f).questions.length+i+1}));x(s=>s?l(o({},s),{sections:s.sections.map(i=>i.id===f?l(o({},i),{questions:[...i.questions,...t]}):i),updatedAt:new Date().toISOString()}):null)},Q=()=>A(void 0,null,function*(){var t;if(n){J(!0);try{if((t=n.assignedTo)!=null&&t.organizationIds&&n.assignedTo.organizationIds.length>0)try{yield Ne(n.id,n.assignedTo.organizationIds)}catch(s){console.warn("Failed to save assignments during survey save",s)}try{yield Ce(n)}catch(s){console.warn("Local save failed",s)}Le(new Date().toLocaleTimeString())}finally{J(!1)}}});C.useEffect(()=>{if(K.current){K.current=!1;return}if(n)return T.current&&window.clearTimeout(T.current),T.current=window.setTimeout(()=>{U||Q()},1500),()=>{T.current&&(window.clearTimeout(T.current),T.current=null)}},[n]),C.useEffect(()=>{G(()=>Promise.resolve().then(()=>vt),void 0).then(t=>{q(t.getQueueLength()),te(t.getLastFlushTime());const s=()=>{q(t.getQueueLength()),te(t.getLastFlushTime())};return t.surveyQueueEvents.addEventListener("queuechange",s),t.surveyQueueEvents.addEventListener("flush",s),()=>{t.surveyQueueEvents.removeEventListener("queuechange",s),t.surveyQueueEvents.removeEventListener("flush",s)}})},[]);const ne=t=>{switch(t){case"multiple-choice":return e.jsx(fe,{className:"h-5 w-5"});case"likert-scale":return e.jsx(xe,{className:"h-5 w-5"});case"ranking":return e.jsx(ot,{className:"h-5 w-5"});case"open-ended":return e.jsx(he,{className:"h-5 w-5"});case"matrix":return e.jsx(rt,{className:"h-5 w-5"});case"demographics":return e.jsx(nt,{className:"h-5 w-5"});default:return e.jsx(fe,{className:"h-5 w-5"})}},_e=(t,s)=>{var i,c,y,b,S,P,M,B,O,E,ie,le,ce,de,ue;return e.jsxs("div",{draggable:!0,onDragStart:a=>Pe(a,t.id),onDragOver:Me,onDrop:a=>Te(a,s,t.id),className:"bg-white border border-gray-200 rounded-lg p-6 mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"bg-gray-100 p-2 rounded-lg",children:ne(t.type)}),e.jsxs("div",{children:[e.jsx("input",{type:"text",value:t.title,onChange:a=>p(s,t.id,{title:a.target.value}),className:"font-medium text-gray-900 bg-transparent border-none outline-none focus:ring-2 focus:ring-orange-500 rounded px-2 py-1",placeholder:"Question title"}),e.jsx("div",{className:"text-sm text-gray-500 capitalize",children:t.type.replace("-"," ")})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:t.required,onChange:a=>p(s,t.id,{required:a.target.checked}),className:"h-4 w-4 text-orange-500 focus:ring-orange-500 border-gray-300 rounded"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Required"})]}),e.jsx("button",{onClick:()=>Ee(s,t.id),className:"p-2 text-red-600 hover:text-red-800 hover:bg-red-50 rounded-lg",children:e.jsx(R,{className:"h-4 w-4"})})]})]}),e.jsx("div",{className:"mb-4",children:e.jsx("textarea",{value:t.description||"",onChange:a=>p(s,t.id,{description:a.target.value}),placeholder:"Question description (optional)",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent text-sm",rows:2})}),t.type==="multiple-choice"&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-4 mb-3",children:[e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:t.allowMultiple||!1,onChange:a=>p(s,t.id,{allowMultiple:a.target.checked}),className:"h-4 w-4 text-orange-500 focus:ring-orange-500 border-gray-300 rounded"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Allow multiple selections"})]}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:t.allowOther||!1,onChange:a=>p(s,t.id,{allowOther:a.target.checked}),className:"h-4 w-4 text-orange-500 focus:ring-orange-500 border-gray-300 rounded"}),e.jsx("span",{className:"text-sm text-gray-600",children:'Allow "Other" option'})]})]}),(i=t.options)==null?void 0:i.map((a,r)=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"text",value:a,onChange:h=>{const d=[...t.options||[]];d[r]=h.target.value,p(s,t.id,{options:d})},className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent text-sm",placeholder:`Option ${r+1}`}),e.jsx("button",{onClick:()=>{var d;const h=(d=t.options)==null?void 0:d.filter((k,j)=>j!==r);p(s,t.id,{options:h})},className:"p-2 text-red-600 hover:text-red-800",children:e.jsx(R,{className:"h-4 w-4"})})]},r)),e.jsx("button",{onClick:()=>{var r;const a=[...t.options||[],`Option ${(((r=t.options)==null?void 0:r.length)||0)+1}`];p(s,t.id,{options:a})},className:"text-orange-500 hover:text-orange-600 text-sm font-medium",children:"+ Add Option"})]}),t.type==="likert-scale"&&e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Scale Range"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"number",value:((c=t.scale)==null?void 0:c.min)||1,onChange:a=>p(s,t.id,{scale:l(o({},t.scale),{min:parseInt(a.target.value)})}),className:"w-16 px-2 py-1 border border-gray-300 rounded text-sm",min:"1"}),e.jsx("span",{className:"text-gray-500",children:"to"}),e.jsx("input",{type:"number",value:((y=t.scale)==null?void 0:y.max)||5,onChange:a=>p(s,t.id,{scale:l(o({},t.scale),{max:parseInt(a.target.value)})}),className:"w-16 px-2 py-1 border border-gray-300 rounded text-sm",min:"2",max:"10"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Min Label"}),e.jsx("input",{type:"text",value:((b=t.scale)==null?void 0:b.minLabel)||"",onChange:a=>p(s,t.id,{scale:l(o({},t.scale),{minLabel:a.target.value})}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent text-sm",placeholder:"e.g., Strongly Disagree"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Max Label"}),e.jsx("input",{type:"text",value:((S=t.scale)==null?void 0:S.maxLabel)||"",onChange:a=>p(s,t.id,{scale:l(o({},t.scale),{maxLabel:a.target.value})}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent text-sm",placeholder:"e.g., Strongly Agree"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mid Label (Optional)"}),e.jsx("input",{type:"text",value:((P=t.scale)==null?void 0:P.midLabel)||"",onChange:a=>p(s,t.id,{scale:l(o({},t.scale),{midLabel:a.target.value})}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent text-sm",placeholder:"e.g., Neutral"})]})]})}),t.type==="ranking"&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Maximum Rankings"}),e.jsx("input",{type:"number",value:t.maxRankings||((M=t.rankingItems)==null?void 0:M.length)||3,onChange:a=>p(s,t.id,{maxRankings:parseInt(a.target.value)}),className:"w-24 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent text-sm",min:"1",max:((B=t.rankingItems)==null?void 0:B.length)||10})]}),(O=t.rankingItems)==null?void 0:O.map((a,r)=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:"text-sm text-gray-500 w-6",children:[r+1,"."]}),e.jsx("input",{type:"text",value:a,onChange:h=>{const d=[...t.rankingItems||[]];d[r]=h.target.value,p(s,t.id,{rankingItems:d})},className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent text-sm",placeholder:`Ranking item ${r+1}`}),e.jsx("button",{onClick:()=>{var d;const h=(d=t.rankingItems)==null?void 0:d.filter((k,j)=>j!==r);p(s,t.id,{rankingItems:h})},className:"p-2 text-red-600 hover:text-red-800",children:e.jsx(R,{className:"h-4 w-4"})})]},r)),e.jsx("button",{onClick:()=>{var r;const a=[...t.rankingItems||[],`Item ${(((r=t.rankingItems)==null?void 0:r.length)||0)+1}`];p(s,t.id,{rankingItems:a})},className:"text-orange-500 hover:text-orange-600 text-sm font-medium",children:"+ Add Ranking Item"})]}),t.type==="open-ended"&&e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Min Length"}),e.jsx("input",{type:"number",value:((E=t.validation)==null?void 0:E.minLength)||"",onChange:a=>p(s,t.id,{validation:l(o({},t.validation),{minLength:parseInt(a.target.value)||void 0})}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent text-sm",placeholder:"Minimum characters"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Max Length"}),e.jsx("input",{type:"number",value:((ie=t.validation)==null?void 0:ie.maxLength)||"",onChange:a=>p(s,t.id,{validation:l(o({},t.validation),{maxLength:parseInt(a.target.value)||void 0})}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent text-sm",placeholder:"Maximum characters"})]})]})}),t.type==="matrix"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Matrix Rows"}),e.jsxs("div",{className:"space-y-2",children:[(le=t.matrixRows)==null?void 0:le.map((a,r)=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"text",value:a,onChange:h=>{const d=[...t.matrixRows||[]];d[r]=h.target.value,p(s,t.id,{matrixRows:d})},className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent text-sm",placeholder:`Row ${r+1}`}),e.jsx("button",{onClick:()=>{var d;const h=(d=t.matrixRows)==null?void 0:d.filter((k,j)=>j!==r);p(s,t.id,{matrixRows:h})},className:"p-2 text-red-600 hover:text-red-800",children:e.jsx(R,{className:"h-4 w-4"})})]},r)),e.jsx("button",{onClick:()=>{var r;const a=[...t.matrixRows||[],`Row ${(((r=t.matrixRows)==null?void 0:r.length)||0)+1}`];p(s,t.id,{matrixRows:a})},className:"text-orange-500 hover:text-orange-600 text-sm font-medium",children:"+ Add Row"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Matrix Columns"}),e.jsxs("div",{className:"space-y-2",children:[(ce=t.matrixColumns)==null?void 0:ce.map((a,r)=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"text",value:a,onChange:h=>{const d=[...t.matrixColumns||[]];d[r]=h.target.value,p(s,t.id,{matrixColumns:d})},className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent text-sm",placeholder:`Column ${r+1}`}),e.jsx("button",{onClick:()=>{var d;const h=(d=t.matrixColumns)==null?void 0:d.filter((k,j)=>j!==r);p(s,t.id,{matrixColumns:h})},className:"p-2 text-red-600 hover:text-red-800",children:e.jsx(R,{className:"h-4 w-4"})})]},r)),e.jsx("button",{onClick:()=>{var r;const a=[...t.matrixColumns||[],`Column ${(((r=t.matrixColumns)==null?void 0:r.length)||0)+1}`];p(s,t.id,{matrixColumns:a})},className:"text-orange-500 hover:text-orange-600 text-sm font-medium",children:"+ Add Column"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Response Type"}),e.jsxs("select",{value:t.matrixType||"single",onChange:a=>p(s,t.id,{matrixType:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent text-sm",children:[e.jsx("option",{value:"single",children:"Single selection per row"}),e.jsx("option",{value:"multiple",children:"Multiple selections per row"}),e.jsx("option",{value:"rating",children:"Rating scale per row"})]})]})]}),t.type==="demographics"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4",children:[e.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"Census-Aligned Demographics"}),e.jsx("p",{className:"text-sm text-blue-800",children:"Use standardized demographic categories for consistent analysis and benchmarking."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Demographic Category"}),e.jsxs("select",{onChange:a=>{const r=a.target.value;r&&we[r]&&p(s,t.id,{options:we[r],title:`What is your ${r}?`})},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent text-sm",children:[e.jsx("option",{value:"",children:"Select a category"}),e.jsx("option",{value:"race",children:"Race/Ethnicity"}),e.jsx("option",{value:"gender",children:"Gender Identity"}),e.jsx("option",{value:"age",children:"Age Range"}),e.jsx("option",{value:"education",children:"Education Level"}),e.jsx("option",{value:"disability",children:"Disability Status"}),e.jsx("option",{value:"veteranStatus",children:"Veteran Status"}),e.jsx("option",{value:"sexualOrientation",children:"Sexual Orientation"})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:t.allowMultiple||!1,onChange:a=>p(s,t.id,{allowMultiple:a.target.checked}),className:"h-4 w-4 text-orange-500 focus:ring-orange-500 border-gray-300 rounded"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Allow multiple selections"})]}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:t.allowOther||!1,onChange:a=>p(s,t.id,{allowOther:a.target.checked}),className:"h-4 w-4 text-orange-500 focus:ring-orange-500 border-gray-300 rounded"}),e.jsx("span",{className:"text-sm text-gray-700",children:'Allow "Other" option'})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Custom Options"}),(de=t.options)==null?void 0:de.map((a,r)=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"text",value:a,onChange:h=>{const d=[...t.options||[]];d[r]=h.target.value,p(s,t.id,{options:d})},className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent text-sm",placeholder:`Option ${r+1}`}),e.jsx("button",{onClick:()=>{var d;const h=(d=t.options)==null?void 0:d.filter((k,j)=>j!==r);p(s,t.id,{options:h})},className:"p-2 text-red-600 hover:text-red-800",children:e.jsx(R,{className:"h-4 w-4"})})]},r)),e.jsx("button",{onClick:()=>{var r;const a=[...t.options||[],`Option ${(((r=t.options)==null?void 0:r.length)||0)+1}`];p(s,t.id,{options:a})},className:"text-orange-500 hover:text-orange-600 text-sm font-medium",children:"+ Add Custom Option"})]})]}),e.jsxs("div",{className:"mt-4 border-t pt-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"Conditional Logic (optional)"}),e.jsx("p",{className:"text-xs text-gray-500 mb-2",children:"Show this question only when previous answers match the rule."}),e.jsxs("div",{className:"space-y-2",children:[(((ue=t.conditionalLogic)==null?void 0:ue.showIf)||[]).map((a,r)=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{className:"w-48 px-2 py-1 border rounded",value:a.questionId,onChange:h=>{var k,j;const d=[...((k=t.conditionalLogic)==null?void 0:k.showIf)||[]];d[r]=l(o({},d[r]),{questionId:h.target.value}),p(s,t.id,{conditionalLogic:l(o({},t.conditionalLogic||{}),{showIf:d,logic:((j=t.conditionalLogic)==null?void 0:j.logic)||"and"})})},placeholder:"Question ID"}),e.jsxs("select",{className:"px-2 py-1 border rounded",value:a.operator,onChange:h=>{var k,j;const d=[...((k=t.conditionalLogic)==null?void 0:k.showIf)||[]];d[r]=l(o({},d[r]),{operator:h.target.value}),p(s,t.id,{conditionalLogic:l(o({},t.conditionalLogic||{}),{showIf:d,logic:((j=t.conditionalLogic)==null?void 0:j.logic)||"and"})})},children:[e.jsx("option",{value:"equals",children:"equals"}),e.jsx("option",{value:"not-equals",children:"not-equals"}),e.jsx("option",{value:"contains",children:"contains"})]}),e.jsx("input",{className:"px-2 py-1 border rounded",value:String(a.value||""),onChange:h=>{var k,j;const d=[...((k=t.conditionalLogic)==null?void 0:k.showIf)||[]];d[r]=l(o({},d[r]),{value:h.target.value}),p(s,t.id,{conditionalLogic:l(o({},t.conditionalLogic||{}),{showIf:d,logic:((j=t.conditionalLogic)==null?void 0:j.logic)||"and"})})},placeholder:"Value"}),e.jsx("button",{className:"px-2 py-1 text-red-600",onClick:()=>{var d,k;const h=(((d=t.conditionalLogic)==null?void 0:d.showIf)||[]).filter((j,Qe)=>Qe!==r);p(s,t.id,{conditionalLogic:l(o({},t.conditionalLogic||{}),{showIf:h,logic:((k=t.conditionalLogic)==null?void 0:k.logic)||"and"})})},children:"Remove"})]},r)),e.jsx("button",{className:"text-sm text-orange-500",onClick:()=>{var r,h;const a=[...((r=t.conditionalLogic)==null?void 0:r.showIf)||[],{questionId:"",operator:"equals",value:""}];p(s,t.id,{conditionalLogic:l(o({},t.conditionalLogic||{}),{showIf:a,logic:((h=t.conditionalLogic)==null?void 0:h.logic)||"and"})})},children:"+ Add condition"})]})]})]})};return n?e.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs(Ve,{to:"/admin/surveys",className:"inline-flex items-center text-orange-500 hover:text-orange-600 mb-4 font-medium",children:[e.jsx(Ye,{className:"h-4 w-4 mr-2"}),"Back to Surveys"]}),e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsx("input",{type:"text",value:n.title,onChange:t=>x(s=>s?l(o({},s),{title:t.target.value,updatedAt:new Date().toISOString()}):null),className:"text-3xl font-bold text-gray-900 bg-transparent border-none outline-none focus:ring-2 focus:ring-orange-500 rounded px-2 py-1",placeholder:"Survey Title"}),N&&e.jsxs("span",{className:"bg-purple-100 text-purple-700 px-2 py-1 rounded-full text-sm font-medium flex items-center space-x-1",children:[e.jsx(pe,{className:"h-4 w-4"}),e.jsx("span",{children:"AI Mode"})]})]}),e.jsx("textarea",{value:n.description,onChange:t=>x(s=>s?l(o({},s),{description:t.target.value,updatedAt:new Date().toISOString()}):null),className:"text-gray-600 bg-transparent border-none outline-none focus:ring-2 focus:ring-orange-500 rounded px-2 py-1 resize-none",placeholder:"Survey description",rows:2})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("button",{onClick:()=>W(!F),className:"border border-gray-300 px-4 py-2 rounded-lg hover:bg-gray-50 transition-colors duration-200 flex items-center space-x-2",children:[e.jsx(Je,{className:"h-4 w-4"}),e.jsx("span",{children:"Branding"})]}),e.jsxs("button",{onClick:()=>Y(!0),className:"border border-gray-300 px-4 py-2 rounded-lg hover:bg-gray-50 transition-colors duration-200 flex items-center space-x-2",children:[e.jsx(Ze,{className:"h-4 w-4"}),e.jsx("span",{children:"Assign Survey"})]}),e.jsxs("button",{onClick:()=>I(!_),className:"border border-gray-300 px-4 py-2 rounded-lg hover:bg-gray-50 transition-colors duration-200 flex items-center space-x-2",children:[e.jsx(Ke,{className:"h-4 w-4"}),e.jsx("span",{children:"Settings"})]}),e.jsxs("button",{onClick:()=>window.open(`/admin/surveys/${n.id}/preview`,"_blank"),className:"border border-gray-300 px-4 py-2 rounded-lg hover:bg-gray-50 transition-colors duration-200 flex items-center space-x-2",children:[e.jsx(Xe,{className:"h-4 w-4"}),e.jsx("span",{children:"Preview"})]}),e.jsxs("button",{onClick:()=>{try{const t="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(n,null,2)),s=document.createElement("a");s.setAttribute("href",t),s.setAttribute("download",`${n.title.replace(/\s+/g,"_").toLowerCase()||"survey"}.json`),document.body.appendChild(s),s.click(),s.remove()}catch(t){console.warn("Export failed",t)}},className:"border border-gray-300 px-4 py-2 rounded-lg hover:bg-gray-50 transition-colors duration-200 flex items-center space-x-2",children:[e.jsx(xe,{className:"h-4 w-4"}),e.jsx("span",{children:"Export"})]}),e.jsxs("button",{onClick:Q,disabled:U,className:"bg-orange-500 text-white px-6 py-2 rounded-lg hover:bg-orange-600 transition-colors duration-200 flex items-center space-x-2 disabled:opacity-50",children:[e.jsx(qe,{className:"h-4 w-4"}),e.jsx("span",{children:U?"Saving...":"Save"})]}),e.jsxs("div",{className:"text-xs text-gray-500 ml-2",children:[Z?`Last saved ${Z}`:"Not saved yet",e.jsx("div",{children:X>0?` • ${X} pending sync`:" • synced"}),ee&&e.jsxs("div",{className:"text-xs text-gray-400",children:["Last flush: ",new Date(ee).toLocaleTimeString()]})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-8",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Question Types"}),e.jsx("div",{className:"space-y-3",children:dt.map(t=>e.jsx("button",{onClick:()=>{f&&De(f,t.id)},disabled:!f,className:"w-full text-left p-3 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"bg-gray-100 p-2 rounded-lg",children:ne(t.id)}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900 text-sm",children:t.name}),e.jsx("div",{className:"text-xs text-gray-600",children:t.description})]})]})},t.id))}),e.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-200",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"AI Suggestions"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("button",{onClick:ze,disabled:!f,className:"w-full text-left p-2 bg-purple-50 border border-purple-200 rounded-lg hover:bg-purple-100 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(pe,{className:"h-4 w-4 text-purple-500"}),e.jsx("span",{className:"text-sm text-purple-800",children:"Generate DEI Questions"})]})}),e.jsx("button",{className:"w-full text-left p-2 bg-blue-50 border border-blue-200 rounded-lg hover:bg-blue-100 transition-colors duration-200",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(et,{className:"h-4 w-4 text-blue-500"}),e.jsx("span",{className:"text-sm text-blue-800",children:"Suggest Logic Flows"})]})})]})]})]}),e.jsxs("div",{className:"lg:col-span-3 space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[n.sections.map(t=>e.jsxs("div",{className:"bg-gray-50 rounded-xl p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("input",{type:"text",value:t.title,onChange:s=>x(i=>i?l(o({},i),{sections:i.sections.map(c=>c.id===t.id?l(o({},c),{title:s.target.value}):c),updatedAt:new Date().toISOString()}):null),className:"text-xl font-bold text-gray-900 bg-transparent border-none outline-none focus:ring-2 focus:ring-orange-500 rounded px-2 py-1",placeholder:"Section title"}),e.jsx("textarea",{value:t.description||"",onChange:s=>x(i=>i?l(o({},i),{sections:i.sections.map(c=>c.id===t.id?l(o({},c),{description:s.target.value}):c),updatedAt:new Date().toISOString()}):null),className:"text-gray-600 bg-transparent border-none outline-none focus:ring-2 focus:ring-orange-500 rounded px-2 py-1 resize-none w-full",placeholder:"Section description",rows:1})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>w(f===t.id?"":t.id),className:"p-2 text-gray-600 hover:text-gray-800",children:f===t.id?e.jsx(tt,{className:"h-5 w-5"}):e.jsx(st,{className:"h-5 w-5"})}),e.jsx("button",{className:"p-2 text-red-600 hover:text-red-800",children:e.jsx(R,{className:"h-4 w-4"})})]})]}),f===t.id&&e.jsxs("div",{className:"space-y-4",children:[t.questions.map(s=>_e(s,t.id)),t.questions.length===0&&e.jsxs("div",{className:"text-center py-8 border-2 border-dashed border-gray-300 rounded-lg",children:[e.jsx(he,{className:"h-8 w-8 text-gray-400 mx-auto mb-2"}),e.jsx("p",{className:"text-gray-500",children:"No questions yet. Select a question type from the left to get started."})]})]})]},t.id)),e.jsxs("button",{onClick:ae,className:"w-full border-2 border-dashed border-gray-300 rounded-xl p-6 text-center hover:border-orange-500 hover:bg-orange-50 transition-colors duration-200",children:[e.jsx(ye,{className:"h-6 w-6 text-gray-400 mx-auto mb-2"}),e.jsx("span",{className:"text-gray-600 font-medium",children:"Add Section"})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Reflection Prompts"}),e.jsx("p",{className:"text-gray-600 text-sm mb-4",children:"These prompts will appear after survey completion to encourage deeper thinking and self-reflection."}),e.jsxs("div",{className:"space-y-3",children:[(re=n.reflectionPrompts)==null?void 0:re.map((t,s)=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"text",value:t,onChange:i=>{const c=[...n.reflectionPrompts||[]];c[s]=i.target.value,x(y=>y?l(o({},y),{reflectionPrompts:c,updatedAt:new Date().toISOString()}):null)},className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent text-sm",placeholder:"Reflection prompt"}),e.jsx("button",{onClick:()=>{const i=(n.reflectionPrompts||[]).filter((c,y)=>y!==s);x(c=>c?l(o({},c),{reflectionPrompts:i,updatedAt:new Date().toISOString()}):null)},className:"p-2 text-red-600 hover:text-red-800",children:e.jsx(R,{className:"h-4 w-4"})})]},s)),e.jsx("button",{onClick:()=>{const t=[...n.reflectionPrompts||[],"New reflection prompt"];x(s=>s?l(o({},s),{reflectionPrompts:t,updatedAt:new Date().toISOString()}):null)},className:"text-orange-500 hover:text-orange-600 text-sm font-medium",children:"+ Add Reflection Prompt"})]})]})]})]}),_&&e.jsx($.Suspense,{fallback:e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center",children:e.jsxs("div",{className:"bg-white p-8 rounded-xl shadow-xl flex items-center space-x-3",children:[e.jsx("div",{className:"animate-spin h-6 w-6 border-2 border-gray-600 border-t-transparent rounded-full"}),e.jsx("span",{className:"text-gray-700 font-medium",children:"Loading Settings Panel..."})]})}),children:e.jsx(Nt,{isOpen:_,onClose:()=>I(!1),settings:{accessControl:{requireAuth:!n.settings.allowAnonymous,allowAnonymous:n.settings.allowAnonymous,ipRestriction:"",timeLimit:0},notifications:{sendReminders:!0,reminderFrequency:"weekly",completionNotifications:!0},advanced:{allowBack:n.settings.allowSaveAndContinue,showProgress:n.settings.showProgressBar,randomizeQuestions:n.settings.randomizeQuestions,preventMultipleSubmissions:!0}},onSave:t=>{x(s=>s?l(o({},s),{settings:l(o({},s.settings),{allowAnonymous:t.accessControl.allowAnonymous,allowSaveAndContinue:t.advanced.allowBack,showProgressBar:t.advanced.showProgress,randomizeQuestions:t.advanced.randomizeQuestions}),updatedAt:new Date().toISOString()}):null),Q()}})}),V&&e.jsx($.Suspense,{fallback:e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center",children:e.jsxs("div",{className:"bg-white p-8 rounded-xl shadow-xl flex items-center space-x-3",children:[e.jsx("div",{className:"animate-spin h-6 w-6 border-2 border-blue-600 border-t-transparent rounded-full"}),e.jsx("span",{className:"text-gray-700 font-medium",children:"Loading Assignment Modal..."})]})}),children:e.jsx(jt,{isOpen:V,onClose:()=>Y(!1),organizations:Ie,selectedOrganizations:((oe=n==null?void 0:n.assignedTo)==null?void 0:oe.organizationIds)||[],onSave:t=>A(void 0,null,function*(){n&&(x(s=>s?l(o({},s),{assignedTo:l(o({},s.assignedTo),{organizationIds:t}),updatedAt:new Date().toISOString()}):null),yield Q())})})}),n.sections.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(at,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Start Building Your Survey"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Add your first section to begin creating questions."}),e.jsxs("button",{onClick:ae,className:"bg-orange-500 text-white px-6 py-3 rounded-lg hover:bg-orange-600 transition-colors duration-200 flex items-center mx-auto space-x-2",children:[e.jsx(ye,{className:"h-5 w-5"}),e.jsx("span",{children:"Add First Section"})]})]})]}):e.jsxs("div",{className:"p-6 max-w-4xl mx-auto text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-orange-500 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Loading survey builder..."})]})},Lt=Object.freeze(Object.defineProperty({__proto__:null,default:St},Symbol.toStringTag,{value:"Module"}));export{Lt as A,G as _,mt as g};
