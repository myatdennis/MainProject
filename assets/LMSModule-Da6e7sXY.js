var Rs=Object.defineProperty,Ts=Object.defineProperties;var Is=Object.getOwnPropertyDescriptors;var fs=Object.getOwnPropertySymbols;var As=Object.prototype.hasOwnProperty,Ms=Object.prototype.propertyIsEnumerable;var ps=(a,x,g)=>x in a?Rs(a,x,{enumerable:!0,configurable:!0,writable:!0,value:g}):a[x]=g,ae=(a,x)=>{for(var g in x||(x={}))As.call(x,g)&&ps(a,g,x[g]);if(fs)for(var g of fs(x))Ms.call(x,g)&&ps(a,g,x[g]);return a},le=(a,x)=>Ts(a,Is(x));var ee=(a,x,g)=>new Promise((D,M)=>{var $=S=>{try{I(g.next(S))}catch(Q){M(Q)}},P=S=>{try{I(g.throw(S))}catch(Q){M(Q)}},I=S=>S.done?D(S.value):Promise.resolve(S.value).then($,P);I((g=g.apply(a,x)).next())});import{r as s,b2 as B,j as e,ab as bs,ak as Ps,b3 as Os,b4 as Fs,b5 as Us,b6 as Ds,b7 as zs,h as Qs,b8 as Vs,b9 as qs,ba as Ys,bb as Ae,c as Me,bc as Bs,ap as Ks,Z as ws,b as Ss,t as ne,a7 as Ge,g as Pe,f as Oe,aP as Be,aG as Ws,aH as Gs,G as Js,q as Hs,D as Ye,bd as Xs,R as Je,d as Zs,u as et,J as Ve,a2 as vs,ah as qe,e as st,ac as tt,P as rt,T as at,A as js,p as ys,V as nt,as as Ns}from"./vendor-react-GSJsE769.js";import{b as Se,s as Ee,c as We}from"./admin-secondary-BM_OfuCE.js";import"./supabase-CqkleIqs.js";import"./vendor-BQbvXGuC.js";import"./vendor-react-dom-CAPOXzwn.js";import"./admin-courses-8eYVdzC7.js";const ot=["course_assigned","course_updated","user_progress","user_enrolled","user_completed","notification_created","survey_response","analytics_updated"],lt=(a,x,g)=>({type:a,payload:x,timestamp:Date.now(),userId:g}),it=a=>{var x,g,D,M,$,P,I,S,Q,K,v,w,E,A;switch(a.type){case"course_assigned":{const c=((g=(x=a.payload)==null?void 0:x.assignment)==null?void 0:g.course_name)||((M=(D=a.payload)==null?void 0:D.course)==null?void 0:M.title)||"course";B.success(`New course assigned: ${c}`);break}case"course_updated":{const c=((P=($=a.payload)==null?void 0:$.course)==null?void 0:P.title)||((I=a.payload)==null?void 0:I.course_name)||"Course";B(`Course updated: ${c}`,{icon:"ℹ️"});break}case"user_enrolled":{const c=((Q=(S=a.payload)==null?void 0:S.enrollment)==null?void 0:Q.course_name)||"course";B.success(`Enrolled in ${c}`);break}case"user_completed":{const c=((K=a.payload)==null?void 0:K.courseId)||((w=(v=a.payload)==null?void 0:v.enrollment)==null?void 0:w.course_name)||"course";B.success(`Course completed: ${c}`);break}case"notification_created":{B(((A=(E=a.payload)==null?void 0:E.notification)==null?void 0:A.title)||"New notification received",{icon:"🔔"});break}case"survey_response":{B.success("New survey response received");break}}},ct=(a={})=>{const{userId:x,organizationId:g,events:D=ot,onEvent:M,onError:$,enabled:P=!0}=a,[I,S]=s.useState(P),[Q,K]=s.useState(Se.getSyncStatus().connection),v=s.useRef([]),w=s.useRef("");s.useEffect(()=>{S(P)},[P]),s.useEffect(()=>{if(!I){v.current.forEach(h=>h()),v.current=[],B.dismiss("realtime-status"),B.dismiss("realtime-reconnect");return}const z=JSON.stringify([...D].sort());z===w.current||(v.current.forEach(h=>h()),v.current=[],w.current=z),Se.configureContext({userId:x,organizationId:g});const y=h=>{const W=Se.subscribe(h,q=>{const Y=lt(h,q,x);try{M==null||M(Y),it(Y)}catch(C){console.error("[useRealtimeSync] Event handler error:",C),$==null||$(C)}});v.current.push(W)};D.forEach(y);const k=Se.subscribe("connection_status",h=>{if(K(h),!h.online){B.error("You appear to be offline. Realtime updates paused.",{id:"realtime-offline",duration:4e3});return}h.connected?(B.dismiss("realtime-reconnect"),B.success("Real-time sync connected",{id:"realtime-status",duration:2e3})):B.loading("Reconnecting to realtime sync...",{id:"realtime-reconnect"})});return v.current.push(k),()=>{v.current.forEach(h=>h()),v.current=[],B.dismiss("realtime-status"),B.dismiss("realtime-reconnect"),B.dismiss("realtime-offline")}},[I,x,g,JSON.stringify(D),M,$]);const E=s.useCallback(()=>{S(!0)},[]),A=s.useCallback(()=>{S(!1)},[]),c=s.useCallback((z,y,k)=>{try{Se.logSyncEvent({type:z,data:y,timestamp:Date.now(),scope:k,userId:x})}catch(h){console.error("[useRealtimeSync] Broadcast failed",h),$==null||$(h)}},[x,$]);return{connect:E,disconnect:A,broadcastUpdate:c,isConnected:Q.connected,connectionStatus:Q}},dt=(a={})=>{const{userId:x="demo-user",enabled:g=!0,saveInterval:D=3e4,maxRetries:M=3,onSaveSuccess:$,onSaveError:P}=a,[I,S]=s.useState(!1),[Q,K]=s.useState(null),[v,w]=s.useState(0),[E,A]=s.useState(navigator.onLine),c=s.useRef([]),z=s.useRef(),y=s.useRef(new Map);s.useEffect(()=>{const i=()=>{A(!0),C()},n=()=>{A(!1)};return window.addEventListener("online",i),window.addEventListener("offline",n),()=>{window.removeEventListener("online",i),window.removeEventListener("offline",n)}},[]);const k=s.useCallback(i=>`${i.courseId}_${i.moduleId}_${i.lessonId}`,[]),h=s.useCallback(i=>{try{const n=`autosave_${x}_${k(i)}`,N=le(ae({},i),{lastAccessed:i.lastAccessed.toISOString()});localStorage.setItem(n,JSON.stringify(N)),console.log("[AutoSave] Saved to local storage:",n)}catch(n){console.error("[AutoSave] Failed to save to local storage:",n)}},[x,k]),W=s.useCallback((i,n,N)=>{try{const L=`autosave_${x}_${i}_${n}_${N}`,H=localStorage.getItem(L);if(H){const de=JSON.parse(H);return le(ae({},de),{lastAccessed:new Date(de.lastAccessed)})}}catch(L){console.error("[AutoSave] Failed to load from local storage:",L)}return null},[x]),q=s.useCallback((i,n,N)=>{try{const L=`autosave_${x}_${i}_${n}_${N}`;localStorage.removeItem(L),console.log("[AutoSave] Cleared stored progress:",L)}catch(L){console.error("[AutoSave] Failed to clear stored progress:",L)}},[x]),Y=s.useCallback(i=>ee(void 0,null,function*(){if(!Ee)return console.warn("[AutoSave] Supabase not available"),!1;try{const{error:n}=yield Ee.from("user_progress").upsert({user_id:x,course_id:i.courseId,module_id:i.moduleId,lesson_id:i.lessonId,progress:i.progress,time_spent:i.timeSpent,completed:i.completed,reflection:i.reflection,quiz_scores:i.quizScores,video_progress:i.videoProgress,last_accessed:i.lastAccessed.toISOString(),updated_at:new Date().toISOString()},{onConflict:"user_id,course_id,module_id,lesson_id"});return n?(console.error("[AutoSave] Database save error:",n),!1):(console.log("[AutoSave] Successfully saved to database:",k(i)),!0)}catch(n){return console.error("[AutoSave] Database save exception:",n),!1}}),[x,k]),C=s.useCallback(()=>ee(void 0,null,function*(){if(!E||c.current.length===0||I)return;S(!0);const i=[...c.current];c.current=[];for(const n of i)try{(yield Y(n.data))?($==null||$(n.data),q(n.data.courseId,n.data.moduleId,n.data.lessonId)):n.attempts<M?c.current.push(le(ae({},n),{attempts:n.attempts+1})):(console.error("[AutoSave] Max retries exceeded for:",n.id),P==null||P(new Error("Max retries exceeded"),n.data))}catch(N){console.error("[AutoSave] Queue processing error:",N),P==null||P(N,n.data)}S(!1),K(new Date)}),[E,I,Y,M,$,P,q]),b=s.useCallback(i=>{if(!g)return;const n=k(i);y.current.set(n,i),w(y.current.size),h(i),E?(c.current=c.current.filter(N=>N.id!==n),c.current.push({id:n,data:i,timestamp:Date.now(),attempts:0})):B("Progress saved offline. Will sync when connection restored.",{icon:"💾",id:"offline-save"})},[g,k,h,E]),f=s.useCallback(i=>ee(void 0,null,function*(){return i&&b(i),E?(yield C(),c.current.length===0):(B.error("Cannot save - you are offline"),!1)}),[b,E,C]);return s.useEffect(()=>{if(!(!g||!E))return z.current=setInterval(()=>{y.current.size>0&&C()},D),()=>{z.current&&clearInterval(z.current)}},[g,E,D,C]),s.useEffect(()=>{E&&c.current.length>0&&C()},[E,C]),s.useEffect(()=>()=>{z.current&&clearInterval(z.current)},[]),{scheduleProgressSave:b,forceSave:f,loadFromStorage:W,clearStoredProgress:q,isSaving:I,isOnline:E,lastSaved:Q,pendingChanges:v,queueLength:c.current.length}},ut=(a={})=>{const{maxRetries:x=3,retryDelay:g=2e3,maxQueueSize:D=100,onSync:M,onSyncError:$,onQueueFull:P}=a,[I,S]=s.useState(navigator.onLine),[Q,K]=s.useState(!1),[v,w]=s.useState(0),[E,A]=s.useState(null),c=s.useRef([]),z=s.useRef(!1),y=s.useRef();s.useEffect(()=>{try{const i=localStorage.getItem("offline_progress_queue");if(i){const n=JSON.parse(i);c.current=n.filter(N=>{const L=Date.now()-6048e5;return N.timestamp>L}),w(c.current.length),console.log(`[OfflineQueue] Loaded ${c.current.length} items from storage`)}}catch(i){console.error("[OfflineQueue] Failed to load queue from storage:",i),c.current=[]}},[]);const k=s.useCallback(()=>{try{localStorage.setItem("offline_progress_queue",JSON.stringify(c.current))}catch(i){console.error("[OfflineQueue] Failed to save queue to storage:",i)}},[]);s.useEffect(()=>{const i=()=>{S(!0),B.success("Connection restored. Syncing progress...",{duration:3e3,id:"connection-restored"}),setTimeout(()=>q(),1e3)},n=()=>{S(!1),B("You're offline. Progress will be saved locally.",{icon:"💾",duration:4e3,id:"connection-lost"})};return window.addEventListener("online",i),window.addEventListener("offline",n),()=>{window.removeEventListener("online",i),window.removeEventListener("offline",n)}},[]);const h=s.useCallback(()=>`queue_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,[]),W=s.useCallback(i=>{c.current.length>=D&&(console.warn("[OfflineQueue] Queue size limit reached"),P==null||P(),c.current=c.current.filter(N=>N.priority!=="low").slice(-(D-1)));const n=le(ae({},i),{id:h(),timestamp:Date.now(),attempts:0});return c.current=c.current.filter(N=>!(N.userId===i.userId&&N.courseId===i.courseId&&N.lessonId===i.lessonId&&N.action===i.action)),c.current.push(n),c.current.sort((N,L)=>{const H={high:3,medium:2,low:1};return H[L.priority]-H[N.priority]||N.timestamp-L.timestamp}),w(c.current.length),k(),console.log("[OfflineQueue] Added item to queue:",n.id,n.action),I?setTimeout(()=>q(),500):B("Progress saved offline",{icon:"💾",duration:2e3,id:"offline-save"}),n.id},[D,I,h,k,P]),q=s.useCallback(()=>ee(void 0,null,function*(){if(!I||z.current||c.current.length===0)return;z.current=!0,K(!0),console.log(`[OfflineQueue] Processing ${c.current.length} queued items`);const i=[...c.current],n=[],N=[];for(const L of i){try{(yield Y(L))?(n.push(L.id),M==null||M(L),console.log("[OfflineQueue] Successfully synced:",L.id,L.action)):L.attempts<x?N.push(le(ae({},L),{attempts:L.attempts+1})):(console.error("[OfflineQueue] Max retries exceeded:",L.id),$==null||$(L,new Error("Max retries exceeded")))}catch(H){console.error("[OfflineQueue] Sync error for item:",L.id,H),L.attempts<x?N.push(le(ae({},L),{attempts:L.attempts+1})):$==null||$(L,H)}yield new Promise(H=>setTimeout(H,100))}c.current=c.current.filter(L=>!n.includes(L.id)).concat(N),w(c.current.length),k(),z.current=!1,K(!1),A(new Date),n.length>0&&B.success(`Synced ${n.length} progress updates`,{duration:3e3}),N.length>0&&(B("Some items will retry later",{icon:"⚠️",duration:2e3}),y.current&&clearTimeout(y.current),y.current=setTimeout(()=>{q()},g)),console.log("[OfflineQueue] Processing complete. Remaining items:",c.current.length)}),[I,x,g,M,$,k]),Y=i=>ee(void 0,null,function*(){try{if(yield new Promise(N=>setTimeout(N,200+Math.random()*300)),!(Math.random()>.1))throw new Error("Simulated API error");switch(i.action){case"user_progress":break;case"lesson_complete":break;case"quiz_submit":break;case"reflection_save":break}return!0}catch(n){return console.error(`[OfflineQueue] Failed to sync ${i.action}:`,n),!1}}),C=s.useCallback(()=>{c.current=[],w(0),k(),console.log("[OfflineQueue] Queue cleared")},[k]),b=s.useCallback(i=>{c.current=c.current.filter(n=>n.id!==i),w(c.current.length),k()},[k]),f=s.useCallback(()=>({total:c.current.length,byPriority:{high:c.current.filter(n=>n.priority==="high").length,medium:c.current.filter(n=>n.priority==="medium").length,low:c.current.filter(n=>n.priority==="low").length},byAction:c.current.reduce((n,N)=>(n[N.action]=(n[N.action]||0)+1,n),{}),oldestTimestamp:c.current.length>0?Math.min(...c.current.map(n=>n.timestamp)):null,failedItems:c.current.filter(n=>n.attempts>0).length}),[]);return s.useEffect(()=>{if(I&&c.current.length>0){const i=setTimeout(()=>q(),2e3);return()=>clearTimeout(i)}},[I,q]),s.useEffect(()=>()=>{y.current&&clearTimeout(y.current)},[]),{addToQueue:W,processQueue:q,clearQueue:C,removeItem:b,getQueueStats:f,isOnline:I,isProcessing:Q,queueSize:v,lastSync:E,queue:c.current}},mt=(a,x={})=>{const{userId:g="demo-user",enableAutoSave:D=!0,enableRealtime:M=!0,autoSaveInterval:$=3e4}=x,[P,I]=s.useState(null),[S,Q]=s.useState({}),[K,v]=s.useState({}),[w,E]=s.useState(!0),[A,c]=s.useState(null),[z,y]=s.useState("synced"),[k,h]=s.useState(null),W=s.useRef(new Date),q=s.useRef(new Set),Y=dt({userId:g,enabled:D,saveInterval:$,onSaveSuccess:o=>{console.log("[CourseProgress] Auto-save successful:",o),y("synced"),q.current.delete(`${o.courseId}_${o.lessonId}`)},onSaveError:(o,F)=>{console.error("[CourseProgress] Auto-save failed:",o,F),y("error")}}),C=ut({onSync:o=>{console.log("[CourseProgress] Offline item synced:",o),B.success(`Progress synced: ${o.action}`)},onSyncError:(o,F)=>{console.error("[CourseProgress] Offline sync failed:",o,F),B.error("Failed to sync some progress data")}}),b=s.useCallback(o=>{var F,j,G,se,J,V,oe,re,Z;if(o.type==="course_updated"){(((j=(F=o.payload)==null?void 0:F.course)==null?void 0:j.id)||((G=o.payload)==null?void 0:G.courseId))===a&&(console.log("[CourseProgress] Course updated via realtime:",o.payload),i());return}if(o.type==="user_progress"){if((((se=o.payload)==null?void 0:se.courseId)||((V=(J=o.payload)==null?void 0:J.progress)==null?void 0:V.course_id))!==a)return;console.log("[CourseProgress] Progress sync event:",o.payload),o.userId&&o.userId!==g&&H(o.payload.progress);return}o.type==="user_completed"&&(((oe=o.payload)==null?void 0:oe.courseId)||((Z=(re=o.payload)==null?void 0:re.progress)==null?void 0:Z.course_id))===a&&(console.log("[CourseProgress] Completion event received:",o.payload),i())},[a,g,i,H]),f=ct({userId:g,events:["course_updated","user_progress","user_completed","analytics_updated"],enabled:M,onEvent:b,onError:o=>{console.error("[CourseProgress] Realtime error:",o)}}),i=s.useCallback(()=>ee(void 0,null,function*(){try{if(E(!0),c(null),!""||!""){console.log("[CourseProgress] Running in demo mode");const X={id:`enrollment_demo_${Date.now()}`,user_id:g,course_id:a,enrolled_at:new Date().toISOString(),progress_percentage:0,completed_at:void 0,last_accessed_at:new Date().toISOString()};I(X),Q({}),v({}),E(!1);return}const{data:{user:j}}=yield Ee.auth.getUser(),G=(j==null?void 0:j.id)||g,{data:se,error:J}=yield Ee.from("user_course_enrollments").select("*").eq("user_id",G).eq("course_id",a).limit(1);if(J){console.error("Error loading enrollment:",J),c("Failed to load enrollment data");return}if(se&&se.length>0)I(se[0]);else{const X={id:`enrollment_${Date.now()}`,user_id:G,course_id:a,enrolled_at:new Date().toISOString(),progress_percentage:0,last_accessed_at:new Date().toISOString(),completed_at:void 0};I(X)}const{data:V,error:oe}=yield Ee.from("user_lesson_progress").select("*").eq("user_id",G).eq("course_id",a);if(oe&&console.error("Error loading progress:",oe),V){const X=V.reduce((ue,te)=>(ue[te.lesson_id]=te,ue),{});Q(X)}const{data:re,error:Z}=yield Ee.from("user_reflections").select("*").eq("user_id",G).eq("course_id",a);if(Z&&console.error("Error loading reflections:",Z),re){const X=re.reduce((ue,te)=>(ue[te.lesson_id]=te,ue),{});v(X)}}catch(o){console.error("Error in loadProgressData:",o),c("Failed to load progress data")}finally{E(!1)}}),[a,g]),n=s.useCallback((o,F,j)=>ee(void 0,null,function*(){try{const G="",se="",J=S[o]||{},V=ae(le(ae({},J),{id:J.id||`progress_${Date.now()}`,user_id:g,lesson_id:o,time_spent:J.time_spent||0,completed:J.completed||!1,progress_percentage:J.progress_percentage||0,last_accessed_at:new Date().toISOString(),completed_at:J.completed_at}),j);if(Q(re=>le(ae({},re),{[o]:V})),!G||!se){console.log("[CourseProgress] Demo mode - progress updated locally only"),y("synced");return}const oe=`${a}_${o}`;q.current.add(oe),y("pending"),W.current=new Date,D&&Y.scheduleProgressSave({courseId:a,lessonId:o,moduleId:F,progress:V.progress_percentage,timeSpent:V.time_spent,completed:V.completed,lastAccessed:new Date(V.last_accessed_at),quizScores:void 0,videoProgress:V.progress_percentage}),navigator.onLine||C.addToQueue({userId:g,courseId:a,lessonId:o,moduleId:F,action:"user_progress",data:V,priority:"medium"}),navigator.onLine&&M&&f.isConnected&&(yield f.broadcastUpdate("user_progress",{progress:le(ae({},V),{course_id:a,lesson_id:o,user_id:g,updated_at:new Date().toISOString()}),courseId:a,lessonId:o,userId:g,timestamp:Date.now()}))}catch(G){console.error("Error updating lesson progress:",G),c("Failed to update progress"),y("error")}}),[a,g,S,D,M,Y,C,f]),N=s.useCallback((o,F,j)=>ee(void 0,null,function*(){const G={completed:!0,completed_at:new Date().toISOString(),progress_percentage:100,last_accessed_at:new Date().toISOString()};yield n(o,F,G),C.addToQueue({userId:g,courseId:a,lessonId:o,moduleId:F,action:"lesson_complete",data:{lesson_id:o,completed_at:G.completed_at,quiz_score:j},priority:"high"}),B.success("Lesson completed!",{duration:3e3})}),[n,C,g,a]),L=s.useCallback((o,F)=>ee(void 0,null,function*(){var j,G;try{const se="",J="",V={id:((j=K[o])==null?void 0:j.id)||`reflection_${Date.now()}`,user_id:g,lesson_id:o,content:F,created_at:((G=K[o])==null?void 0:G.created_at)||new Date().toISOString(),updated_at:new Date().toISOString()};if(v(oe=>le(ae({},oe),{[o]:V})),!se||!J){console.log("[CourseProgress] Demo mode - reflection saved locally only");return}C.addToQueue({userId:g,courseId:a,lessonId:o,moduleId:"reflection",action:"reflection_save",data:V,priority:"low"}),B.success("Reflection saved")}catch(se){console.error("Error saving reflection:",se),B.error("Failed to save reflection")}}),[a,g,K,C]),H=s.useCallback(o=>{var V,oe,re;const F=(o==null?void 0:o.lesson_id)||(o==null?void 0:o.lessonId);if(!F)return;const j=o!=null&&o.progress?o.progress:o,G=typeof(j==null?void 0:j.progress)=="number"?j.progress:(oe=(V=j==null?void 0:j.progress_percentage)!=null?V:j==null?void 0:j.percentage)!=null?oe:0,se=typeof(j==null?void 0:j.completed)=="boolean"?j.completed:(re=o==null?void 0:o.completed)!=null?re:!1,J=(j==null?void 0:j.updated_at)||(j==null?void 0:j.last_accessed_at)||(o==null?void 0:o.timestamp)||new Date().toISOString();Q(Z=>{const X=Z[F]||{},ue=new Date(J),te=new Date(X.last_accessed_at||X.updated_at||0);return ue>te?le(ae({},Z),{[F]:le(ae(ae({},X),j),{progress_percentage:G,completed:se,last_accessed_at:J})}):Z})},[]),de=s.useCallback(()=>{const o=Object.values(S);if(o.length===0)return 0;const F=o.reduce((j,G)=>j+G.progress_percentage,0);return Math.round(F/o.length)},[S]),fe=s.useCallback(()=>{const o=Object.values(S).filter(j=>j.completed),F=Object.keys(S).length;return{completed:o.length,total:F,percentage:F>0?Math.round(o.length/F*100):0}},[S]);s.useEffect(()=>{i()},[i]);const je=s.useCallback(o=>{h(o),o&&S[o]&&n(o,"module_1",{last_accessed_at:new Date().toISOString()})},[S,n]);return{enrollmentData:P,lessonProgress:S,reflections:K,loading:w,error:A,updateLessonProgress:n,markLessonComplete:N,saveReflection:L,setActiveLessonTracking:je,calculateCourseProgress:de,getCompletionStats:fe,syncStatus:z,isOnline:C.isOnline,isSaving:Y.isSaving,isProcessingQueue:C.isProcessing,pendingChanges:Y.pendingChanges,queueSize:C.queueSize,lastSaved:Y.lastSaved,forceSave:Y.forceSave,processQueue:C.processQueue,loadFromStorage:Y.loadFromStorage,reloadData:i,isRealtimeConnected:f.isConnected,reconnectRealtime:f.connect,activeLesson:k}},xt=({src:a,title:x,thumbnail:g,onProgress:D,onComplete:M,initialTime:$=0,className:P="",autoPlay:I=!1,showTranscript:S=!1,transcript:Q="",captions:K=[]})=>{const v=s.useRef(null),w=s.useRef(null),E=s.useRef(null),[A,c]=s.useState(!1),[z,y]=s.useState(!0),[k,h]=s.useState(0),[W,q]=s.useState(0),[Y,C]=s.useState(1),[b,f]=s.useState(!1),[i,n]=s.useState(1),[N,L]=s.useState(!1),[H,de]=s.useState(!0),[fe,je]=s.useState(!1),[o,F]=s.useState(!1),[j]=s.useState(!1),[G,se]=s.useState(!1),[J]=s.useState(0),[V,oe]=s.useState(0),[re,Z]=s.useState(""),X=s.useRef();s.useEffect(()=>{const l=v.current;if(!l)return;const T=()=>y(!0),me=()=>{y(!1),$>0&&(l.currentTime=$)},ke=()=>{q(l.duration)},pe=()=>{const ge=l.currentTime;if(h(ge),!j&&D&&D(ge/l.duration*100),K.length>0&&o){const De=K.find(ze=>ge>=ze.start&&ge<=ze.end);Z(De?De.text:"")}Math.floor(ge)%10===0&&localStorage.setItem(`video-progress-${a}`,ge.toString())},_e=()=>{if(l.buffered.length>0){const ge=l.buffered.end(l.buffered.length-1);oe(ge/l.duration*100)}},Le=()=>{c(!1),h(W),M&&M(),localStorage.removeItem(`video-progress-${a}`)},$e=()=>{c(!0),se(!0)},Ne=()=>c(!1);return l.addEventListener("loadstart",T),l.addEventListener("canplay",me),l.addEventListener("loadedmetadata",ke),l.addEventListener("timeupdate",pe),l.addEventListener("progress",_e),l.addEventListener("ended",Le),l.addEventListener("play",$e),l.addEventListener("pause",Ne),()=>{l.removeEventListener("loadstart",T),l.removeEventListener("canplay",me),l.removeEventListener("loadedmetadata",ke),l.removeEventListener("timeupdate",pe),l.removeEventListener("progress",_e),l.removeEventListener("ended",Le),l.removeEventListener("play",$e),l.removeEventListener("pause",Ne)}},[a,$,D,M,j,W,K,o]),s.useEffect(()=>{const l=localStorage.getItem(`video-progress-${a}`);if(l&&v.current){const T=parseFloat(l);v.current.currentTime=T,h(T)}},[a]),s.useEffect(()=>{let l;return A&&!j&&(l=setInterval(()=>{console.log(`Watch time: ${J+1}s`)},1e3)),()=>{l&&clearInterval(l)}},[A,j]);const ue=s.useCallback(()=>{X.current&&clearTimeout(X.current),de(!0),A&&(X.current=setTimeout(()=>{de(!1)},3e3))},[A]),te=()=>{const l=v.current;l&&(A?l.pause():l.play())},Fe=l=>{const T=v.current;if(!T||!W)return;const me=l/100*W;T.currentTime=me,h(me)},ye=l=>{const T=v.current;T&&(T.currentTime=Math.max(0,Math.min(W,k+l)))},m=l=>{const T=v.current;T&&(T.volume=l,C(l),f(l===0))},Ue=()=>{const l=v.current;l&&(b?(l.volume=Y||.5,f(!1)):(l.volume=0,f(!0)))},_=l=>{const T=v.current;T&&(T.playbackRate=l,n(l),je(!1))},t=()=>ee(void 0,null,function*(){const l=w.current;l&&(N?document.exitFullscreen&&(yield document.exitFullscreen()):l.requestFullscreen&&(yield l.requestFullscreen()))});s.useEffect(()=>{const l=()=>{L(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",l),()=>document.removeEventListener("fullscreenchange",l)},[]);const Ke=l=>{const T=E.current;if(!T||!W)return;const me=T.getBoundingClientRect(),ke=(l.clientX-me.left)/me.width*100;Fe(Math.max(0,Math.min(100,ke)))};s.useEffect(()=>{const l=T=>{if(G)switch(T.key){case" ":T.preventDefault(),te();break;case"ArrowLeft":T.preventDefault(),ye(-10);break;case"ArrowRight":T.preventDefault(),ye(10);break;case"ArrowUp":T.preventDefault(),m(Math.min(1,Y+.1));break;case"ArrowDown":T.preventDefault(),m(Math.max(0,Y-.1));break;case"m":T.preventDefault(),Ue();break;case"f":T.preventDefault(),t();break;case"c":T.preventDefault(),F(!o);break}};return document.addEventListener("keydown",l),()=>document.removeEventListener("keydown",l)},[G,Y,o]);const Ce=l=>{const T=Math.floor(l/60),me=Math.floor(l%60);return`${T}:${me.toString().padStart(2,"0")}`};return e.jsxs("div",{ref:w,className:`relative bg-black rounded-lg overflow-hidden ${P}`,onMouseMove:ue,onMouseLeave:()=>A&&de(!1),children:[e.jsx("video",{ref:v,src:a,poster:g,className:"w-full h-full",autoPlay:I,playsInline:!0,preload:"metadata",onClick:te}),z&&e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-white"})}),!A&&!z&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("button",{onClick:te,className:"bg-orange-500 bg-opacity-90 hover:bg-opacity-100 rounded-full p-6 transition-all duration-200 transform hover:scale-105",children:e.jsx(bs,{className:"h-8 w-8 text-white ml-1",fill:"white"})})}),o&&re&&e.jsx("div",{className:"absolute bottom-20 left-1/2 transform -translate-x-1/2 bg-black bg-opacity-75 text-white px-4 py-2 rounded max-w-md text-center",children:re}),e.jsxs("div",{className:`absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black via-black to-transparent p-4 transition-opacity duration-300 ${H?"opacity-100":"opacity-0"}`,children:[e.jsx("div",{className:"mb-4",children:e.jsxs("div",{ref:E,className:"w-full h-2 bg-gray-600 rounded-full cursor-pointer relative overflow-hidden",onClick:Ke,children:[e.jsx("div",{className:"absolute top-0 left-0 h-full bg-gray-400 rounded-full",style:{width:`${V}%`}}),e.jsx("div",{className:"absolute top-0 left-0 h-full bg-orange-500 rounded-full transition-all duration-100",style:{width:`${k/W*100}%`}}),e.jsx("div",{className:"absolute top-1/2 transform -translate-y-1/2 w-4 h-4 bg-orange-500 rounded-full border-2 border-white shadow-lg transition-all duration-100",style:{left:`${k/W*100}%`,marginLeft:"-8px"}})]})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:te,className:"text-white hover:text-orange-400 transition-colors duration-200",children:A?e.jsx(Ps,{className:"h-6 w-6"}):e.jsx(bs,{className:"h-6 w-6"})}),e.jsx("button",{onClick:()=>ye(-10),className:"text-white hover:text-orange-400 transition-colors duration-200",children:e.jsx(Os,{className:"h-5 w-5"})}),e.jsx("button",{onClick:()=>ye(10),className:"text-white hover:text-orange-400 transition-colors duration-200",children:e.jsx(Fs,{className:"h-5 w-5"})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:Ue,className:"text-white hover:text-orange-400 transition-colors duration-200",children:b||Y===0?e.jsx(Us,{className:"h-5 w-5"}):e.jsx(Ds,{className:"h-5 w-5"})}),e.jsx("input",{type:"range",min:"0",max:"1",step:"0.1",value:b?0:Y,onChange:l=>m(parseFloat(l.target.value)),className:"w-20 h-1 bg-gray-600 rounded-lg appearance-none cursor-pointer slider"})]}),e.jsxs("div",{className:"text-white text-sm font-medium",children:[Ce(k)," / ",Ce(W)]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[K.length>0&&e.jsx("button",{onClick:()=>F(!o),className:`transition-colors duration-200 ${o?"text-orange-400":"text-white hover:text-orange-400"}`,children:e.jsx(zs,{className:"h-5 w-5"})}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>je(!fe),className:"text-white hover:text-orange-400 transition-colors duration-200",children:e.jsx(Qs,{className:"h-5 w-5"})}),fe&&e.jsxs("div",{className:"absolute bottom-8 right-0 bg-black bg-opacity-90 rounded-lg p-3 min-w-[120px]",children:[e.jsx("div",{className:"text-white text-sm font-medium mb-2",children:"Playback Speed"}),[.5,.75,1,1.25,1.5,2].map(l=>e.jsxs("button",{onClick:()=>_(l),className:`block w-full text-left px-2 py-1 text-sm rounded transition-colors ${i===l?"bg-orange-500 text-white":"text-gray-300 hover:bg-gray-700"}`,children:[l,"x"]},l))]})]}),e.jsx("button",{onClick:t,className:"text-white hover:text-orange-400 transition-colors duration-200",children:N?e.jsx(Vs,{className:"h-5 w-5"}):e.jsx(qs,{className:"h-5 w-5"})})]})]})]}),x&&H&&e.jsx("div",{className:"absolute top-4 left-4 text-white font-medium text-lg bg-black bg-opacity-50 px-3 py-1 rounded",children:x}),k>=W-1&&W>0&&e.jsx("div",{className:"absolute top-4 right-4",children:e.jsxs("button",{onClick:()=>Fe(0),className:"bg-orange-500 bg-opacity-90 hover:bg-opacity-100 text-white px-4 py-2 rounded-lg flex items-center space-x-2 transition-all duration-200",children:[e.jsx(Ys,{className:"h-4 w-4"}),e.jsx("span",{children:"Restart"})]})}),S&&Q&&e.jsxs("div",{className:"absolute right-0 top-0 bottom-0 w-80 bg-white bg-opacity-95 overflow-y-auto p-4 text-sm",children:[e.jsx("h3",{className:"font-semibold mb-4 text-gray-900",children:"Transcript"}),e.jsx("div",{className:"text-gray-700 leading-relaxed whitespace-pre-wrap",children:Q})]})]})},gt=({currentProgress:a,totalLessons:x,completedLessons:g,currentLessonTitle:D,onPrevious:M,onNext:$,hasPrevious:P=!1,hasNext:I=!1,estimatedTimeRemaining:S,visible:Q=!0,className:K=""})=>{const[v,w]=s.useState(!1),[E,A]=s.useState(a),[c,z]=s.useState(!1);s.useEffect(()=>{a>E&&[25,50,75,100].find(q=>E<q&&a>=q)&&(w(!0),setTimeout(()=>w(!1),3e3)),A(a)},[a,E]),s.useEffect(()=>{const h=()=>{z(window.scrollY>100)};return window.addEventListener("scroll",h),()=>window.removeEventListener("scroll",h)},[]);const y=()=>a>=100?"🎉 Congratulations! Course completed!":a>=75?"🚀 Almost there! You're doing great!":a>=50?"💪 Halfway through! Keep it up!":a>=25?"⭐ Great progress! You're on track!":"",k=()=>a>=100?"from-green-400 to-emerald-500":a>=75?"from-blue-400 to-indigo-500":a>=50?"from-purple-400 to-pink-500":a>=25?"from-yellow-400 to-orange-500":"from-orange-400 to-red-500";return Q?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`fixed bottom-6 left-1/2 transform -translate-x-1/2 z-50 transition-all duration-300 translate-y-0 ${K}`,children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl border border-gray-200 p-4 min-w-[400px] max-w-2xl backdrop-blur-sm bg-opacity-95",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:`w-3 h-3 rounded-full bg-gradient-to-r ${k()}`}),e.jsxs("span",{className:"text-sm font-semibold text-gray-900",children:[g," of ",x," lessons"]})]}),a===100&&e.jsx(Ae,{className:"h-5 w-5 text-yellow-500 animate-pulse"})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[S&&e.jsxs("div",{className:"flex items-center text-xs text-gray-600",children:[e.jsx(Me,{className:"h-4 w-4 mr-1"}),S," left"]}),e.jsxs("div",{className:"text-sm font-bold text-gray-900",children:[Math.round(a),"%"]})]})]}),e.jsxs("div",{className:"relative mb-3",children:[e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3 overflow-hidden",children:e.jsx("div",{className:`h-3 rounded-full bg-gradient-to-r ${k()} transition-all duration-500 relative`,style:{width:`${a}%`},children:e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white to-transparent opacity-30 animate-pulse"})})}),e.jsx("div",{className:"absolute top-0 left-0 w-full h-3 flex justify-between items-center",children:[25,50,75,100].map(h=>e.jsx("div",{className:`w-1 h-5 -mt-1 rounded-full transition-colors duration-300 ${a>=h?"bg-white shadow-md":"bg-gray-300"}`,style:{marginLeft:"25%"}},h))})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900 truncate",children:D}),v&&e.jsx("div",{className:"text-xs text-green-600 font-medium animate-bounce mt-1",children:y()})]}),e.jsxs("div",{className:"flex items-center space-x-2 ml-4",children:[e.jsx("button",{onClick:M,disabled:!P,className:`p-2 rounded-lg transition-all duration-200 ${P?"text-gray-600 hover:text-gray-900 hover:bg-gray-100":"text-gray-300 cursor-not-allowed"}`,title:"Previous lesson",children:e.jsx(Bs,{className:"h-5 w-5"})}),e.jsx("button",{onClick:$,disabled:!I,className:`p-2 rounded-lg transition-all duration-200 ${I?"text-white bg-gradient-to-r from-orange-500 to-red-500 hover:from-orange-600 hover:to-red-600 shadow-lg":"text-gray-300 cursor-not-allowed bg-gray-200"}`,title:I?"Next lesson":"Course complete",children:a>=100?e.jsx(Ae,{className:"h-5 w-5"}):e.jsx(Ks,{className:"h-5 w-5"})})]})]})]})}),v&&a>=100&&e.jsx("div",{className:"fixed inset-0 z-60 flex items-center justify-center bg-black bg-opacity-50 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white rounded-3xl p-8 max-w-md mx-4 text-center animate-bounce-in",children:[e.jsx("div",{className:"mb-6",children:e.jsx(Ae,{className:"h-16 w-16 text-yellow-500 mx-auto animate-pulse"})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"🎉 Congratulations!"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"You've successfully completed the course! Your certificate is ready for download."}),e.jsxs("div",{className:"flex items-center justify-center space-x-4",children:[e.jsx("button",{className:"bg-gradient-to-r from-green-500 to-emerald-600 text-white px-6 py-3 rounded-xl font-semibold hover:from-green-600 hover:to-emerald-700 transition-all duration-200 shadow-lg",children:"Download Certificate"}),e.jsx("button",{onClick:()=>w(!1),className:"text-gray-600 hover:text-gray-900 px-6 py-3 font-medium",children:"Continue"})]})]})}),c&&e.jsx("div",{className:"fixed top-0 left-0 right-0 z-40",children:e.jsx("div",{className:`h-1 bg-gradient-to-r ${k()} transition-all duration-300`,style:{width:`${a}%`}})}),v&&a<100&&e.jsx("div",{className:"fixed top-6 right-6 z-50 animate-slide-in-right",children:e.jsx("div",{className:"bg-white rounded-xl shadow-xl border border-gray-200 p-4 max-w-sm",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"flex-shrink-0",children:a>=75?e.jsx(ws,{className:"h-8 w-8 text-blue-500"}):a>=50?e.jsx(Ss,{className:"h-8 w-8 text-purple-500"}):e.jsx(ne,{className:"h-8 w-8 text-orange-500"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-gray-900 text-sm",children:"Milestone Reached!"}),e.jsx("div",{className:"text-xs text-gray-600",children:y()})]})]})})})]}):null},ht=({course:a,completionData:x,keyTakeaways:g=[],nextSteps:D=[],recommendedCourses:M=[],onClose:$,onCertificateDownload:P,onShareComplete:I,className:S=""})=>{var Y,C;const[Q,K]=s.useState(!0),[v,w]=s.useState("summary"),[E,A]=s.useState(""),[c,z]=s.useState(!1);s.useEffect(()=>{const b=`${window.location.origin}/course/${a.id}/completed`;A(b);const f=setTimeout(()=>K(!1),5e3);return()=>clearTimeout(f)},[a.id]);const y=b=>{const f=Math.floor(b/60),i=b%60;return f>0?`${f}h ${i}m`:`${i}m`},k=b=>{switch(b==null?void 0:b.toUpperCase()){case"A":case"A+":case"A-":return"text-green-600 bg-green-50";case"B":case"B+":case"B-":return"text-blue-600 bg-blue-50";case"C":case"C+":case"C-":return"text-yellow-600 bg-yellow-50";default:return"text-gray-600 bg-gray-50"}},h=b=>ee(void 0,null,function*(){const f=`Just completed "${a.title}"! 🎓 #Learning #ProfessionalDevelopment`;switch(b){case"linkedin":window.open(`https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(E)}&summary=${encodeURIComponent(f)}`,"_blank");break;case"twitter":window.open(`https://twitter.com/intent/tweet?text=${encodeURIComponent(f)}&url=${encodeURIComponent(E)}`,"_blank");break;case"email":window.open(`mailto:?subject=${encodeURIComponent(`Course Completion: ${a.title}`)}&body=${encodeURIComponent(`${f}

${E}`)}`,"_blank");break;case"copy":try{yield navigator.clipboard.writeText(E),z(!0),setTimeout(()=>z(!1),2e3)}catch(i){console.error("Failed to copy link:",i)}break}I&&I(b)}),W=((Y=a.modules)==null?void 0:Y.reduce((b,f)=>b+f.lessons.length,0))||0,q=((C=a.modules)==null?void 0:C.reduce((b,f)=>b+f.lessons.filter(i=>i.completed).length,0))||0;return e.jsxs("div",{className:`min-h-screen bg-gradient-to-br from-orange-50 via-red-50 to-pink-50 ${S}`,children:[Q&&e.jsx("div",{className:"fixed inset-0 pointer-events-none z-10",children:e.jsx("div",{className:"confetti-animation",children:Array.from({length:50}).map((b,f)=>e.jsx("div",{className:"confetti-piece",style:{left:`${Math.random()*100}%`,animationDelay:`${Math.random()*3}s`,backgroundColor:["#FF8895","#D72638","#3A7FFF","#2D9B66"][Math.floor(Math.random()*4)]}},f))})}),e.jsxs("div",{className:"container mx-auto px-4 py-12 relative z-20",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("div",{className:"mb-6",children:e.jsx(Ae,{className:"h-20 w-20 text-yellow-500 mx-auto animate-bounce"})}),e.jsx("h1",{className:"text-4xl md:text-6xl font-bold text-gray-900 mb-4",children:"Congratulations!"}),e.jsxs("p",{className:"text-xl text-gray-600 mb-6 max-w-2xl mx-auto",children:["You've successfully completed ",e.jsxs("span",{className:"font-semibold text-gray-900",children:['"',a.title,'"']})]}),e.jsxs("div",{className:"flex flex-wrap items-center justify-center gap-6 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Me,{className:"h-4 w-4"}),e.jsxs("span",{children:["Completed in ",y(x.timeSpent)]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ne,{className:"h-4 w-4 text-green-500"}),e.jsxs("span",{children:[q,"/",W," lessons"]})]}),x.grade&&e.jsxs("div",{className:`flex items-center space-x-2 px-3 py-1 rounded-full ${k(x.grade)}`,children:[e.jsx(Ge,{className:"h-4 w-4"}),e.jsxs("span",{className:"font-medium",children:["Grade: ",x.grade]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ss,{className:"h-4 w-4 text-blue-500"}),e.jsxs("span",{children:["Completed ",x.completedAt.toLocaleDateString()]})]})]})]}),e.jsx("div",{className:"flex justify-center mb-8",children:e.jsx("div",{className:"bg-white rounded-xl p-1 shadow-lg border border-gray-200",children:[{id:"summary",label:"Summary",icon:Pe},{id:"certificate",label:"Certificate",icon:Oe},{id:"next-steps",label:"Next Steps",icon:Be}].map(({id:b,label:f,icon:i})=>e.jsxs("button",{onClick:()=>w(b),className:`px-6 py-3 rounded-lg font-medium transition-all duration-200 flex items-center space-x-2 ${v===b?"bg-gradient-to-r from-orange-500 to-red-500 text-white shadow-md":"text-gray-600 hover:text-gray-900 hover:bg-gray-50"}`,children:[e.jsx(i,{className:"h-4 w-4"}),e.jsx("span",{children:f})]},b))})}),e.jsxs("div",{className:"max-w-4xl mx-auto",children:[v==="summary"&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"bg-white rounded-2xl p-8 shadow-lg border border-gray-200",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Course Summary"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-start space-x-4",children:[a.thumbnail&&e.jsx("img",{src:a.thumbnail,alt:a.title,className:"w-16 h-16 rounded-lg object-cover"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:a.title}),a.instructor&&e.jsxs("p",{className:"text-sm text-gray-600",children:["by ",a.instructor]}),a.description&&e.jsx("p",{className:"text-sm text-gray-600 mt-2",children:a.description})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:q}),e.jsx("div",{className:"text-sm text-green-600",children:"Lessons Completed"})]}),e.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:y(x.timeSpent)}),e.jsx("div",{className:"text-sm text-blue-600",children:"Time Invested"})]})]}),x.score&&e.jsxs("div",{className:"text-center p-4 bg-purple-50 rounded-lg",children:[e.jsxs("div",{className:"text-2xl font-bold text-purple-600",children:[x.score,"%"]}),e.jsx("div",{className:"text-sm text-purple-600",children:"Overall Score"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl p-8 shadow-lg border border-gray-200",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Key Takeaways"}),g.length>0?e.jsx("ul",{className:"space-y-4",children:g.map((b,f)=>e.jsxs("li",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"flex-shrink-0 w-6 h-6 bg-gradient-to-r from-orange-400 to-red-500 rounded-full flex items-center justify-center text-white text-sm font-bold",children:f+1}),e.jsx("span",{className:"text-gray-700",children:b})]},f))}):e.jsxs("div",{className:"text-center text-gray-500 py-8",children:[e.jsx(Pe,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"No specific takeaways recorded for this course."})]}),e.jsxs("div",{className:"mt-8 pt-6 border-t border-gray-200",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Share Your Achievement"}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsxs("button",{onClick:()=>h("linkedin"),className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(Ws,{className:"h-4 w-4"}),e.jsx("span",{children:"LinkedIn"})]}),e.jsxs("button",{onClick:()=>h("twitter"),className:"flex items-center space-x-2 px-4 py-2 bg-sky-500 text-white rounded-lg hover:bg-sky-600 transition-colors",children:[e.jsx(Gs,{className:"h-4 w-4"}),e.jsx("span",{children:"Twitter"})]}),e.jsxs("button",{onClick:()=>h("email"),className:"flex items-center space-x-2 px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",children:[e.jsx(Js,{className:"h-4 w-4"}),e.jsx("span",{children:"Email"})]}),e.jsxs("button",{onClick:()=>h("copy"),className:"flex items-center space-x-2 px-4 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600 transition-colors",children:[e.jsx(Hs,{className:"h-4 w-4"}),e.jsx("span",{children:c?"Copied!":"Copy Link"})]})]})]})]})]}),v==="certificate"&&e.jsxs("div",{className:"bg-white rounded-2xl p-8 shadow-lg border border-gray-200 text-center",children:[e.jsx(Oe,{className:"h-16 w-16 text-yellow-500 mx-auto mb-6"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Your Certificate"}),x.certificateUrl?e.jsxs("div",{className:"space-y-6",children:[e.jsx("p",{className:"text-gray-600",children:"Congratulations! Your certificate is ready for download."}),e.jsxs("div",{className:"bg-gradient-to-r from-orange-50 to-red-50 rounded-xl p-6 border border-orange-200",children:[e.jsx("div",{className:"font-semibold text-gray-900 mb-2",children:"Certificate of Completion"}),e.jsx("div",{className:"text-sm text-gray-600 mb-4",children:a.title}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Certificate ID: ",x.certificateId]})]}),e.jsxs("div",{className:"flex justify-center space-x-4",children:[e.jsxs("button",{onClick:P,className:"bg-gradient-to-r from-green-500 to-emerald-600 text-white px-8 py-3 rounded-xl font-semibold hover:from-green-600 hover:to-emerald-700 transition-all duration-200 shadow-lg flex items-center space-x-2",children:[e.jsx(Ye,{className:"h-5 w-5"}),e.jsx("span",{children:"Download Certificate"})]}),e.jsxs("a",{href:x.certificateUrl,target:"_blank",rel:"noopener noreferrer",className:"bg-white border border-gray-300 text-gray-700 px-8 py-3 rounded-xl font-medium hover:bg-gray-50 transition-all duration-200 flex items-center space-x-2",children:[e.jsx(Xs,{className:"h-5 w-5"}),e.jsx("span",{children:"View Certificate"})]})]})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("p",{className:"text-gray-600",children:"Your certificate is being generated. Please check back in a few minutes."}),e.jsxs("button",{onClick:()=>window.location.reload(),className:"bg-gradient-to-r from-orange-500 to-red-500 text-white px-8 py-3 rounded-xl font-semibold hover:from-orange-600 hover:to-red-600 transition-all duration-200 shadow-lg flex items-center space-x-2 mx-auto",children:[e.jsx(Je,{className:"h-5 w-5"}),e.jsx("span",{children:"Check Again"})]})]})]}),v==="next-steps"&&e.jsxs("div",{className:"space-y-8",children:[D.length>0&&e.jsxs("div",{className:"bg-white rounded-2xl p-8 shadow-lg border border-gray-200",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Recommended Next Steps"}),e.jsx("div",{className:"grid gap-6",children:D.map((b,f)=>e.jsxs("div",{className:"flex items-start space-x-4 p-4 bg-gray-50 rounded-xl",children:[e.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-gradient-to-r from-orange-400 to-red-500 rounded-full flex items-center justify-center text-white font-bold",children:f+1}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:b.title}),e.jsx("p",{className:"text-gray-600 mb-3",children:b.description}),(b.action||b.href)&&e.jsxs("button",{onClick:b.action,className:"text-orange-600 hover:text-orange-700 font-medium text-sm flex items-center space-x-1",children:[e.jsx("span",{children:"Get Started"}),e.jsx(Be,{className:"h-4 w-4"})]})]})]},f))})]}),M.length>0&&e.jsxs("div",{className:"bg-white rounded-2xl p-8 shadow-lg border border-gray-200",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Continue Learning"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:M.map(b=>e.jsxs("div",{className:"border border-gray-200 rounded-xl overflow-hidden hover:shadow-md transition-shadow",children:[e.jsx("img",{src:b.thumbnail,alt:b.title,className:"w-full h-32 object-cover"}),e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:b.title}),e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-600 mb-4",children:[e.jsx("span",{children:b.duration}),e.jsx("span",{className:"bg-gray-100 px-2 py-1 rounded",children:b.difficulty})]}),e.jsx("button",{className:"w-full bg-gradient-to-r from-orange-500 to-red-500 text-white py-2 rounded-lg font-medium hover:from-orange-600 hover:to-red-600 transition-all duration-200",children:"Start Course"})]})]},b.id))})]})]})]}),e.jsx("div",{className:"text-center mt-12",children:e.jsx("div",{className:"space-y-4",children:e.jsx("button",{onClick:$,className:"bg-white text-gray-700 border border-gray-300 px-8 py-3 rounded-xl font-medium hover:bg-gray-50 transition-all duration-200",children:"Return to Courses"})})})]}),e.jsx("style",{children:`
        .confetti-animation {
          position: absolute;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          overflow: hidden;
        }
        
        .confetti-piece {
          position: absolute;
          width: 8px;
          height: 8px;
          animation: confetti-fall 3s linear infinite;
        }
        
        @keyframes confetti-fall {
          0% {
            transform: translateY(-100vh) rotate(0deg);
            opacity: 1;
          }
          100% {
            transform: translateY(100vh) rotate(720deg);
            opacity: 0;
          }
        }
        
        @keyframes bounce-in {
          0% {
            transform: scale(0.3);
            opacity: 0;
          }
          50% {
            transform: scale(1.05);
            opacity: 1;
          }
          70% {
            transform: scale(0.9);
          }
          100% {
            transform: scale(1);
          }
        }
        
        .animate-bounce-in {
          animation: bounce-in 0.6s ease-out;
        }
      `})]})},St=()=>{var es,ss;const[a,x]=s.useState({clicks:0,timeSpent:0,interactions:0,completionPrediction:0}),[g,D]=s.useState([]),[M,$]=s.useState(!1),[P,I]=s.useState(null),S=s.useRef(),Q=s.useCallback(r=>ee(void 0,null,function*(){S.current&&clearTimeout(S.current),S.current=setTimeout(()=>ee(void 0,null,function*(){$(!0);try{I(new Date)}catch(u){}finally{$(!1)}}),2e3)}),[]),[K]=s.useState(Date.now()),v=s.useCallback((r,u)=>{x(d=>le(ae({},d),{clicks:d.clicks+(r==="click"?1:0),interactions:d.interactions+1,timeSpent:Date.now()-K}))},[K]),{moduleId:w,lessonId:E}=Zs(),A=et(),[c,z]=s.useState(0),[y,k]=s.useState(0),[h,W]=s.useState(""),[q,Y]=s.useState(0),[C,b]=s.useState({}),[f,i]=s.useState(!1),[n,N]=s.useState(null),[L,H]=s.useState({}),[de,fe]=s.useState(!1),[je,o]=s.useState(0),[F,j]=s.useState(0),[G,se]=s.useState(!0),J=s.useRef(null),V=s.useRef(),[oe,re]=s.useState(Date.now()),[Z,X]=s.useState(!1),[ue,te]=s.useState(!1),[Fe,ye]=s.useState(!1),m=s.useMemo(()=>{const r=w?We.getCourse(w):null;return console.log("📖 Loading course data for ID:",w,"Found:",!!r,"Refresh time:",oe),r},[w,oe]),Ue=r=>{var d;if(!r)return{isValid:!1,issues:["Course not found"]};const u=[];return(!r.modules||r.modules.length===0)&&u.push("No modules found"),r.title||u.push("Course title missing"),(d=r.modules)==null||d.forEach((U,R)=>{var O;(!U.lessons||U.lessons.length===0)&&u.push(`Module ${R+1} has no lessons`),(O=U.lessons)==null||O.forEach((xe,we)=>{var Te;xe.type==="video"&&!((Te=xe.content)!=null&&Te.videoUrl)&&u.push(`Module ${R+1}, Lesson ${we+1}: Video lesson missing videoUrl`),xe.title||u.push(`Module ${R+1}, Lesson ${we+1}: Missing title`)})}),{isValid:u.length===0,issues:u}},_=(es=m==null?void 0:m.modules)==null?void 0:es[c],t=_==null?void 0:_.lessons[y],Ke=Ue(m);console.log("🔍 Course Data Validation:",Ke),console.log("📚 LMS Module Debug:",{moduleIdParam:w,lessonIdParam:E,course:m,courseModules:m==null?void 0:m.modules,currentModuleIndex:c,currentLessonIndex:y,currentModule:_,currentLessonData:t}),s.useEffect(()=>{const r=()=>{se(!0),V.current=setInterval(()=>{j(d=>d+1)},1e3)},u=()=>{se(!1),V.current&&clearInterval(V.current)};return window.addEventListener("focus",r),window.addEventListener("blur",u),r(),()=>{window.removeEventListener("focus",r),window.removeEventListener("blur",u),V.current&&clearInterval(V.current)}},[]),s.useEffect(()=>{w&&!m&&(console.log("🔄 Course not found, forcing store refresh for ID:",w),window.location.reload())},[w,m]);const Ce=s.useCallback(()=>ee(void 0,null,function*(){if(!Z){X(!0);try{console.log("🔄 Manually refreshing course data..."),yield We.init(),re(Date.now()),setTimeout(()=>{X(!1),te(!0),console.log("✅ Course data refreshed successfully"),setTimeout(()=>{te(!1)},3e3)},1e3)}catch(r){console.error("❌ Failed to refresh course data:",r),X(!1)}}}),[Z]);s.useEffect(()=>{const r=setInterval(()=>ee(void 0,null,function*(){!Z&&document.visibilityState==="visible"&&(console.log("🔄 Auto-refreshing course data..."),yield We.init(),re(Date.now()))}),3e4);return()=>clearInterval(r)},[Z]),s.useEffect(()=>{const r=Se.subscribeToCourseUpdates(d=>{console.log("🔄 Real-time course update received:",d),(d.courseId===w||d.manual)&&(re(Date.now()),d.manual&&(te(!0),setTimeout(()=>te(!1),3e3)))}),u=Se.subscribeToRefresh(d=>{console.log("🔄 Global refresh received:",d),re(Date.now()),d.manual&&(te(!0),setTimeout(()=>te(!1),3e3))});return()=>{r(),u()}},[w]),s.useEffect(()=>{const r=()=>{document.visibilityState==="visible"&&!Z&&(console.log("👁️ Page became visible, checking for course updates..."),Ce())};return document.addEventListener("visibilitychange",r),()=>document.removeEventListener("visibilitychange",r)},[Ce,Z]);const{lessonProgress:l,reflections:T,loading:me,error:ke,updateLessonProgress:pe,markLessonComplete:_e,saveReflection:Le,setActiveLessonTracking:$e}=mt(w||"",{enableAutoSave:!0,enableRealtime:!0,autoSaveInterval:3e4});s.useEffect(()=>{t!=null&&t.id&&T[t.id]?W(T[t.id].content):W("")},[c,y,T,t]),s.useEffect(()=>{t!=null&&t.id&&$e&&$e(t.id)},[t==null?void 0:t.id,$e]),s.useEffect(()=>{if(m&&E)for(let r=0;r<(m.modules||[]).length;r++){const d=(m.modules||[])[r].lessons.findIndex(U=>U.id===E);if(d!==-1){z(r),k(d);return}}},[E,m]);const Ne=s.useCallback(()=>ee(void 0,null,function*(){const r=l[(t==null?void 0:t.id)||""];if(!((r==null?void 0:r.completed)||!1)&&t&&_&&(yield _e(t.id,_.id)),_&&y<_.lessons.length-1){const d=y+1;k(d),A(`/lms/module/${w}/lesson/${_.lessons[d].id}`)}else if(m&&c<(m.modules||[]).length-1){const d=c+1;z(d),k(0),A(`/lms/module/${w}/lesson/${(m.modules||[])[d].lessons[0].id}`)}b({}),i(!1),N(null),H({}),fe(!1)}),[y,c,m,_,t,l,_e,w,A]),ge=s.useCallback(()=>{if(_&&y>0){const r=y-1;k(r),A(`/lms/module/${w}/lesson/${_.lessons[r].id}`)}else if(m&&c>0){const r=c-1,u=(m.modules||[])[r];z(r),k(u.lessons.length-1),A(`/lms/module/${w}/lesson/${u.lessons[u.lessons.length-1].id}`)}b({}),i(!1),N(null),H({}),fe(!1)},[y,c,m,_,w,A]),De=s.useCallback(r=>ee(void 0,null,function*(){if(!(!t||!_))return pe(t.id,_.id,r)}),[t,_,pe]),ze=s.useCallback(()=>ee(void 0,null,function*(){if(!(!h.trim()||!t))try{yield Le(t.id,h)}catch(r){console.error("Error saving reflection:",r)}}),[h,t,Le]),He=s.useCallback(()=>{if(!_||!t)return;const r=[],u=l[t.id],d=(u==null?void 0:u.completed)||!1;je<50&&a.timeSpent>3e5&&r.push({type:"speed",title:"Try adjusting video speed",description:"Consider increasing playback speed to 1.25x for better engagement",action:()=>{J.current&&(J.current.playbackRate=1.25)}}),d&&y<((_==null?void 0:_.lessons.length)||0)-1&&r.push({type:"next",title:"Continue momentum",description:"You're doing great! Ready for the next lesson?",action:Ne}),h.length>0&&h.length<50&&r.push({type:"reflect",title:"Expand your reflection",description:"Add more details to deepen your learning experience",action:()=>{var U;return(U=document.querySelector("textarea"))==null?void 0:U.focus()}}),D(r)},[je,a,y,_,h,l,t,Ne]);s.useEffect(()=>{a.interactions>0&&He()},[a.interactions,He]);const Re=s.useMemo(()=>{var O;if(!m||a.timeSpent<6e4)return null;const r=((O=m.modules)==null?void 0:O.reduce((xe,we)=>xe+we.lessons.length,0))||0,u=Object.values(l).filter(xe=>xe.completed).length,d=a.timeSpent/Math.max(u,1),U=r-u,R=U*d;return{totalLessons:r,completedLessons:u,remainingLessons:U,estimatedTimeRemaining:R,completionPercentage:Math.round(u/r*100)}},[m,l,a.timeSpent]),ve=(()=>{const r=(m.modules||[]).reduce((d,U)=>d+U.lessons.length,0),u=Object.values(l).filter(d=>d.completed).length;return r>0?Math.round(u/r*100):0})();if(s.useEffect(()=>{ve>=100&&ye(!0)},[ve]),!m)return e.jsxs("div",{className:"p-6 max-w-4xl mx-auto text-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Course Not Found"}),e.jsx(Ve,{to:"/lms/courses",className:"text-orange-500 hover:text-orange-600",children:"← Back to Courses"})]});if(me)return e.jsxs("div",{className:"p-6 max-w-4xl mx-auto text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-orange-500 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Loading course..."})]});if(ke)return e.jsx("div",{className:"p-6 max-w-4xl mx-auto text-center",children:e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-red-900 mb-2",children:"Unable to Load Course"}),e.jsx("p",{className:"text-red-700 mb-4",children:"Please make sure you're logged in and try again."}),e.jsx(Ve,{to:"/lms/login",className:"inline-flex items-center bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700",children:"Go to Login"})]})});if(!_||!t)return e.jsx("div",{className:"p-6",children:"Loading..."});const ie=l[t.id],Xe=(ie==null?void 0:ie.completed)||!1,Ze=()=>ee(void 0,null,function*(){if(!t.content.questions)return;const r=t.content.questions;let u=0;const d=r.length;r.forEach(O=>{C[O.id]===O.correctAnswerIndex&&u++});const R=Math.round(u/d*100)>=(t.content.passingScore||80);N({score:u,maxScore:d,passed:R}),i(!0)}),Cs=()=>{fe(!0),Object.entries(L).some(([u,d])=>{var R,O;if(!d)return!1;const U=(O=(R=t.content)==null?void 0:R.options)==null?void 0:O[parseInt(u)];return U==null?void 0:U.isCorrect})&&De({completed:!0,progress_percentage:100})},ks=r=>{switch(r){case"video":return e.jsx(nt,{className:"h-5 w-5"});case"interactive":return e.jsx(qe,{className:"h-5 w-5"});case"quiz":return e.jsx(ne,{className:"h-5 w-5"});case"download":return e.jsx(Ye,{className:"h-5 w-5"});case"text":return e.jsx(Pe,{className:"h-5 w-5"});default:return e.jsx(Pe,{className:"h-5 w-5"})}},_s=()=>{var r,u;return e.jsxs("div",{className:"bg-orange-50 p-6 rounded-lg",children:[(r=t.content.questions)==null?void 0:r.map((d,U)=>e.jsxs("div",{className:"mb-8 last:mb-6",children:[e.jsxs("h4",{className:"font-medium text-orange-900 mb-4 text-lg",children:["Question ",U+1,": ",d.text]}),e.jsx("div",{className:"space-y-3",children:d.options.map((R,O)=>e.jsx("button",{onClick:()=>{f||b(xe=>le(ae({},xe),{[d.id]:O}))},disabled:f,className:`w-full text-left p-4 border-2 rounded-lg transition-all duration-200 ${f?O===d.correctAnswerIndex?"border-green-500 bg-green-50":C[d.id]===O?"border-red-500 bg-red-50":"border-gray-200 bg-gray-50":C[d.id]===O?"border-orange-500 bg-orange-50":"border-orange-200 hover:border-orange-300 hover:bg-orange-50"} ${f?"cursor-default":"cursor-pointer"}`,children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`w-4 h-4 rounded-full border-2 ${f?O===d.correctAnswerIndex?"border-green-500 bg-green-500":C[d.id]===O?"border-red-500 bg-red-500":"border-gray-300":C[d.id]===O?"border-orange-500 bg-orange-500":"border-orange-300"}`,children:(f&&O===d.correctAnswerIndex||!f&&C[d.id]===O)&&e.jsx("div",{className:"w-full h-full rounded-full bg-white scale-50"})}),e.jsx("span",{className:"text-orange-900",children:R})]})},O))}),f&&d.explanation&&e.jsxs("div",{className:"mt-4 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsx("h5",{className:"font-medium text-blue-900 mb-2",children:"Explanation:"}),e.jsx("p",{className:"text-blue-800 text-sm",children:d.explanation})]})]},d.id)),!f&&e.jsx("div",{className:"text-center",children:e.jsxs("button",{onClick:Ze,disabled:Object.keys(C).length!==((u=t.content.questions)==null?void 0:u.length),className:"bg-orange-600 text-white px-8 py-3 rounded-lg hover:bg-orange-700 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center mx-auto space-x-2",children:[e.jsx(Ns,{className:"h-5 w-5"}),e.jsx("span",{children:"Submit Quiz"})]})}),f&&n&&e.jsx("div",{className:`mt-6 p-6 rounded-lg border-2 ${n.passed?"border-green-500 bg-green-50":"border-red-500 bg-red-50"}`,children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:`text-3xl font-bold mb-2 ${n.passed?"text-green-600":"text-red-600"}`,children:[Math.round(n.score/n.maxScore*100),"%"]}),e.jsx("p",{className:`text-lg font-medium mb-2 ${n.passed?"text-green-800":"text-red-800"}`,children:n.passed?"Congratulations! You passed!":"Keep studying and try again"}),e.jsxs("p",{className:`text-sm ${n.passed?"text-green-700":"text-red-700"}`,children:["You scored ",n.score," out of ",n.maxScore," questions correctly"]}),n.passed&&e.jsxs("div",{className:"mt-4 flex items-center justify-center space-x-2 text-green-700",children:[e.jsx(Oe,{className:"h-5 w-5"}),e.jsx("span",{className:"font-medium",children:"Lesson completed!"})]})]})})]})},$s=()=>{var R,O,xe,we,Te,ts,rs,as,ns,os,ls,is,cs,ds,us,ms,xs;if(console.log("🎥 Rendering lesson content:",{lessonData:t,type:t.type,content:t.content,videoUrl:(R=t.content)==null?void 0:R.videoUrl}),console.log("🔍 Video Debug Details:",{lessonType:t.type,content:t.content,videoUrl:(O=t.content)==null?void 0:O.videoUrl,videoSourceType:(xe=t.content)==null?void 0:xe.videoSourceType,hasContent:!!t.content}),((we=t.content)==null?void 0:we.videoUrl)||t.type==="video"||t.type==="video"){const p=(Te=t.content)==null?void 0:Te.videoUrl;console.log("🎯 Current Lesson Debug:",{lessonId:t.id,lessonTitle:t.title,lessonType:t.type,courseId:m==null?void 0:m.id,courseTitle:m==null?void 0:m.title,moduleId:_==null?void 0:_.id,moduleTitle:_==null?void 0:_.title,contentKeys:Object.keys(t.content||{}),videoUrl:p});const be=p&&p.trim()!==""&&p!=="undefined"&&p!=="null"&&!p.includes("placeholder")&&(p.startsWith("http")||p.startsWith("blob:")||p.startsWith("data:"));(p==null?void 0:p.startsWith("blob:"))&&console.log("⚠️ Warning: Blob URL detected - this may not work after page reload:",p),console.log("🔍 Video URL Validation:",{rawVideoUrl:p,isValidVideoUrl:be,urlLength:p==null?void 0:p.length,trimmed:p==null?void 0:p.trim()});const Qe=be?p:"https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4",Ie=!be,Es=p==null?void 0:p.startsWith("uploaded:");return console.log("🎬 Video URL Decision:",{videoUrl:p,finalVideoUrl:Qe,isUsingFallback:Ie}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(xt,{src:Qe,title:t.title,onProgress:ce=>{var hs;if(o(ce),ce>((ie==null?void 0:ie.progress_percentage)||0)){const Ls={progress_percentage:ce,time_spent:Math.round(ce/100*(((hs=J.current)==null?void 0:hs.duration)||0))};Q({lessonId:t.id,moduleId:_.id,progress:Ls})}(ce===25||ce===50||ce===75)&&v("progress_milestone",{milestone:ce})},onComplete:()=>{v("video_complete"),pe(t.id,_.id,{completed:!0,progress_percentage:100});const ce=new CustomEvent("show-notification",{detail:{type:"success",message:"🎉 Lesson completed! Great job!",duration:3e3}});window.dispatchEvent(ce)},initialTime:(ie==null?void 0:ie.time_spent)||0,autoPlay:!1,showTranscript:!!((ts=t.content)!=null&&ts.transcript),transcript:((rs=t.content)==null?void 0:rs.transcript)||"",captions:((ns=(as=t.content)==null?void 0:as.captions)==null?void 0:ns.map(ce=>({start:ce.startTime||0,end:ce.endTime||0,text:ce.text||""})))||[],className:"aspect-video"}),Ie&&e.jsx("div",{className:"bg-yellow-50 p-4 rounded-lg border border-yellow-200",children:e.jsxs("p",{className:"text-yellow-800 text-sm",children:[e.jsx("strong",{children:"🚧 Demo Video:"})," Using fallback video for demonstration."]})}),!Ie&&e.jsx("div",{className:"bg-green-50 p-4 rounded-lg border border-green-200",children:e.jsxs("p",{className:"text-green-800 text-sm",children:[e.jsx("strong",{children:"✅ Course Video:"})," Playing actual lesson video content."]})}),Ie&&e.jsxs("div",{className:"bg-yellow-50 p-4 rounded-lg border border-yellow-200",children:[e.jsx("p",{className:"text-yellow-800 text-sm",children:Es?e.jsxs(e.Fragment,{children:[e.jsx("strong",{children:"🚧 Demo Video (File Upload):"})," You uploaded a video file (",p==null?void 0:p.replace("uploaded:",""),"), but file uploads require cloud storage setup. Playing demo video for now."]}):e.jsxs(e.Fragment,{children:[e.jsx("strong",{children:"🚧 Demo Video:"})," No valid video URL found in lesson content. Playing fallback video for demonstration."]})}),e.jsx("div",{className:"mt-3 text-xs text-yellow-700 bg-yellow-100 p-2 rounded",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("strong",{children:"Debug Info:"}),e.jsx("br",{}),"Course ID: ",(m==null?void 0:m.id)||"undefined",e.jsx("br",{}),"Lesson ID: ",(t==null?void 0:t.id)||"undefined",e.jsx("br",{}),"Lesson Type: ",(t==null?void 0:t.type)||"undefined",e.jsx("br",{}),"Video URL: ",p||"undefined",e.jsx("br",{}),"Content Keys: ",Object.keys((t==null?void 0:t.content)||{}).join(", ")||"none"]}),e.jsxs("div",{className:"ml-4 flex flex-col space-y-1",children:[e.jsx("button",{onClick:()=>{console.log("🔄 Force refreshing course data..."),window.location.reload()},className:"bg-yellow-600 text-white px-2 py-1 rounded text-xs hover:bg-yellow-700",children:"Refresh"}),e.jsx("button",{onClick:()=>{console.log("🔍 Course Data:",m),console.log("📊 Current Lesson:",t),alert("Check browser console for detailed course data")},className:"bg-blue-600 text-white px-2 py-1 rounded text-xs hover:bg-blue-700",children:"Debug"})]})]})})]}),!Ie&&e.jsx("div",{className:"bg-green-50 p-4 rounded-lg border border-green-200",children:e.jsxs("p",{className:"text-green-800 text-sm",children:[e.jsx("strong",{children:"✅ Course Video:"})," Playing actual lesson video content."]})}),((os=t.content)==null?void 0:os.transcript)&&e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Transcript"}),e.jsx("p",{className:"text-gray-700 text-sm whitespace-pre-wrap",children:t.content.transcript})]}),((ls=t.content)==null?void 0:ls.notes)&&e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"Key Notes"}),e.jsx("p",{className:"text-blue-800 text-sm",children:t.content.notes})]})]})}const u=((is=t.content)==null?void 0:is.questions)&&t.content.questions.length>0,d=((cs=t.content)==null?void 0:cs.content)||((ds=t.content)==null?void 0:ds.textContent),U=[];if(u&&U.push(e.jsx("div",{className:"mt-8",children:e.jsxs("div",{className:"border-t border-gray-200 pt-8",children:[e.jsxs("h3",{className:"text-xl font-bold text-gray-900 mb-6 flex items-center",children:[e.jsx(ne,{className:"h-6 w-6 mr-2 text-orange-500"}),"Knowledge Check"]}),_s()]})},"quiz-section")),d&&U.push(e.jsx("div",{className:"mt-8",children:e.jsx("div",{className:"border-t border-gray-200 pt-8",children:e.jsx("div",{className:"prose max-w-none",children:e.jsxs("div",{className:"bg-blue-50 p-6 rounded-lg",children:[e.jsx("h3",{className:"text-xl font-bold text-blue-900 mb-4",children:t.content.title||"Additional Reading"}),e.jsx("div",{className:"text-blue-800 whitespace-pre-wrap",children:t.content.content||t.content.textContent})]})})})},"text-section")),U.length>0)return e.jsx("div",{className:"space-y-6",children:U});switch(t.type){case"interactive":return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-green-50 p-6 rounded-lg",children:[e.jsx("h3",{className:"text-xl font-bold text-green-900 mb-4",children:"Interactive Exercise"}),e.jsx("p",{className:"text-green-800 text-lg mb-6",children:t.content.scenarioText}),t.content.instructions&&e.jsx("div",{className:"bg-green-100 p-4 rounded-lg mb-6",children:e.jsx("p",{className:"text-green-800 text-sm font-medium",children:t.content.instructions})}),e.jsx("div",{className:"space-y-3",children:(us=t.content.options)==null?void 0:us.map((p,be)=>e.jsxs("button",{onClick:()=>{H({[be]:!0}),de||fe(!0)},className:`w-full text-left p-4 border-2 rounded-lg transition-all duration-200 ${L[be]?p.isCorrect?"border-green-500 bg-green-50":"border-red-500 bg-red-50":"border-green-200 hover:border-green-300 hover:bg-green-50"}`,children:[e.jsx("p",{className:"font-medium text-green-900 mb-2",children:p.text}),de&&L[be]&&e.jsxs("div",{className:`mt-3 p-3 rounded-lg ${p.isCorrect?"bg-green-100":"bg-red-100"}`,children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[p.isCorrect?e.jsx(ne,{className:"h-5 w-5 text-green-600"}):e.jsx(js,{className:"h-5 w-5 text-red-600"}),e.jsx("span",{className:`font-medium ${p.isCorrect?"text-green-800":"text-red-800"}`,children:p.isCorrect?"Correct!":"Not quite right"})]}),e.jsx("p",{className:`text-sm ${p.isCorrect?"text-green-700":"text-red-700"}`,children:p.feedback})]})]},be))}),de&&e.jsx("div",{className:"mt-6 text-center",children:e.jsxs("button",{onClick:Cs,className:"bg-green-600 text-white px-6 py-3 rounded-lg hover:bg-green-700 transition-colors duration-200 flex items-center mx-auto space-x-2",children:[e.jsx(ne,{className:"h-5 w-5"}),e.jsx("span",{children:"Complete Exercise"})]})})]})});case"quiz":return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-orange-50 p-6 rounded-lg",children:[e.jsx("h3",{className:"text-xl font-bold text-orange-900 mb-6",children:"Knowledge Check"}),(ms=t.content.questions)==null?void 0:ms.map((p,be)=>e.jsxs("div",{className:"mb-8 last:mb-6",children:[e.jsxs("h4",{className:"font-medium text-orange-900 mb-4 text-lg",children:["Question ",be+1,": ",p.text]}),e.jsx("div",{className:"space-y-3",children:p.options.map((gs,he)=>e.jsx("button",{onClick:()=>{f||b(Qe=>le(ae({},Qe),{[p.id]:he}))},disabled:f,className:`w-full text-left p-4 border-2 rounded-lg transition-all duration-200 ${f?he===p.correctAnswerIndex?"border-green-500 bg-green-50":C[p.id]===he?"border-red-500 bg-red-50":"border-gray-200 bg-gray-50":C[p.id]===he?"border-orange-500 bg-orange-50":"border-orange-200 hover:border-orange-300 hover:bg-orange-50"} ${f?"cursor-default":"cursor-pointer"}`,children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`w-4 h-4 rounded-full border-2 ${f?he===p.correctAnswerIndex?"border-green-500 bg-green-500":C[p.id]===he?"border-red-500 bg-red-500":"border-gray-300":C[p.id]===he?"border-orange-500 bg-orange-500":"border-orange-300"}`,children:(f&&he===p.correctAnswerIndex||!f&&C[p.id]===he)&&e.jsx("div",{className:"w-full h-full rounded-full bg-white scale-50"})}),e.jsx("span",{className:"text-orange-900",children:gs})]})},he))}),f&&p.explanation&&e.jsxs("div",{className:"mt-4 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsx("h5",{className:"font-medium text-blue-900 mb-2",children:"Explanation:"}),e.jsx("p",{className:"text-blue-800 text-sm",children:p.explanation})]})]},p.id)),!f&&e.jsx("div",{className:"text-center",children:e.jsxs("button",{onClick:Ze,disabled:Object.keys(C).length!==((xs=t.content.questions)==null?void 0:xs.length),className:"bg-orange-600 text-white px-8 py-3 rounded-lg hover:bg-orange-700 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center mx-auto space-x-2",children:[e.jsx(Ns,{className:"h-5 w-5"}),e.jsx("span",{children:"Submit Quiz"})]})}),f&&n&&e.jsx("div",{className:`mt-6 p-6 rounded-lg border-2 ${n.passed?"border-green-500 bg-green-50":"border-red-500 bg-red-50"}`,children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:`text-3xl font-bold mb-2 ${n.passed?"text-green-600":"text-red-600"}`,children:[Math.round(n.score/n.maxScore*100),"%"]}),e.jsx("p",{className:`text-lg font-medium mb-2 ${n.passed?"text-green-800":"text-red-800"}`,children:n.passed?"Congratulations! You passed!":"Keep studying and try again"}),e.jsxs("p",{className:`text-sm ${n.passed?"text-green-700":"text-red-700"}`,children:["You scored ",n.score," out of ",n.maxScore," questions correctly"]}),n.passed&&e.jsxs("div",{className:"mt-4 flex items-center justify-center space-x-2 text-green-700",children:[e.jsx(Oe,{className:"h-5 w-5"}),e.jsx("span",{className:"font-medium",children:"Lesson completed!"})]})]})})]})});case"document":return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-blue-50 p-6 rounded-lg",children:[e.jsx("h3",{className:"text-xl font-bold text-blue-900 mb-4",children:t.content.title||t.title}),e.jsx("p",{className:"text-blue-800 mb-6",children:t.content.description||"Download the resource below to continue your learning."}),t.content.fileUrl&&t.content.fileUrl.trim()?e.jsx("div",{className:"text-center",children:e.jsxs("a",{href:t.content.fileUrl,download:t.content.fileName,onClick:()=>{pe(t.id,_.id,{completed:!0,progress_percentage:100})},target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center bg-blue-600 text-white px-8 py-4 rounded-lg hover:bg-blue-700 transition-colors duration-200 space-x-3 text-lg font-medium",children:[e.jsx(Ye,{className:"h-6 w-6"}),e.jsxs("span",{children:["Download ",t.content.fileName||"Resource"]}),t.content.fileSize&&e.jsxs("span",{className:"text-blue-200",children:["(",t.content.fileSize,")"]})]})}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(ys,{className:"h-12 w-12 text-blue-400 mx-auto mb-4"}),e.jsx("p",{className:"text-blue-700",children:"Resource is being prepared"}),e.jsx("p",{className:"text-blue-600 text-sm mt-1",children:"Please check back later or contact your instructor"})]}),t.content.instructions&&e.jsxs("div",{className:"mt-6 bg-blue-100 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"Instructions"}),e.jsx("p",{className:"text-blue-800 text-sm",children:t.content.instructions})]})]})});case"text":return e.jsx("div",{className:"space-y-6",children:e.jsx("div",{className:"bg-indigo-50 p-6 rounded-lg",children:e.jsxs("div",{className:"prose max-w-none",children:[t.content.content&&e.jsx("div",{className:"text-gray-900 leading-relaxed whitespace-pre-wrap mb-6",children:t.content.content}),t.content.allowReflection&&t.content.reflectionPrompt&&e.jsxs("div",{className:"mt-8 bg-indigo-100 p-6 rounded-lg border border-indigo-200",children:[e.jsxs("h4",{className:"font-medium text-indigo-900 mb-4 flex items-center",children:[e.jsx(qe,{className:"h-5 w-5 mr-2"}),"Reflection",t.content.requireReflection&&e.jsx("span",{className:"ml-2 text-sm text-indigo-700 bg-indigo-200 px-2 py-1 rounded",children:"Required"})]}),e.jsx("p",{className:"text-indigo-800 mb-4",children:t.content.reflectionPrompt}),e.jsx("textarea",{rows:6,className:"w-full p-4 border border-indigo-200 rounded-lg resize-vertical focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent",placeholder:"Share your thoughts and reflections here...",onChange:p=>{p.target.value.length>50&&pe(t.id,_.id,{progress_percentage:Math.max((ie==null?void 0:ie.progress_percentage)||0,75),time_spent:((ie==null?void 0:ie.time_spent)||0)+1})}}),e.jsxs("div",{className:"mt-4 flex justify-between items-center",children:[e.jsx("p",{className:"text-sm text-indigo-600",children:"Take your time to reflect on the content above."}),e.jsxs("button",{onClick:()=>{pe(t.id,_.id,{completed:!0,progress_percentage:100})},className:"bg-indigo-600 text-white px-6 py-2 rounded-lg hover:bg-indigo-700 transition-colors duration-200 flex items-center space-x-2",children:[e.jsx(ne,{className:"h-4 w-4"}),e.jsx("span",{children:"Complete Reflection"})]})]})]}),!t.content.allowReflection&&e.jsx("div",{className:"mt-8 text-center",children:e.jsxs("button",{onClick:()=>{pe(t.id,_.id,{completed:!0,progress_percentage:100})},className:"bg-indigo-600 text-white px-8 py-3 rounded-lg hover:bg-indigo-700 transition-colors duration-200 flex items-center mx-auto space-x-2",children:[e.jsx(ne,{className:"h-5 w-5"}),e.jsx("span",{children:"Mark as Complete"})]})})]})})});default:return e.jsxs("div",{className:"bg-gray-50 p-6 rounded-lg text-center",children:[e.jsx(Pe,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:t.title}),e.jsx("p",{className:"text-gray-600",children:"Content for this lesson type is not yet available."})]})}};return e.jsxs("div",{className:"p-6 max-w-7xl mx-auto",style:{minHeight:"100vh"},children:[e.jsx(gt,{currentProgress:ve,totalLessons:(m.modules||[]).reduce((r,u)=>r+u.lessons.length,0),completedLessons:Object.values(l).filter(r=>r.completed).length,currentLessonTitle:t.title,onPrevious:ge,onNext:Ne,hasPrevious:!(c===0&&y===0),hasNext:!0,estimatedTimeRemaining:Re?`${Math.round(Re.estimatedTimeRemaining/(1e3*60*60*24))} days`:void 0,visible:!0}),ue&&e.jsxs("div",{className:"fixed top-4 right-4 z-50 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg flex items-center space-x-2 animate-fade-in",children:[e.jsx(ne,{className:"h-5 w-5"}),e.jsx("span",{children:"Course content refreshed successfully!"})]}),ve>=100&&Fe&&e.jsx(ht,{course:{id:m.id,title:m.title,description:m.description||"",instructor:m.instructorName||"Course Instructor",duration:m.duration,modules:(ss=m.modules)==null?void 0:ss.map(r=>({id:r.id,title:r.title,lessons:r.lessons.map(u=>{var d;return{id:u.id,title:u.title,completed:((d=l[u.id])==null?void 0:d.completed)||!1}})}))},completionData:{completedAt:new Date,timeSpent:Math.round(F/60),score:85,grade:"A",certificateId:`cert-${m.id}-${Date.now()}`,certificateUrl:`/certificates/${m.id}`},keyTakeaways:m.keyTakeaways||["Enhanced leadership skills through practical application","Improved understanding of team dynamics and communication","Developed strategic thinking and decision-making abilities"],nextSteps:[{title:"Advanced Leadership Course",description:"Continue your leadership journey with advanced concepts",href:"/lms/courses/advanced-leadership"},{title:"Mentorship Program",description:"Apply your skills by mentoring other learners",href:"/lms/mentorship"}],onClose:()=>{ye(!1),A("/lms/courses")},onCertificateDownload:()=>ee(void 0,null,function*(){v("certificate_downloaded")}),onShareComplete:r=>{v("achievement_shared",{platform:r})}}),e.jsxs("div",{className:"mb-6",children:[e.jsxs(Ve,{to:"/lms/courses",className:"inline-flex items-center text-orange-500 hover:text-orange-600 mb-4",children:[e.jsx(vs,{className:"h-4 w-4 mr-2"}),"Back to Courses"]}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:m.title}),e.jsx("p",{className:"text-gray-600",children:m.description}),e.jsxs("div",{className:"mt-2 flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm text-gray-500",children:["Module ",c+1," of ",(m.modules||[]).length,": ",_.title]}),e.jsxs("button",{onClick:Ce,disabled:Z,className:"inline-flex items-center px-3 py-1.5 text-sm font-medium text-gray-700 bg-gray-100 border border-gray-300 rounded-lg hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",title:"Refresh course content",children:[e.jsx(Je,{className:`h-4 w-4 mr-1 ${Z?"animate-spin":""}`}),Z?"Refreshing...":"Refresh Content"]})]})]}),ue&&e.jsxs("div",{className:"fixed top-4 right-4 z-50 bg-green-100 border border-green-400 text-green-800 px-4 py-3 rounded-lg shadow-lg flex items-center space-x-2",children:[e.jsx(ne,{className:"h-5 w-5 text-green-600"}),e.jsx("span",{className:"font-medium",children:"Course content updated successfully!"})]}),e.jsxs("div",{className:"flex flex-col lg:flex-row gap-6",children:[m&&m.modules&&m.modules.length>0&&e.jsx("div",{className:"lg:w-80 flex-shrink-0",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Course Progress"}),e.jsx("div",{className:"space-y-4",children:(m.modules||[]).map((r,u)=>e.jsxs("div",{className:"border border-gray-200 rounded-lg",children:[e.jsx("div",{className:"p-3 bg-gray-50 border-b border-gray-200",children:e.jsx("h4",{className:"font-medium text-gray-900",children:r.title})}),e.jsx("div",{className:"p-2 space-y-1",children:r.lessons.map((d,U)=>{const R=l[d.id],O=u===c&&U===y;return e.jsx("button",{onClick:()=>{z(u),k(U),b({}),i(!1),N(null),A(`/lms/module/${r.id}/lesson/${d.id}`)},className:`w-full text-left p-2 rounded-lg transition-colors duration-200 ${O?"bg-orange-50 border border-orange-200":"hover:bg-gray-50"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`p-1 rounded ${O?"text-orange-500":R!=null&&R.completed?"text-green-500":"text-gray-400"}`,children:R!=null&&R.completed?e.jsx(ne,{className:"h-5 w-5"}):e.jsx(Me,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("p",{className:`font-medium text-sm ${O?"text-orange-900":"text-gray-900"}`,children:d.title}),e.jsx("p",{className:"text-xs text-gray-600",children:d.duration})]})]}),(R==null?void 0:R.completed)&&e.jsx(ne,{className:"h-4 w-4 text-green-500"})]})},d.id)})})]},r.id))})]})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 mb-6",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:t.title}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-600",children:[e.jsxs("span",{className:"flex items-center",children:[e.jsx(Me,{className:"h-4 w-4 mr-1"}),t.duration]}),e.jsx("span",{className:"capitalize",children:t.type}),Xe&&e.jsxs("span",{className:"flex items-center text-green-600",children:[e.jsx(ne,{className:"h-4 w-4 mr-1"}),"Completed"]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:ge,disabled:c===0&&y===0,className:"p-2 rounded-lg border border-gray-300 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(vs,{className:"h-5 w-5"})}),e.jsx("button",{onClick:Ne,className:"p-2 rounded-lg border border-gray-300 hover:bg-gray-50",children:e.jsx(Be,{className:"h-5 w-5"})}),!Xe&&t.type!=="quiz"&&e.jsxs("button",{onClick:()=>_e(t.id,_.id),className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors duration-200 flex items-center space-x-2",children:[e.jsx(ne,{className:"h-4 w-4"}),e.jsx("span",{children:"Mark Complete"})]})]})]})}),e.jsx("div",{className:"p-6",children:$s()})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-900 flex items-center",children:[e.jsx(qe,{className:"h-5 w-5 mr-2 text-blue-500"}),"Reflection & Notes"]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[M&&e.jsxs("div",{className:"flex items-center text-orange-600 text-sm",children:[e.jsx(Je,{className:"h-4 w-4 mr-1 animate-spin"}),"Auto-saving..."]}),P&&e.jsxs("div",{className:"flex items-center text-green-600 text-sm",children:[e.jsx(ne,{className:"h-4 w-4 mr-1"}),"Saved ",P.toLocaleTimeString()]})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("textarea",{value:h,onChange:r=>{W(r.target.value),v("reflection_edit"),Q({lessonId:t.id,moduleId:_.id,progress:{reflection:r.target.value}})},onFocus:()=>v("reflection_focus"),placeholder:"What are your key takeaways from this lesson? How will you apply these concepts in your leadership role?",className:"w-full h-32 p-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent resize-none transition-all duration-200"}),e.jsx("div",{className:"absolute bottom-2 right-2 flex items-center space-x-2",children:e.jsxs("div",{className:`text-xs px-2 py-1 rounded ${h.length>200?"bg-green-100 text-green-600":h.length>50?"bg-yellow-100 text-yellow-600":"bg-gray-100 text-gray-600"}`,children:[h.length," chars"]})})]}),h.length<50&&e.jsxs("div",{className:"mt-3 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsx("p",{className:"text-sm text-blue-800 font-medium mb-2",children:"💡 Writing Prompts:"}),e.jsxs("ul",{className:"text-sm text-blue-700 space-y-1",children:[e.jsx("li",{children:"• What surprised you most about this content?"}),e.jsx("li",{children:"• How does this relate to your current leadership challenges?"}),e.jsx("li",{children:"• What specific action will you take this week?"})]})]}),e.jsxs("div",{className:"flex justify-between items-center mt-4",children:[e.jsx("p",{className:"text-sm text-gray-600",children:T[t.id]?`Previously saved: ${new Date(T[t.id].updated_at).toLocaleString()}`:"Notes are auto-saved as you type"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[h.length>=100&&e.jsxs("div",{className:"flex items-center text-green-600 text-sm",children:[e.jsx(Ae,{className:"h-4 w-4 mr-1"}),"Great reflection!"]}),e.jsxs("button",{onClick:ze,disabled:!h.trim(),className:"bg-orange-500 text-white px-4 py-2 rounded-lg hover:bg-orange-600 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:[e.jsx(st,{className:"h-4 w-4"}),e.jsx("span",{children:"Save Now"})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Key Takeaways"}),e.jsx("ul",{className:"space-y-3",children:(m.keyTakeaways||[]).map((r,u)=>e.jsxs("li",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"w-2 h-2 bg-orange-400 rounded-full mt-2 flex-shrink-0"}),e.jsx("span",{className:"text-gray-700",children:r})]},u))})]})]}),e.jsxs("div",{className:"lg:w-80 flex-shrink-0 space-y-6",children:[g.length>0&&e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-xl shadow-sm border border-blue-200 p-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-blue-900 mb-4 flex items-center",children:[e.jsx(tt,{className:"h-5 w-5 mr-2 text-yellow-500"}),"Smart Recommendations"]}),e.jsx("div",{className:"space-y-3",children:g.map((r,u)=>e.jsx("div",{className:"bg-white/80 backdrop-blur-sm rounded-lg p-4 border border-blue-200/50 hover:bg-white/90 transition-all duration-200",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold text-blue-900 mb-1",children:r.title}),e.jsx("p",{className:"text-sm text-blue-700 mb-3",children:r.description}),e.jsxs("button",{onClick:r.action,className:"inline-flex items-center px-3 py-1.5 bg-blue-600 text-white text-sm font-medium rounded-md hover:bg-blue-700 transition-colors duration-200",children:[e.jsx(ws,{className:"h-3 w-3 mr-1"}),"Apply"]})]}),e.jsxs("div",{className:"ml-3",children:[r.type==="speed"&&e.jsx(rt,{className:"h-5 w-5 text-blue-500"}),r.type==="next"&&e.jsx(Be,{className:"h-5 w-5 text-green-500"}),r.type==="reflect"&&e.jsx(qe,{className:"h-5 w-5 text-orange-500"})]})]})},u))})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-900 mb-4 flex items-center",children:[e.jsx(at,{className:"h-5 w-5 mr-2 text-green-500"}),"Your Progress Today"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:Math.round(F/60)}),e.jsx("div",{className:"text-xs text-gray-600",children:"Minutes Focused"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:a.interactions}),e.jsx("div",{className:"text-xs text-gray-600",children:"Interactions"})]})]}),Re&&e.jsxs("div",{className:"mt-4 p-3 bg-gradient-to-r from-purple-50 to-pink-50 rounded-lg border border-purple-200",children:[e.jsx("div",{className:"text-sm font-medium text-purple-900 mb-1",children:"Completion Prediction"}),e.jsxs("div",{className:"text-lg font-bold text-purple-600",children:[Math.round(Re.estimatedTimeRemaining/(1e3*60*60*24))," days"]}),e.jsxs("div",{className:"text-xs text-purple-700",children:[Re.remainingLessons," lessons remaining"]})]}),!G&&e.jsxs("div",{className:"mt-3 flex items-center text-amber-600 text-sm",children:[e.jsx(js,{className:"h-4 w-4 mr-1"}),"Focus to continue tracking progress"]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Course Progress"}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex justify-between text-sm text-gray-600 mb-2",children:[e.jsx("span",{children:"Overall Progress"}),e.jsxs("span",{children:[ve,"%"]})]}),e.jsxs("div",{className:"w-full bg-gray-200 rounded-full h-3 relative overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-orange-400 to-red-500 h-3 rounded-full transition-all duration-700 ease-out relative",style:{width:`${ve}%`},children:e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent animate-pulse"})}),[25,50,75].map(r=>e.jsx("div",{className:`absolute top-0 bottom-0 w-0.5 transition-colors duration-300 ${ve>=r?"bg-green-400":"bg-gray-300"}`,style:{left:`${r}%`}},r))]})]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"font-medium",children:Object.values(l).filter(r=>r.completed).length})," of"," ",e.jsx("span",{className:"font-medium",children:(m.modules||[]).reduce((r,u)=>r+u.lessons.length,0)})," lessons completed"]}),ve===100&&e.jsxs("div",{className:"mt-4 p-4 bg-gradient-to-r from-green-50 to-emerald-50 border-2 border-green-200 rounded-lg text-center relative overflow-hidden animate-pulse",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-green-100/0 via-green-100/50 to-green-100/0 animate-pulse"}),e.jsxs("div",{className:"relative",children:[e.jsx(Oe,{className:"h-10 w-10 text-green-600 mx-auto mb-3 animate-bounce"}),e.jsxs("div",{className:"flex items-center justify-center space-x-1 mb-2",children:[e.jsx("span",{className:"text-2xl",children:"🎉"}),e.jsx("p",{className:"font-bold text-green-800 text-lg",children:"Course Completed!"}),e.jsx("span",{className:"text-2xl",children:"🎉"})]}),e.jsx("p",{className:"text-sm text-green-700 mb-3",children:"Congratulations! You've successfully completed all lessons."}),e.jsxs("div",{className:"flex justify-center space-x-4 text-xs text-green-600",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(ne,{className:"h-3 w-3"}),e.jsxs("span",{children:[Object.values(l).filter(r=>r.completed).length," Lessons"]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Me,{className:"h-3 w-3"}),e.jsx("span",{children:m.duration})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Ge,{className:"h-3 w-3"}),e.jsx("span",{children:"100% Complete"})]})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Course Content"}),e.jsx("div",{className:"space-y-4",children:(m.modules||[]).map((r,u)=>e.jsxs("div",{className:"border border-gray-200 rounded-lg",children:[e.jsxs("div",{className:"p-3 bg-gray-50 border-b border-gray-200",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:r.title}),e.jsxs("p",{className:"text-sm text-gray-600",children:[r.lessons.length," lessons • ",r.duration]})]}),e.jsx("div",{className:"p-2 space-y-1",children:r.lessons.map((d,U)=>{const R=l[d.id],O=u===c&&U===y;return e.jsxs("button",{onClick:()=>{z(u),k(U),b({}),i(!1),N(null),H({}),fe(!1),A(`/lms/module/${w}/lesson/${d.id}`)},className:`w-full text-left p-2 rounded-lg transition-colors duration-200 ${O?"bg-orange-50 border border-orange-200":"hover:bg-gray-50"}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`p-1 rounded ${O?"text-orange-500":R!=null&&R.completed?"text-green-500":"text-gray-400"}`,children:R!=null&&R.completed?e.jsx(ne,{className:"h-5 w-5"}):ks(d.type)}),e.jsxs("div",{children:[e.jsx("p",{className:`font-medium text-sm ${O?"text-orange-900":"text-gray-900"}`,children:d.title}),e.jsx("p",{className:"text-xs text-gray-600",children:d.duration})]})]}),(R==null?void 0:R.completed)&&e.jsx(ne,{className:"h-4 w-4 text-green-500"})]}),R&&R.progress_percentage>0&&R.progress_percentage<100&&e.jsx("div",{className:"mt-2 ml-8",children:e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-1",children:e.jsx("div",{className:"bg-orange-400 h-1 rounded-full",style:{width:`${R.progress_percentage}%`}})})})]},d.id)})})]},r.id))})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Module Resources"}),e.jsxs("div",{className:"space-y-3",children:[(_.resources||[]).map((r,u)=>e.jsxs("a",{href:r.downloadUrl,className:"flex items-center justify-between p-3 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors duration-200",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(ys,{className:"h-5 w-5 text-blue-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:r.title}),e.jsxs("p",{className:"text-sm text-gray-600",children:[r.type," • ",r.size]})]})]}),e.jsx(Ye,{className:"h-5 w-5 text-gray-400"})]},u)),(_.resources||[]).length===0&&e.jsx("p",{className:"text-gray-500 text-center py-4",children:"No additional resources for this module"})]})]}),e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-green-50 rounded-xl p-6",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-2",children:"Rate This Module"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Help us improve the learning experience"}),e.jsxs("div",{className:"flex items-center space-x-1 mb-4",children:[[1,2,3,4,5].map(r=>e.jsx("button",{onClick:()=>Y(r),className:`hover:text-yellow-500 ${q>=r?"text-yellow-400":"text-gray-300"}`,children:e.jsx(Ge,{className:"h-6 w-6 fill-current"})},r)),q>0&&e.jsxs("span",{className:"ml-2 text-sm text-gray-600",children:["Thanks for rating! (",q,"/5)"]})]}),e.jsx(Ve,{to:"/lms/feedback",className:"text-sm text-blue-600 hover:text-blue-700 font-medium",children:"Leave detailed feedback →"})]})]})]})]})};export{St as default};
